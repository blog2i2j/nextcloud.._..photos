const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=[window.OC.filePath('photos', '', 'js/folders-D4009oow.chunk.mjs'),window.OC.filePath('photos', '', 'js/vendor-DOPpmdjb.chunk.mjs'),window.OC.filePath('photos', '', 'js/photos-sidebar.mjs'),window.OC.filePath('photos', '', 'js/tags-C9uqs7-N.chunk.mjs'),window.OC.filePath('photos', '', 'js/icons-Ba8uv1cK.chunk.mjs'),window.OC.filePath('photos', '', 'css/tags-D3WJna6a.chunk.css'),window.OC.filePath('photos', '', 'js/places-AlGOFB75.chunk.mjs'),window.OC.filePath('photos', '', 'css/places-8LY2b4hK.chunk.css'),window.OC.filePath('photos', '', 'js/albums-CeDjJMgY.chunk.mjs'),window.OC.filePath('photos', '', 'css/albums-CicppMUS.chunk.css'),window.OC.filePath('photos', '', 'js/faces-CI2plmbg.chunk.mjs'),window.OC.filePath('photos', '', 'css/faces-CoW1zzib.chunk.css'),window.OC.filePath('photos', '', 'css/sidebar-CBstC85j.chunk.css'),window.OC.filePath('photos', '', 'css/vendor-C2lWVKJH.chunk.css'),window.OC.filePath('photos', '', 'css/folders-B9qGKkZV.chunk.css')])))=>i.map(i=>d[i]);
import{aa as me,g as S,ab as oe,z as V,t as l,ac as fe,b as k,ad as ge,ae as Je,af as Ke,ag as C,ah as ye,ai as Ze,aj as Ge,ak as ve,_ as f,V as g,al as be,w as Qe,s as w,D as z,f as b,am as Xe,an as O,ao as ie,ap as et,c as tt,aq as ot,ar as Z,as as se,at as ae,au as it,av as st,aw as Fe,h as G,M as D,ax as at,ay as nt,az as rt,i as x,e as j,aA as lt,m as M,r as E,p as we,aB as _e,aC as Ce,k as Se,C as ct,aD as dt,N as pt,l as ht,aE as ut,aF as mt,o as ft,j as gt}from"./vendor-DOPpmdjb.chunk.mjs";import{P as Ne,s as yt,H as vt,M as bt,t as Ft,V as ke,T as wt,o as Ae,d as _t,u as Le,F as Te,p as Ct,A as St,v as Nt,w as kt,x as At,i as Lt,y as Tt,k as It,m as Q,g as Pt,z as xt,I as Mt,B as Et,b as $t,n as Ot,G as Dt,D as Bt}from"./icons-Ba8uv1cK.chunk.mjs";import{_ as Rt,a as Vt,b as zt,c as jt,d as Ht}from"./photos-sidebar.mjs";import{s as J,a as Ut}from"./tags-C9uqs7-N.chunk.mjs";import{P as Ie,f as qt}from"./folders-D4009oow.chunk.mjs";import{s as Pe,p as Wt}from"./places-AlGOFB75.chunk.mjs";import{p as Yt,s as Jt,a as Kt,A as Zt,b as Gt}from"./albums-CeDjJMgY.chunk.mjs";import{f as Qt}from"./faces-CI2plmbg.chunk.mjs";import"./photos-main.mjs";var Hs=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Us(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function u(e,o,i,s,a,n,r,c){var h=typeof e=="function"?e.options:e;return o&&(h.render=o,h.staticRenderFns=i,h._compiled=!0),s&&(h.functional=!0),n&&(h._scopeId="data-v-"+n),{exports:e,options:h}}const Xt="modulepreload",eo=function(e,o){return new URL(e,o).href},ne={},y=function(e,o,i){let s=Promise.resolve();if(o&&o.length>0){let n=function(d){return Promise.all(d.map(F=>Promise.resolve(F).then(_=>({status:"fulfilled",value:_}),_=>({status:"rejected",reason:_}))))};const r=document.getElementsByTagName("link"),c=document.querySelector("meta[property=csp-nonce]"),h=c?.nonce||c?.getAttribute("nonce");s=n(o.map(d=>{if(d=eo(d,i),d in ne)return;ne[d]=!0;const F=d.endsWith(".css"),_=F?'[rel="stylesheet"]':"";if(i)for(let L=r.length-1;L>=0;L--){const $=r[L];if($.href===d&&(!F||$.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${d}"]${_}`))return;const v=document.createElement("link");if(v.rel=F?"stylesheet":Xt,F||(v.as="script"),v.crossOrigin="",v.href=d,h&&v.setAttribute("nonce",h),document.head.appendChild(v),F)return new Promise((L,$)=>{v.addEventListener("load",L),v.addEventListener("error",()=>$(new Error(`Unable to preload CSS for ${d}`)))})}))}function a(n){const r=new Event("vite:preloadError",{cancelable:!0});if(r.payload=n,window.dispatchEvent(r),!r.defaultPrevented)throw n}return s.then(n=>{for(const r of n||[])r.status==="rejected"&&a(r.reason);return e().catch(a)})},to={name:"CroppedLayoutSettings",components:{NcCheckboxRadioSwitch:me},computed:{croppedLayout(){return this.$store.state.userConfig.croppedLayout}},methods:{updateSetting(e){this.$store.dispatch("updateUserConfig",{key:"croppedLayout",value:e})}}};var oo=function(){var e=this,o=e._self._c;return o("NcCheckboxRadioSwitch",{attrs:{checked:e.croppedLayout,type:"switch"},on:{"update:checked":e.updateSetting}},[e._v(" "+e._s(e.t("photos","Enable squared photos view"))+" ")])},io=[],so=u(to,oo,io,!1,null,null);const ao=so.exports,no=e=>e===null?oe().setApp("photos").build():oe().setApp("photos").setUid(e.uid).build(),p=no(S()),ro=V({name:"PhotosSourceLocationsSettings",components:{NcButton:k,PhotosFolder:Ie,Plus:Ne},data(){return{FolderMultiple:yt}},computed:{photosSourceFolders(){return this.$store.state.userConfig.photosSourceFolders}},methods:{debounceAddSourceFolder:fe(function(...e){this.addSourceFolder(...e)},200,!1),async openFilePicker(e){return ge(e).setMultiSelect(!1).addMimeTypeFilter("httpd/unix-directory").allowDirectories().addButton({label:l("photos","Pick folder"),callback:o=>p.debug("Picked",{nodes:o})}).build().pick()},async addSourceFolder(){const e=await this.openFilePicker(l("photos","Select a source folder for your media"));this.photosSourceFolders.includes(e)||this.$store.dispatch("updateUserConfig",{key:"photosSourceFolders",value:[...this.photosSourceFolders,e]})},removeSourceFolder(e){const o=[...this.photosSourceFolders];o.splice(e,1),this.$store.dispatch("updateUserConfig",{key:"photosSourceFolders",value:o})},t:l}});var lo=function(){var e=this,o=e._self._c;return e._self._setupProxy,o("div",{staticClass:"photos-locations-container"},[o("div",{staticClass:"photos-locations"},e._l(e.photosSourceFolders,function(i,s){return o("li",{key:s},[o("PhotosFolder",{attrs:{path:i,"can-delete":e.photosSourceFolders.length!==1,"root-folder-label":e.t("photos","All folders"),"root-folder-icon":e.FolderMultiple},on:{"remove-folder":function(a){return e.removeSourceFolder(s)}}})],1)}),0),o("NcButton",{attrs:{"aria-label":e.t("photos","Add a Photos source for the timelines")},on:{click:e.debounceAddSourceFolder},scopedSlots:e._u([{key:"icon",fn:function(){return[o("Plus",{attrs:{size:20}})]},proxy:!0}])},[e._v(" "+e._s(e.t("photos","Add folder"))+" ")])],1)},co=[],po=u(ro,lo,co,!1,null,"ff7d1d10");const xe=po.exports,ho=V({name:"PhotosUploadLocationSettings",components:{NcButton:k,PhotosFolder:Ie},data(){return{Home:vt}},computed:{photosLocation(){return this.$store.state.userConfig.photosLocation}},methods:{debounceSelectPhotosFolder:fe(function(){this.selectPhotosFolder()}),async selectPhotosFolder(){const e=await this.openFilePicker(l("photos","Select the default upload location for your media"));this.updatePhotosFolder(e)},async openFilePicker(e){return ge(e).setMultiSelect(!1).addMimeTypeFilter("httpd/unix-directory").allowDirectories().startAt(this.photosLocation).addButton({label:l("photos","Pick folder"),callback:o=>p.debug("Picked",{nodes:o})}).build().pick()},updatePhotosFolder(e){this.$store.dispatch("updateUserConfig",{key:"photosLocation",value:e})},t:l}});var uo=function(){var e=this,o=e._self._c;return e._self._setupProxy,o("div",{staticClass:"photos-location"},[o("PhotosFolder",{attrs:{path:e.photosLocation,"root-folder-label":e.t("photos","Home"),"root-folder-icon":e.Home}}),o("NcButton",{attrs:{"aria-label":e.t("photos","Choose default Photos upload and Albums location")},on:{click:e.debounceSelectPhotosFolder}},[e._v(" "+e._s(e.t("photos","Choose a different folder"))+" ")])],1)},mo=[],fo=u(ho,uo,mo,!1,null,"7ae88f46");const go=fo.exports,yo={name:"SettingsDialog",components:{NcAppSettingsDialog:Ke,NcAppSettingsSection:Je,CroppedLayoutSettings:ao,PhotosSourceLocationsSettings:xe,PhotosUploadLocationSettings:go},props:{open:{type:Boolean,default:!1}},methods:{onClose(){this.$emit("update:open",!1)},t:l}};var vo=function(){var e=this,o=e._self._c;return o("NcAppSettingsDialog",{attrs:{open:e.open,"show-navigation":!0,name:e.t("photos","Photos settings")},on:{"update:open":e.onClose}},[o("NcAppSettingsSection",{attrs:{id:"layout-settings",name:e.t("photos","View")}},[o("CroppedLayoutSettings")],1),o("NcAppSettingsSection",{attrs:{id:"source-directories-settings",name:e.t("photos","Media folders")}},[o("div",{staticClass:"setting-section-subline"},[e._v(" "+e._s(e.t("photos","Choose the folders from where photos and videos are shown."))+" ")]),o("PhotosSourceLocationsSettings")],1),o("NcAppSettingsSection",{attrs:{id:"upload-directory-settings",name:e.t("photos","Upload folder")}},[o("div",{staticClass:"setting-section-subline"},[e._v(" "+e._s(e.t("photos","Choose the folder where photos and albums are uploaded to."))+" ")]),o("PhotosUploadLocationSettings")],1)],1)},bo=[],Fo=u(yo,vo,bo,!1,null,null);const wo=Fo.exports,Me="data:image/svg+xml,%3csvg%20width='32'%20height='32'%20xmlns='http://www.w3.org/2000/svg'%20xml:space='preserve'%20style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2'%3e%3cpath%20d='M5%2021c-.55%200-1.021-.196-1.412-.587A1.927%201.927%200%200%201%203%2019V5c0-.55.196-1.021.588-1.413A1.926%201.926%200%200%201%205%203h14c.55%200%201.021.196%201.413.587.391.392.587.863.587%201.413v14a1.93%201.93%200%200%201-.587%201.413A1.93%201.93%200%200%201%2019%2021H5Zm0-2h14V5H5v14Zm1-2h12l-3.75-5-3%204L9%2013l-3%204Zm-1%202V5v14Zm3.5-9a1.45%201.45%200%200%200%201.063-.437A1.45%201.45%200%200%200%2010%208.5c0-.417-.146-.771-.437-1.062A1.447%201.447%200%200%200%208.5%207c-.417%200-.771.146-1.062.438A1.443%201.443%200%200%200%207%208.5c0%20.417.146.771.438%201.063.291.291.645.437%201.062.437Z'%20style='fill-rule:nonzero'%20transform='translate(-2.665%20-2.665)%20scale(1.55497)'/%3e%3c/svg%3e",Ee="data:image/svg+xml,%3csvg%20width='32'%20height='32'%20xmlns='http://www.w3.org/2000/svg'%20xml:space='preserve'%20style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2'%3e%3cpath%20d='m4%204%202%204h3L7%204h2l2%204h3l-2-4h2l2%204h3l-2-4h3c.55%200%201.021.196%201.413.587.391.392.587.863.587%201.413v12a1.93%201.93%200%200%201-.587%201.413A1.93%201.93%200%200%201%2020%2020H4c-.55%200-1.021-.196-1.412-.587A1.927%201.927%200%200%201%202%2018V6c0-.55.196-1.021.588-1.413A1.926%201.926%200%200%201%204%204Z'%20style='fill-rule:nonzero'%20transform='translate(-.804%20-.607)%20scale(1.40177)'/%3e%3c/svg%3e",$e=C("photos","maps",!1),Oe=C("photos","recognize",!1),re=C("photos","appStoreEnabled",!1),_o={name:"Photos",components:{AccountBoxMultipleOutline:Lt,Cog:At,CalendarToday:kt,Camera:Nt,AccountGroup:St,Folder:Ct,FolderMultipleImage:Te,ImageIcon:Le,ShareVariant:_t,Star:Ae,Tag:wt,VideoIcon:ke,MapIcon:Ft,MapMarker:bt,NcAppContent:ve,NcAppNavigation:Ge,NcAppNavigationItem:Ze,NcButton:k,NcContent:ye,SettingsDialog:wo},data(){return{svgplaceholder:Pe,imgplaceholder:Me,videoplaceholder:Ee,areTagsInstalled:J,showLocationMenuEntry:S()===null?!1:S().isAdmin&&re||$e,showPeopleMenuEntry:S()===null?!1:S().isAdmin&&C("photos","showPeopleMenuEntry",!0)&&re||Oe,openedSettings:!1}},async beforeMount(){const e=C("photos","nomedia-paths",[]);this.$store.dispatch("setNomediaPaths",e),p.debug("Known .nomedia and .noimage  paths",{files:e}),"serviceWorker"in navigator?window.addEventListener("load",()=>{navigator.serviceWorker.register(f("/apps/photos/service-worker.js",{},{noRewrite:!0}),{scope:f("/apps/photos")}).then(o=>{p.debug("SW registered: ",{registration:o})}).catch(o=>{p.error("SW registration failed: ",{registrationError:o})})}):p.debug("Service Worker is not enabled on this browser.")},beforeDestroy(){window.removeEventListener("load",()=>{navigator.serviceWorker.register(f("/apps/photos/service-worker.js",{},{noRewrite:!0}))})},methods:{showSettings(){this.openedSettings=!0}}};var Co=function(){var e=this,o=e._self._c;return o("NcContent",{attrs:{"app-name":"photos"}},[o("NcAppNavigation",{attrs:{"aria-label":e.t("photos","Photos")},scopedSlots:e._u([{key:"list",fn:function(){return[o("NcAppNavigationItem",{staticClass:"app-navigation__all_media",attrs:{to:{name:"all_media"},name:e.t("photos","All media"),"data-id-app-nav-item":"all-media",exact:""}},[o("ImageIcon",{attrs:{slot:"icon",size:20},slot:"icon"})],1),o("NcAppNavigationItem",{attrs:{to:"/photos",name:e.t("photos","Photos"),"data-id-app-nav-item":"photos"}},[o("Camera",{attrs:{slot:"icon",size:20},slot:"icon"})],1),o("NcAppNavigationItem",{attrs:{to:"/videos",name:e.t("photos","Videos"),"data-id-app-nav-item":"videos"}},[o("VideoIcon",{attrs:{slot:"icon",size:20},slot:"icon"})],1),o("NcAppNavigationItem",{attrs:{to:{name:"albums"},name:e.t("photos","Albums"),"data-id-app-nav-item":"albums"}},[o("FolderMultipleImage",{attrs:{slot:"icon",size:20},slot:"icon"})],1),o("NcAppNavigationItem",{attrs:{to:{name:"sharedAlbums"},name:e.t("photos","Collaborative albums"),"data-id-app-nav-item":"shared-albums"}},[o("AccountGroup",{attrs:{slot:"icon",size:20},slot:"icon"})],1),e.showPeopleMenuEntry?o("NcAppNavigationItem",{attrs:{to:{name:"faces"},name:e.t("photos","People"),"data-id-app-nav-item":"faces"},scopedSlots:e._u([{key:"icon",fn:function(){return[o("AccountBoxMultipleOutline",{attrs:{size:20}})]},proxy:!0}],null,!1,1224485484)}):e._e(),o("NcAppNavigationItem",{attrs:{to:{name:"folders"},name:e.t("photos","Folders"),"data-id-app-nav-item":"folders"}},[o("Folder",{attrs:{slot:"icon",size:20},slot:"icon"})],1),o("NcAppNavigationItem",{attrs:{to:"/favorites",name:e.t("photos","Favorites"),"data-id-app-nav-item":"favorites"}},[o("Star",{attrs:{slot:"icon",size:20},slot:"icon"})],1),o("NcAppNavigationItem",{attrs:{to:{name:"thisday"},name:e.t("photos","On this day"),"data-id-app-nav-item":"this-day"}},[o("CalendarToday",{attrs:{slot:"icon",size:20},slot:"icon"})],1),o("NcAppNavigationItem",{attrs:{to:{name:"shared"},name:e.t("photos","Shared with you"),"data-id-app-nav-item":"shared"}},[o("ShareVariant",{attrs:{slot:"icon",size:20},slot:"icon"})],1),e.areTagsInstalled?o("NcAppNavigationItem",{attrs:{to:{name:"tags"},name:e.t("photos","Tags"),"data-id-app-nav-item":"tags"}},[o("Tag",{attrs:{slot:"icon",size:20},slot:"icon"})],1):e._e(),o("NcAppNavigationItem",{attrs:{to:{name:"places"},name:e.t("photos","Places"),"data-id-app-nav-item":"places"}},[o("MapMarker",{attrs:{slot:"icon",size:20},slot:"icon"})],1),e.showLocationMenuEntry?o("NcAppNavigationItem",{attrs:{to:{name:"maps"},name:e.t("photos","Map"),"data-id-app-nav-item":"maps"}},[o("MapIcon",{attrs:{slot:"icon",size:20},slot:"icon"})],1):e._e()]},proxy:!0},{key:"footer",fn:function(){return[o("div",{staticClass:"app-navigation__footer"},[o("NcButton",{attrs:{type:"tertiary",alignment:"start",wide:""},on:{click:e.showSettings},scopedSlots:e._u([{key:"icon",fn:function(){return[o("Cog",{attrs:{slot:"icon",size:20},slot:"icon"})]},proxy:!0}])},[e._v(" "+e._s(e.t("photos","Photos settings"))+" ")])],1)]},proxy:!0}])}),o("NcAppContent",[o("RouterView"),o("span",{staticClass:"hidden-visually",attrs:{role:"none"},domProps:{innerHTML:e._s(e.svgplaceholder)}}),o("span",{staticClass:"hidden-visually",attrs:{role:"none"},domProps:{innerHTML:e._s(e.imgplaceholder)}}),o("span",{staticClass:"hidden-visually",attrs:{role:"none"},domProps:{innerHTML:e._s(e.videoplaceholder)}})],1),o("SettingsDialog",{attrs:{open:e.openedSettings},on:{"update:open":function(i){e.openedSettings=i}}})],1)},So=[],No=u(_o,Co,So,!1,null,null);const ko=No.exports,De=C("photos","image-mimes",[]),Be=C("photos","video-mimes",[]),H=[...De,...Be],le=()=>y(()=>import("./folders-D4009oow.chunk.mjs").then(e=>e.F),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14]),import.meta.url),Ao=()=>y(()=>import("./albums-CeDjJMgY.chunk.mjs").then(e=>e.c),__vite__mapDeps([8,1,2,3,4,5,6,7,0,14,10,11,12,13,9]),import.meta.url),Lo=()=>y(()=>import("./albums-CeDjJMgY.chunk.mjs").then(e=>e.d),__vite__mapDeps([8,1,2,3,4,5,6,7,0,14,10,11,12,13,9]),import.meta.url),To=()=>y(()=>import("./albums-CeDjJMgY.chunk.mjs").then(e=>e.S),__vite__mapDeps([8,1,2,3,4,5,6,7,0,14,10,11,12,13,9]),import.meta.url),Io=()=>y(()=>import("./albums-CeDjJMgY.chunk.mjs").then(e=>e.e),__vite__mapDeps([8,1,2,3,4,5,6,7,0,14,10,11,12,13,9]),import.meta.url),Po=()=>y(()=>import("./albums-CeDjJMgY.chunk.mjs").then(e=>e.P),__vite__mapDeps([8,1,2,3,4,5,6,7,0,14,10,11,12,13,9]),import.meta.url),xo=()=>y(()=>import("./places-AlGOFB75.chunk.mjs").then(e=>e.P),__vite__mapDeps([6,1,2,3,4,5,0,8,9,14,10,11,12,13,7]),import.meta.url),Mo=()=>y(()=>import("./places-AlGOFB75.chunk.mjs").then(e=>e.a),__vite__mapDeps([6,1,2,3,4,5,0,8,9,14,10,11,12,13,7]),import.meta.url),Eo=()=>y(()=>import("./tags-C9uqs7-N.chunk.mjs").then(e=>e.T),__vite__mapDeps([3,1,2,4,6,7,0,8,9,14,10,11,12,13,5]),import.meta.url),$o=()=>y(()=>import("./tags-C9uqs7-N.chunk.mjs").then(e=>e.b),__vite__mapDeps([3,1,2,4,6,7,0,8,9,14,10,11,12,13,5]),import.meta.url),T=()=>y(()=>Promise.resolve().then(()=>Ts),void 0,import.meta.url),Oo=()=>y(()=>import("./faces-CI2plmbg.chunk.mjs").then(e=>e.F),__vite__mapDeps([10,1,2,3,4,5,6,7,0,8,9,14,12,13,11]),import.meta.url),Do=()=>y(()=>import("./faces-CI2plmbg.chunk.mjs").then(e=>e.a),__vite__mapDeps([10,1,2,3,4,5,6,7,0,8,9,14,12,13,11]),import.meta.url),Bo=()=>y(()=>import("./faces-CI2plmbg.chunk.mjs").then(e=>e.U),__vite__mapDeps([10,1,2,3,4,5,6,7,0,8,9,14,12,13,11]),import.meta.url),ce=document.title;g.use(be);let Re=f("/apps/maps");$e||(Re=f("/settings/apps/integration/maps"));const de=e=>`/${Array.isArray(e)?e.join("/"):e||""}`,P=new be({mode:"history",base:f("/apps/photos"),linkActiveClass:"active",routes:[{path:"/",component:T,name:"all_media",props:()=>({rootTitle:l("photos","All your media")}),meta:{rootTitle:()=>l("photos","All your media")}},{path:"/photos",component:T,name:"photos",props:()=>({rootTitle:l("photos","Photos"),mimesType:De}),meta:{rootTitle:()=>l("photos","Photos")}},{path:"/videos",component:T,name:"videos",props:()=>({rootTitle:l("photos","Videos"),mimesType:Be}),meta:{rootTitle:()=>l("photos","Videos")}},{path:"/albums",component:Ao,name:"albums",meta:{rootTitle:()=>l("photos","Albums")}},{path:"/albums/:albumName*",component:Lo,name:"albumsContent",props:e=>({albumName:e.params.albumName}),meta:{rootTitle:e=>l("photos","Album {title}",{title:e.params.albumName})}},{path:"/sharedalbums",component:To,name:"sharedAlbums",meta:{rootTitle:()=>l("photos","Shared Albums")}},{path:"/sharedalbums/:albumName*",component:Io,name:"sharedAlbumsContent",props:e=>({albumName:e.params.albumName}),meta:{rootTitle:e=>l("photos","Shared album {title}",{title:e.params.albumName})}},{path:"/public/:token",component:Po,name:"publicAlbums",props:e=>({token:e.params.token}),meta:{rootTitle:e=>l("photos","Public album {title}",{title:e.params.token})}},{path:"/places",component:xo,name:"places"},{path:"/places/:placeName*",component:Mo,name:"placesContent",props:e=>({placeName:e.params.placeName})},{path:"/folders/:path*",component:le,name:"folders",props:e=>({path:de(e.params.path),isRoot:!e.params.path,rootTitle:l("photos","Folders")}),meta:{rootTitle:()=>l("photos","Folders")}},{path:"/shared/:path*",component:le,name:"shared",props:e=>({path:de(e.params.path),isRoot:!e.params.path,rootTitle:l("photos","Shared with you"),showShared:!0}),meta:{rootTitle:()=>l("photos","Shared with you")}},{path:"/favorites",component:T,name:"favorites",props:()=>({rootTitle:l("photos","Favorites"),onlyFavorites:!0}),meta:{rootTitle:()=>l("photos","Favorites")}},{path:"/tags/",component:Eo,name:"tags",redirect:J?void 0:{name:"timeline"},props:e=>({path:"",isRoot:!e.params.path,rootTitle:l("photos","Tagged photos")}),meta:{rootTitle:()=>l("photos","Tagged photos")}},{path:"/tags/:path",component:$o,name:"tagcontent",redirect:J?void 0:{name:"timeline"},props:e=>({path:`${e.params.path?e.params.path:""}`}),meta:{rootTitle:e=>l("photos","Tagged photo {title}",{title:e.params.path})}},{path:"/maps",name:"maps",beforeEnter(){window.open(Re,"_blank")}},{path:"/thisday",name:"thisday",component:T,props:()=>({rootTitle:l("photos","On this day"),onThisDay:!0}),meta:{rootTitle:()=>l("photos","On this day")}},{path:"/faces",name:"faces",component:Oo,...!Oe&&{beforeEnter(){const e=f("/settings/apps/installed/recognize");window.open(e,"_blank")}}},{path:"/faces/unassigned",name:"unassignedfaces",component:Bo,meta:{rootTitle:()=>l("photos","Unassigned faces")}},{path:"/faces/:faceName",name:"facecontent",component:Do,props:e=>({rootTitle:e.params.faceName,faceName:e.params.faceName}),meta:{rootTitle:e=>l("photos","{title}'s face",{title:e.params.faceName})}}]});P.afterEach(e=>{const o=e.meta?.rootTitle?.(e);o?document.title=`${o} - ${ce}`:document.title=ce});function qs(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}class A{#o=0;#e=[];#t=[];constructor(o){this.#o=o}async acquire(o=()=>1,i=""){const s=Symbol(i);return new Promise(a=>{this.#e.push({symbol:s,priority:o,resolve:a}),this.#t.length<this.#o&&this.#i()})}release(o){const i=this.#t.indexOf(o);if(i===-1)throw new Error("Can't release non active symbol");this.#t.splice(i,1),this.#e.length>0&&this.#t.length<this.#o&&this.#i()}#i(){const o={};for(const n of this.#e){const r=n.priority();o[r]=o[r]??[],o[r].push(n)}const i=Number.parseInt(Object.keys(o).sort()[0]),s=o[i][0],a=this.#e.indexOf(s);if(a===-1)throw new Error("Can't call non existant job");this.#e.splice(a,1),this.#t.push(s.symbol),s.resolve(s.symbol)}}const m=Qe(),Ve={files:{},nomediaPaths:[]},Ro={updateFiles(e,o){const i={};o.filter(s=>!s.hidden).forEach(s=>{if(e.nomediaPaths.some(n=>s.filename.startsWith(n)||s.filename.startsWith(`${z}${n}`)))return;s.fileid>=0&&(s.metadataPhotosSize??={width:256,height:256}),s.fileid=s.fileid.toString();const a=b(s.metadataPhotosOriginalDateTime*1e3||s.lastmod);s.timestamp=a.unix(),s.month=a.format("YYYYMM"),s.day=a.format("MMDD"),i[s.fileid]=s}),e.files={...e.files,...i}},setSubFolders(e,{fileid:o,folders:i}){if(e.files[o]){const s=i.map(a=>a.fileid).filter(a=>a>=0);g.set(e.files[o],"folders",s)}},setNomediaPaths(e,o){e.nomediaPaths=o},deleteFile(e,o){g.delete(e.files,o)},favoriteFile(e,{fileId:o,favoriteState:i}){g.set(e.files[o],"favorite",i)}},Vo={files:e=>e.files,nomediaPaths:e=>e.nomediaPaths},zo={updateFiles(e,{folder:o,files:i=[],folders:s=[]}){e.commit("updateFiles",[o,...i,...s]),e.commit("setSubFolders",{fileid:o.fileid,folders:s})},appendFiles(e,o=[]){e.commit("updateFiles",o)},setNomediaPaths(e,o){p.debug("Ignored paths",{paths:o}),e.commit("setNomediaPaths",o)},deleteFiles(e,o){const i=new A(5),s=o.map(n=>Ve.files[n]).reduce((n,r)=>({...n,[r.fileid]:r}),{});o.forEach(n=>e.commit("deleteFile",n));const a=o.map(async n=>{const r=s[n],c=await i.acquire();try{await m.deleteFile(r.filename)}catch(h){p.error(l("photos","Failed to delete {fileId}",{fileId:n}),{error:h}),w(l("photos","Failed to delete {fileName}",{fileName:r.basename})),e.dispatch("appendFiles",[r])}finally{i.release(c)}});return Promise.all(a)},toggleFavoriteForFiles(e,{fileIds:o,favoriteState:i}){const s=new A(5),a=o.map(async n=>{const r=e.state.files[n],c=await s.acquire();try{e.commit("favoriteFile",{fileId:n,favoriteState:i}),await m.customRequest(r.filename,{method:"PROPPATCH",data:`<?xml version="1.0"?>
							<d:propertyupdate xmlns:d="DAV:"
								xmlns:oc="http://owncloud.org/ns"
								xmlns:nc="http://nextcloud.org/ns"
								xmlns:ocs="http://open-collaboration-services.org/ns">
							<d:set>
								<d:prop>
									<oc:favorite>${i}</oc:favorite>
								</d:prop>
							</d:set>
							</d:propertyupdate>`})}catch(h){e.commit("favoriteFile",{fileId:n,favoriteState:i===0?1:0}),p.error(l("photos","Failed to set favorite state for {fileId}",{fileId:r.fileid}),{error:h}),w(l("photos","Failed to set favorite state for {fileName}",{fileName:r.basename}))}return s.release(c)});return Promise.all(a)}},jo={state:Ve,mutations:Ro,getters:Vo,actions:zo},ze={collections:{},collectionsFiles:{}},Ho={addCollections(e,{collections:o}){e.collections={...e.collections,...o.reduce((i,s)=>({...i,[s.filename]:s}),{})}},updateCollection(e,{collection:o}){e.collections[o.filename]=o},removeCollections(e,{collectionFileNames:o}){o.forEach(i=>delete e.collections[i]),o.forEach(i=>delete e.collectionsFiles[i])},setCollectionFiles(e,{collectionFileName:o,fileIds:i=[]}){const s=e.collectionsFiles[o]||[];e.collectionsFiles={...e.collectionsFiles,[o]:[...new Set([...s,...i])]},e.collections[o]!==void 0&&(e.collections[o].nbItems=i.length,e.collections[o].lastPhoto=Number.parseInt(i[i.length-1]))},addFilesToCollection(e,{collectionFileName:o,fileIdsToAdd:i}){const s=e.collectionsFiles[o]||[];e.collectionsFiles={...e.collectionsFiles,[o]:[...new Set([...s,...i])]},e.collections[o].nbItems+=i.length,e.collections[o].lastPhoto=Number.parseInt(i[i.length-1])},removeFilesFromCollection(e,{collectionFileName:o,fileIdsToRemove:i}){e.collectionsFiles={...e.collectionsFiles,[o]:e.collectionsFiles[o].filter(s=>!i.includes(s))},e.collections[o].nbItems-=i.length,i.includes(e.collections[o].lastPhoto.toString())&&(e.collections[o].lastPhoto=Number.parseInt(e.collectionsFiles[o][e.collectionsFiles[o].length]))}},Uo={collections:e=>e.collections,collectionsFiles:e=>e.collectionsFiles,collectionsWithPrefix:e=>function(o){return Object.values(e.collections).filter(i=>i.filename.startsWith(o)).reduce((i,s)=>({...i,[s.filename]:s}),{})}},qo={addCollections(e,{collections:o}){e.commit("addCollections",{collections:o})},async addFilesToCollection(e,{collectionFileName:o,fileIdsToAdd:i}){const s=new A(5);e.commit("addFilesToCollection",{collectionFileName:o,fileIdsToAdd:i});const a=i.map(async n=>{const r=e.getters.files[n],c=e.getters.collections[o],h=await s.acquire();try{await m.copyFile(r.filename,`${c.filename}/${r.basename}`)}catch(d){d.response.status!==409&&(e.commit("removeFilesFromCollection",{collectionFileName:o,fileIdsToRemove:[n]}),p.error(l("photos","Failed to add {fileBaseName} to collection {collectionFileName}",{fileBaseName:r.basename,collectionFileName:o}),{error:d}),w(l("photos","Failed to add {fileBaseName} to collection {collectionFileName}",{fileBaseName:r.basename,collectionFileName:o})))}finally{s.release(h)}});return Promise.all(a)},async removeFilesFromCollection(e,{collectionFileName:o,fileIdsToRemove:i}){const s=new A(5);e.commit("removeFilesFromCollection",{collectionFileName:o,fileIdsToRemove:i});const a=i.map(async n=>{const r=e.getters.files[n],c=await s.acquire();try{await m.deleteFile(r.filename)}catch(h){e.commit("addFilesToCollection",{collectionFileName:o,fileIdsToAdd:[n]}),p.error(l("photos","Failed to delete {fileBaseName}",{fileBaseName:r.basename}),{error:h}),w(l("photos","Failed to delete {fileBaseName}",{fileBaseName:r.basename}))}finally{s.release(c)}});return Promise.all(a)},async createCollection(e,{collection:o}){try{return await m.createDirectory(o.filename),e.commit("addCollections",{collections:[o]}),o}catch(i){p.error(l("photos","Failed to create {collectionFileName}",{collectionFileName:o.filename}),{error:i}),w(l("photos","Failed to create {collectionFileName}",{collectionFileName:o.filename}))}},async renameCollection(e,{collectionFileName:o,newBaseName:i}){const s=ze.collections[o],a={...s,basename:i,filename:s.filename.replace(new RegExp(`${s.basename}$`),i)};try{return e.commit("addCollections",{collections:[a]}),e.commit("setCollectionFiles",{collectionFileName:a.filename,fileIds:e.state.collectionsFiles[o]}),await m.moveFile(s.filename,a.filename),e.commit("removeCollections",{collectionFileNames:[o]}),a}catch(n){return e.commit("removeCollections",{collectionFileNames:[a.filename]}),p.error(l("photos","Failed to rename {currentCollectionFileName} to {newCollectionFileName}",{currentCollectionFileName:o,newCollectionFileName:a.filename}),{error:n}),w(l("photos","Failed to rename {currentCollectionFileName} to {newCollectionFileName}",{currentCollectionFileName:o,newCollectionFileName:a.filename})),s}},async updateCollection(e,{collectionFileName:o,properties:i}){const s=e.state.collections[o],a={...s,...i},n=Object.entries(i).map(([r,c])=>{switch(typeof c){case"string":return`<nc:${r}>${c}</nc:${r}>`;case"object":return`<nc:${r}>${JSON.stringify(c)}</nc:${r}>`;default:return""}}).join();try{return e.commit("updateCollection",{collection:a}),await m.customRequest(s.filename,{method:"PROPPATCH",data:`<?xml version="1.0"?>
							<d:propertyupdate xmlns:d="DAV:"
								xmlns:oc="http://owncloud.org/ns"
								xmlns:nc="http://nextcloud.org/ns"
								xmlns:ocs="http://open-collaboration-services.org/ns">
							<d:set>
								<d:prop>
									${n}
								</d:prop>
							</d:set>
							</d:propertyupdate>`}),a}catch(r){return e.commit("updateCollection",{collection:s}),p.error(l("photos","Failed to update properties of {collectionFileName} with {properties}",{collectionFileName:o,properties:JSON.stringify(i)}),{error:r}),w(l("photos","Failed to update properties of {collectionFileName} with {properties}",{collectionFileName:o,properties:JSON.stringify(i)})),s}},async deleteCollection(e,{collectionFileName:o}){try{const i=e.getters.collections[o];await m.deleteFile(i.filename),e.commit("removeCollections",{collectionFileNames:[o]})}catch(i){p.error(l("photos","Failed to delete {collectionFileName}",{collectionFileName:o}),{error:i}),w(l("photos","Failed to delete {collectionFileName}",{collectionFileName:o}))}}},Wo={state:ze,mutations:Ho,getters:Uo,actions:qo},I=function(e){return e?Number(e).toString()===e.toString():!1},Ws=function(e){const o=(e.startsWith("/")?e:`/${e}`).split("/");let i="";return o.forEach(s=>{s!==""&&(i+="/"+encodeURIComponent(s))}),i},Ys=function(e,o,i,s=!0){return e.isFavorite&&!o.isFavorite?-1:!e.isFavorite&&o.isFavorite?1:I(e[i])&&I(o[i])?s?Number(o[i])-Number(e[i]):Number(e[i])-Number(o[i]):e.type!=="file"&&o.type==="file"?s?-1:1:e.type==="file"&&o.type!=="file"?s?1:-1:I(new Date(e[i]).getTime())&&I(new Date(o[i]).getTime())?s?new Date(o[i]).getTime()-new Date(e[i]).getTime():new Date(e[i]).getTime()-new Date(o[i]).getTime():s?e[i]?.toString()?.localeCompare(o[i].toString(),ie())||1:-e[i]?.toString()?.localeCompare(o[i].toString(),ie())||-1};function U(e){const o=pe(e,pe);if(o.filename){const i=new URL(o.filename,Xe);o.source=i.href,o.filename=o.filename.replace("remote.php/dav/","")}return o}function pe(e,o){return Object.entries(e).reduce((i,[s,a])=>{if(a&&typeof a=="object"&&!Array.isArray(a))return{...i,...o?o(a):{[O(s)]:a}};switch(a){case"false":return{...i,[O(s)]:!1};case"true":return{...i,[O(s)]:!0};default:return{...i,[O(s)]:I(a)?Number(a):a}}},{})}let W=null;const je=()=>(W===null&&(W=et()),W);function Yo(e=[]){return`<?xml version="1.0"?>
			<d:propfind xmlns:d="DAV:"
				xmlns:oc="http://owncloud.org/ns"
				xmlns:nc="http://nextcloud.org/ns"
				xmlns:ocs="http://open-collaboration-services.org/ns">
				<d:prop>
					${je()}
					${e.join(`
`)}
				</d:prop>
			</d:propfind>`}const K="photos:user-config-changed";async function Jo(e){const o=Z(z,e)+"/";try{const i=await m.stat(o,{details:!0,data:se()});return ae(i.data)}catch(i){if(i.response?.status===404){p.debug("Photo location does not exist, creating it."),await m.createDirectory(o);const s=await m.stat(o,{details:!0,data:se()});return ae(s.data)}else p.fatal(i),w(l("photos","Could not load photos folder"))}throw new Error("Couldn't fetch photos upload folder")}const Ko={state(){return{croppedLayout:C("photos","croppedLayout","false")==="true",photosSourceFolders:JSON.parse(C("photos","photosSourceFolders",'["/Photos"]')),photosLocation:C("photos","photosLocation",""),photosLocationFolder:void 0}},mutations:{updateUserConfig(e,{key:o,value:i}){e[o]=i}},actions:{async updateUserConfig({commit:e},{key:o,value:i}){e("updateUserConfig",{key:o,value:i}),await tt.put(f("apps/photos/api/v1/config/"+o),{value:typeof i=="string"?i:JSON.stringify(i)}),ot(K,{key:o,value:i})}}};async function he(e,o){const i=await Jo(o.userConfig.photosLocation);e.commit("updateUserConfig",{key:"photosLocationFolder",value:i})}g.use(st);const N=new it({modules:{files:jo,folders:qt,albums:Kt,sharedAlbums:Jt,publicAlbums:Yt,faces:Qt,systemtags:Ut,collections:Wo,places:Wt,userConfig:Ko},plugins:[e=>{S()!==null&&he(e,e.state),e.subscribe(async(o,i)=>{o.type==="updateUserConfig"&&o.payload.key==="photosLocation"&&he(e,i)})}],strict:!1});Fe.sync(N,P),g.prototype.t=l,g.prototype.n=G,D("nc:metadata-photos-size"),D("nc:metadata-files-live-photo"),D("nc:metadata-blurhash"),D("nc:metadata-photos-original_date_time"),window.addEventListener("DOMContentLoaded",()=>{window.OCA.Files||(window.OCA.Files={}),Object.assign(window.OCA.Files,{App:{fileList:{filesClient:OC.Files.getClient()}}},window.OCA.Files)}),new g({el:"#content",name:"PhotosRoot",router:P,store:N,render:e=>e(ko)});const Zo={name:"PhotosPublic",components:{NcAppContent:ve,NcContent:ye},data(){return{svgplaceholder:Pe,imgplaceholder:Me,videoplaceholder:Ee}},async beforeMount(){"serviceWorker"in navigator?window.addEventListener("load",async()=>{try{const e=f("/apps/photos/service-worker.js",{},{noRewrite:!0}),o=await navigator.serviceWorker.register(e,{scope:f("/apps/photos")});p.debug("SW registered: ",{registration:o})}catch(e){p.error("SW registration failed: ",{error:e})}}):p.debug("Service Worker is not enabled on this browser.")},beforeDestroy(){window.removeEventListener("load",()=>{navigator.serviceWorker.register(f("/apps/photos/service-worker.js",{},{noRewrite:!0}))})}};var Go=function(){var e=this,o=e._self._c;return o("NcContent",{attrs:{"app-name":"photos"}},[o("NcAppContent",[o("router-view"),o("span",{staticClass:"hidden-visually",attrs:{role:"none"},domProps:{innerHTML:e._s(e.svgplaceholder)}}),o("span",{staticClass:"hidden-visually",attrs:{role:"none"},domProps:{innerHTML:e._s(e.imgplaceholder)}}),o("span",{staticClass:"hidden-visually",attrs:{role:"none"},domProps:{innerHTML:e._s(e.videoplaceholder)}})],1)],1)},Qo=[],Xo=u(Zo,Go,Qo,!1,null,null);const ei=Xo.exports;Fe.sync(N,P),g.prototype.t=l,g.prototype.n=G,window.addEventListener("DOMContentLoaded",()=>{window.OCA.Files||(window.OCA.Files={}),Object.assign(window.OCA.Files,{App:{fileList:{filesClient:OC.Files.getClient()}}},window.OCA.Files)}),new g({el:"#content",name:"PhotosRoot",router:P,store:N,render:e=>e(ei)});async function He(e={}){const o={firstResult:0,nbResults:200,mimesType:H,onThisDay:!1,onlyFavorites:!1,full:!1,...e},i=o.mimesType.reduce((r,c)=>`${r}
		<d:eq>
			<d:prop>
				<d:getcontenttype/>
			</d:prop>
			<d:literal>${c}</d:literal>
		</d:eq>
	`,""),s=o.onlyFavorites?`<d:eq>
				<d:prop>
					<oc:favorite/>
				</d:prop>
				<d:literal>1</d:literal>
			</d:eq>`:"",a=o.onThisDay?`<d:or>${Array(20).fill(1).map((r,c)=>{const h=b(Date.now()).startOf("day").subtract(3,"d").subtract(c+1,"y"),d=b(Date.now()).endOf("day").add(3,"d").subtract(c+1,"y");return`<d:and>
				<d:gt>
					<d:prop>
						<d:getlastmodified />
					</d:prop>
					<d:literal>${h.format(b.defaultFormatUtc)}</d:literal>
				</d:gt>
				<d:lt>
					<d:prop>
						<d:getlastmodified />
					</d:prop>
					<d:literal>${d.format(b.defaultFormatUtc)}</d:literal>
				</d:lt>
			</d:and>`}).join(`
`)}</d:or>`:"",n=N.state.userConfig.photosSourceFolders.map(r=>`
			<d:scope>
				<d:href>${Z(z,r)}</d:href>
				<d:depth>infinity</d:depth>
			</d:scope>`).join(`
`);return o.data=`<?xml version="1.0" encoding="UTF-8"?>
		<d:searchrequest xmlns:d="DAV:"
			xmlns:oc="http://owncloud.org/ns"
			xmlns:nc="http://nextcloud.org/ns"
			xmlns:ns="https://github.com/icewind1991/SearchDAV/ns"
			xmlns:ocs="http://open-collaboration-services.org/ns">
			<d:basicsearch>
				<d:select>
					<d:prop>
						${je()}
					</d:prop>
				</d:select>
				<d:from>
					${n}
				</d:from>
				<d:where>
					<d:and>
						<d:or>
							${i}
						</d:or>
						${s}
						${a}
					</d:and>
				</d:where>
				<d:orderby>
					<d:order>
						<d:prop><nc:metadata-photos-original_date_time/></d:prop>
						<d:descending/>
					</d:order>
					<d:order>
						<d:prop><d:getlastmodified/></d:prop>
						<d:descending/>
					</d:order>
				</d:orderby>
				<d:limit>
					<d:nresults>${o.nbResults}</d:nresults>
					<ns:firstresult>${o.firstResult}</ns:firstresult>
				</d:limit>
			</d:basicsearch>
		</d:searchrequest>`,o.details=!0,(await m.search("/",o)).data.results.map(r=>U(r))}const ti=V({name:"FavoriteIcon",components:{NcIconSvgWrapper:at},data(){return{StarSvg:nt}},mounted(){this.$nextTick(()=>{this.$el.querySelector("svg")?.setAttribute?.("viewBox","-4 -4 30 30")})},methods:{t:l}});var oi=function(){var e=this,o=e._self._c;return e._self._setupProxy,o("NcIconSvgWrapper",{staticClass:"favorite-marker-icon",attrs:{name:e.t("photos","Favorite"),svg:e.StarSvg}})},ii=[],si=u(ti,oi,ii,!1,null,"9131c562");const ai=si.exports,ni="images",Y=[],ue=async function(e){try{if(!Y[e]){const o=await(await window.caches?.open(ni))?.match(e);Y[e]=o!==void 0}return Y[e]}catch{return!1}},ri={name:"File",components:{FavoriteIcon:ai,NcCheckboxRadioSwitch:me,VideoIcon:ke,PlayCircleIcon:Tt},inheritAttrs:!1,props:{file:{type:Object,required:!0},selected:{type:Boolean,default:!1},allowSelection:{type:Boolean,default:!0},distance:{type:Number,default:0}},data(){return{initialized:!1,loadedSmall:!1,errorSmall:!1,loadedLarge:!1,errorLarge:!1}},computed:{ariaLabel(){return this.file.favorite?t("photos",'Favorite image, open the full size "{name}" image',{name:this.file.basename}):t("photos",'Open the full size "{name}" image',{name:this.file.basename})},isImage(){return this.file.mime.startsWith("image")},decodedEtag(){return this.file.etag.replace("&quot;","").replace("&quot;","")},srcLarge(){return this.getItemURL(512)},srcSmall(){return this.getItemURL(64)},isVisible(){return this.distance===0},hasBlurhash(){return this.file.metadataBlurhash!==void 0}},watch:{async file(){this.initialized=!1,this.loadedSmall=!1,this.errorSmall=!1,this.loadedLarge=!1,this.errorLarge=!1,await this.init()}},async mounted(){await this.init()},beforeDestroy(){this.$refs.imgSmall!==void 0&&(this.$refs.imgSmall.src=""),this.$refs.srcLarge!==void 0&&(this.$refs.srcLarge.src="")},methods:{async init(){[this.loadedSmall,this.loadedLarge]=await Promise.all([await ue(this.srcSmall),await ue(this.srcLarge)]),this.initialized=!0,await this.$nextTick(),this.drawBlurhash()},emitClick(){this.$emit("click",this.file.fileid)},onLoadSmall(){this.loadedSmall=!0},onLoadLarge(){this.loadedLarge=!0},onErrorSmall(){this.errorSmall=!0},onErrorLarge(){this.errorLarge=!0},onToggle(e){this.$emit("select-toggled",{id:this.file.fileid,value:e})},getItemURL(e){const o=this.$route?.params.token;return o?f(`/apps/photos/api/v1/publicPreview/${this.file.fileid}?etag=${this.decodedEtag}&x=${e}&y=${e}&token=${o}`):f(`/apps/photos/api/v1/preview/${this.file.fileid}?etag=${this.decodedEtag}&x=${e}&y=${e}`)},drawBlurhash(){if(!this.hasBlurhash||!this.$refs.canvas)return;const e=this.$refs.canvas.width,o=this.$refs.canvas.height,i=rt(this.file.metadataBlurhash,e,o),s=this.$refs.canvas.getContext("2d"),a=s.createImageData(e,o);a.data.set(i),s.putImageData(a,0,0)}}};var li=function(){var e=this,o=e._self._c;return o("div",{staticClass:"file-container",class:{selected:e.selected},attrs:{"data-test":"media"}},[o("a",{staticClass:"file",attrs:{href:e.file.source,"aria-label":e.ariaLabel},on:{click:function(i){return i.stopPropagation(),i.preventDefault(),e.emitClick.apply(null,arguments)}}},[o("div",{staticClass:"file__images"},[e.file.mime.includes("video")?o("VideoIcon",{staticClass:"icon-overlay",attrs:{size:64}}):e.file.metadataFilesLivePhoto!==void 0?o("PlayCircleIcon",{staticClass:"icon-overlay",attrs:{size:64}}):e._e(),e.initialized?[e.hasBlurhash&&!e.loadedSmall&&!e.loadedLarge?o("canvas",{ref:"canvas",staticClass:"file__blurhash",attrs:{"aria-hidden":"true"}}):e._e(),!e.loadedLarge&&(e.loadedSmall||e.distance<5&&!e.errorSmall)?o("img",{key:`${e.file.basename}-small`,ref:"imgSmall",attrs:{src:e.srcSmall,alt:e.file.basename,decoding:e.loadedSmall||e.isVisible?"sync":"async",fetchpriority:e.loadedSmall||e.isVisible?"high":"low",loading:e.loadedSmall||e.isVisible?"eager":e.distance<2?"auto":"lazy"},on:{load:e.onLoadSmall,error:e.onErrorSmall}}):e._e(),e.loadedLarge||(e.isVisible||e.distance<2&&(e.loadedSmall||e.errorSmall))&&!e.errorLarge?o("img",{key:`${e.file.basename}-large`,ref:"imgLarge",attrs:{src:e.srcLarge,alt:e.file.basename,decoding:e.loadedLarge||e.isVisible?"sync":"async",fetchpriority:e.loadedLarge||e.isVisible?"high":"low",loading:e.loadedLarge||e.isVisible?"auto":"lazy"},on:{load:e.onLoadLarge,error:e.onErrorLarge}}):e._e()]:e._e()],2)]),e.allowSelection?o("NcCheckboxRadioSwitch",{staticClass:"selection-checkbox",attrs:{"aria-label":e.t("photos","Select image {imageName}",{imageName:e.file.basename}),checked:e.selected},on:{"update:checked":e.onToggle}}):e._e(),e.file.favorite===1?e._m(0):e._e()],1)},ci=[function(){var e=this,o=e._self._c;return o("FavoriteIcon",{staticClass:"favorite-state"})}],di=u(ri,li,ci,!1,null,"49207ea2");const q=di.exports,pi={name:"DashboardOnThisDay",components:{File:q,NcButton:k,NcLoadingIcon:j,NcEmptyContent:x,ImageIcon:Le},data(){return{loading:!0,items:[]}},computed:{moreUrl(){return f("/apps/photos/thisday")}},async created(){try{this.items=await He({firstResult:0,nbResults:1,mimesType:H,onThisDay:!0})}catch(e){p.error("Failed to load on this day pictures",{error:e})}finally{this.loading=!1}}};var hi=function(){var e=this,o=e._self._c;return o("div",{staticClass:"on-this-day-dashboard"},[e.loading?o("NcLoadingIcon",{attrs:{size:48}}):e.items.length===0?o("NcEmptyContent",{attrs:{name:e.t("photos","No picture for this day"),description:e.t("photos","Picture taken on this day will show up here.")},scopedSlots:e._u([{key:"icon",fn:function(){return[o("ImageIcon")]},proxy:!0}])}):[o("File",{staticClass:"on-this-day-dashboard__file",attrs:{file:e.items[0],"allow-selection":!1}}),o("NcButton",{attrs:{href:e.moreUrl}},[e._v(" "+e._s(e.t("photos","More photos from this day"))+" ")])]],2)},ui=[],mi=u(pi,hi,ui,!1,null,"c15cee20");const fi=mi.exports;g.prototype.t=l,g.prototype.n=G,window.addEventListener("DOMContentLoaded",()=>{OCA.Dashboard.register("photos-onthisday",e=>{lt.PhotosOnThisDay=new g({el:e,store:N,render:o=>o(fi)})})});const gi={name:"FileLegacy",inheritAttrs:!1,props:{item:{type:Object,required:!0}},data(){return{loaded:!1,error:!1}},computed:{ariaUuid(){return`image-${this.item.injected.fileid}`},ariaLabel(){return t("photos",'Open the full size "{name}" image',{name:this.item.injected.basename})},isImage(){return this.item.injected.mime.startsWith("image")},decodedEtag(){return this.item.injected.etag.replace("&quot;","").replace("&quot;","")},src(){return f(`/core/preview?fileId=${this.item.injected.fileid}&c=${this.decodedEtag}&x=250&y=250&forceIcon=0&a=${this.croppedLayout?"0":"1"}`)},croppedLayout(){return this.$store.state.userConfig.croppedLayout}},beforeDestroy(){this.$refs.src=""},methods:{openViewer(){OCA.Viewer.open({fileInfo:this.item.injected,list:this.item.injected.list,loadMore:this.item.injected.loadMore?async()=>await this.item.injected.loadMore(!0):()=>[],canLoop:this.item.injected.canLoop})},onLoad(){this.loaded=!0},onError(){this.error=!0}}};var yi=function(){var e=this,o=e._self._c;return o("a",{staticClass:"file",class:{"file--cropped":e.croppedLayout},attrs:{href:e.item.injected.source,"aria-label":e.ariaLabel},on:{click:function(i){return i.preventDefault(),e.openViewer.apply(null,arguments)}}},[e.item.injected.mime.includes("video")&&e.item.injected.hasPreview?o("div",{staticClass:"icon-video-white"}):e._e(),o("transition-group",{staticClass:"transition-group",attrs:{name:"fade"}},[e.error?e._e():o("img",{key:`${e.item.injected.basename}-img`,ref:"img",attrs:{src:e.src,alt:e.item.injected.basename,"aria-describedby":e.ariaUuid},on:{load:e.onLoad,error:e.onError}}),!e.loaded||e.error?o("svg",{key:`${e.item.injected.basename}-svg`,attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",fill:"url(#placeholder__gradient)"}},[e.isImage?o("use",{attrs:{href:"#placeholder--img"}}):o("use",{attrs:{href:"#placeholder--video"}})]):e._e()]),o("p",{staticClass:"hidden-visually",attrs:{id:e.ariaUuid}},[e._v(e._s(e.item.injected.basename))]),o("div",{staticClass:"cover",attrs:{role:"none"}})],1)},vi=[],bi=u(gi,yi,vi,!1,null,"054bc81d");const Js=bi.exports,X={name:"AbortControllerMixin",data(){return{abortController:new AbortController}},beforeDestroy(){this.abortController.abort()},beforeRouteLeave(e,o,i){this.abortController.abort(),this.abortController=new AbortController,i()}},Fi={name:"HeaderNavigation",components:{ArrowLeft:It,NcButton:k,NcLoadingIcon:j},inheritAttrs:!1,props:{loading:{type:Boolean,default:!1},path:{type:String,default:"/"},title:{type:String,required:!0},rootTitle:{type:String,default:t("photos","Photos")},params:{type:Object,default:null}},computed:{isRoot(){const e=this.path==="/";return this.toggleNavigationButton(!e),e},name(){return this.isRoot?this.rootTitle:this.title},parentPath(){const e=this.path.split("/");e.pop();const o=e.join("/");return this.isRoot||o.trim()===""?"/":e.join("/")},parentName(){return this.parentPath&&this.parentPath.split("/").pop()},backToText(){return this.parentPath==="/"?t("photos","Back to {folder}",{folder:this.rootTitle}):t("photos","Back to {folder}",{folder:this.parentName})},to(){const e=/^\/?(.*)/i.exec(this.parentPath)[1],{name:o,params:i}=Object.assign({},this.$route,{params:this.params||{path:e}});return e===""?{name:o}:decodeURIComponent(this.$router.resolve({name:o,params:i}).resolved.path)}},methods:{folderUp(){this.$router.push(this.to)},refresh(){this.$emit("refresh")},toggleNavigationButton(e){const o=document.querySelector("button.app-navigation-toggle");o!==null&&(o.style.display=e?"none":null)}}};var wi=function(){var e=this,o=e._self._c;return o("div",{staticClass:"photos-navigation",class:{"photos-navigation--root":e.isRoot},attrs:{role:"toolbar"}},[e.isRoot?e._e():o("NcButton",{staticClass:"photos-navigation__back",attrs:{"aria-label":e.t("photos","Go back"),type:"tertiary"},on:{click:e.folderUp},scopedSlots:e._u([{key:"icon",fn:function(){return[o("ArrowLeft",{attrs:{size:20}})]},proxy:!0}],null,!1,1821202730)}),o("div",{staticClass:"photos-navigation__title"},[o("h1",{staticClass:"photos-navigation__title__main",on:{click:e.refresh}},[e._v(" "+e._s(e.name)+" ")]),o("div",{staticClass:"photos-navigation__title__sub"}),e._t("subtitle")],2),e.$slots.default?o("div",{staticClass:"photos-navigation__content"},[e._t("default")],2):e._e(),o("NcLoadingIcon",{directives:[{name:"show",rawName:"v-show",value:e.loading,expression:"loading"}],staticClass:"photos-navigation__loader"}),o("div",{staticClass:"photos-navigation__content-right"},[e._t("right")],2)],1)},_i=[],Ci=u(Fi,wi,_i,!1,null,"1dab4851");const Si=Ci.exports,B={400:{marginTop:66,marginW:8,count:3,folderCount:1},700:{marginTop:66,marginW:8,count:4,folderCount:1},1024:{marginTop:66,marginW:44,count:5,folderCount:2},1280:{marginTop:66,marginW:44,count:4,folderCount:2},1440:{marginTop:88,marginW:66,count:5,folderCount:3},1600:{marginTop:88,marginW:66,count:6,folderCount:4},2048:{marginTop:88,marginW:66,count:7,folderCount:4},2560:{marginTop:88,marginW:88,count:8,folderCount:6},3440:{marginTop:88,marginW:88,count:9,folderCount:8},max:{marginTop:88,marginW:88,count:10,folderCount:10}},R=new g({data(){return{gridConfig:B.max}},watch:{gridConfig(e){this.$emit("changed",e)}},created(){window.addEventListener("resize",this.handleWindowResize),this.handleWindowResize()},beforeDestroy(){window.removeEventListener("resize",this.handleWindowResize)},methods:{handleWindowResize(){const e=Object.keys(B).find(o=>o>document.documentElement.clientWidth);this.gridConfig=B[e]||B.max}}}),Ks={data(){return{gridConfig:{}}},created(){R.$on("changed",e=>{this.gridConfig=e}),p.debug("Grid config",{gridConfig:R.gridConfig}),this.gridConfig=R.gridConfig},beforeDestroy(){R.$off("changed",this.gridConfig)}};async function Ni(e,o={}){try{const i=await m.stat(e,{data:Yo(),details:!0,...o});return U(i.data)}catch(i){if(i.code==="ERR_CANCELED")return null;throw i}}const ki={name:"CollectionsList",components:{AlertCircle:Q,NcEmptyContent:x},props:{collections:{type:Object,required:!0},loading:{type:Boolean,default:!1},error:{type:Error,default:null}},computed:{noCollection(){return Object.keys(this.collections).length===0}},methods:{t:l}};var Ai=function(){var e=this,o=e._self._c;return e.error?o("NcEmptyContent",{attrs:{name:e.t("photos","An error occurred")}},[o("AlertCircle",{attrs:{slot:"icon"},slot:"icon"})],1):o("div",{staticClass:"collections"},[e._t("header"),e.noCollection&&!e.loading?e._t("empty-collections-list"):e.noCollection?e._e():o("ul",{staticClass:"collections__list"},[e._l(e.collections,function(i){return e._t("default",null,{collection:i})})],2)],2)},Li=[],Ti=u(ki,Ai,Li,!1,null,"d41938e7");const Zs=Ti.exports,Ii={name:"CollectionCover",components:{ImageMultiple:Pt},props:{coverUrl:{type:String,required:!0},altImg:{type:String,required:!0},link:{type:String,required:!0}}};var Pi=function(){var e=this,o=e._self._c;return o("li",[o("router-link",{staticClass:"collection-cover",attrs:{to:e.link}},[e.coverUrl!==""?o("img",{staticClass:"collection-cover__image",attrs:{src:e.coverUrl,alt:e.altImg}}):o("div",{staticClass:"collection-cover__image collection-cover__image--placeholder"},[o("ImageMultiple",{attrs:{size:128}})],1),o("div",{staticClass:"collection-cover__details"},[o("div",{staticClass:"collection-cover__details__title"},[e._t("default")],2),o("div",{staticClass:"collection-cover__details__subtitle"},[e._t("subtitle")],2)])])],1)},xi=[],Mi=u(Ii,Pi,xi,!1,null,"933668a2");const Gs=Mi.exports;function Ue(e=[]){return`<?xml version="1.0"?>
			<d:propfind xmlns:d="DAV:"
				xmlns:oc="http://owncloud.org/ns"
				xmlns:nc="http://nextcloud.org/ns"
				xmlns:ocs="http://open-collaboration-services.org/ns">
				<d:prop>
					<nc:last-photo />
					<nc:nbItems />
					${e.join("")}
				</d:prop>
			</d:propfind>`}function Ei(e=[]){return`<?xml version="1.0"?>
			<d:propfind xmlns:d="DAV:"
				xmlns:oc="http://owncloud.org/ns"
				xmlns:nc="http://nextcloud.org/ns"
				xmlns:ocs="http://open-collaboration-services.org/ns">
				<d:prop>
					<d:getcontentlength />
					<d:getcontenttype />
					<d:getetag />
					<d:getlastmodified />
					<d:resourcetype />
					<nc:metadata-photos-size />
					<nc:metadata-photos-original_date_time />
					<nc:metadata-files-live-photo />
					<nc:has-preview />
					<nc:hidden />
					<oc:favorite />
					<oc:fileid />
					<oc:permissions />
					${e.join("")}
				</d:prop>
			</d:propfind>`}async function $i(e,o,i=[],s=m){try{const a=await s.stat(e,{data:Ue(i),details:!0,...o});return p.debug("[Collections] Fetched a collection: ",{data:a.data}),qe(a.data)}catch(a){if(a instanceof DOMException&&a.code===a.ABORT_ERR)return null;throw a}}async function Oi(e,o,i=[],s=m){try{const a=await s.getDirectoryContents(e,{data:Ue(i),details:!0,...o});return p.debug(`[Collections] Fetched ${a.data.length} collections: `,{data:a.data}),a.data.filter(n=>n.filename!==e).map(qe)}catch(a){if(a instanceof DOMException&&a.code===a.ABORT_ERR)return[];throw a}}function qe(e){let o=[];e.props.collaborators===void 0||e.props.collaborators===""?o=[]:typeof e.props.collaborators.collaborator=="object"&&(Array.isArray(e.props.collaborators.collaborator)?o=e.props.collaborators.collaborator:o=[e.props.collaborators.collaborator]);const i=U(e);i.collaborators=o;const s=JSON.parse(e.dateRange?.replace(/&quot;/g,'"')??"{}");s.start===null&&(s.start=b().unix(),s.end=b().unix());const a={startDate:b.unix(s.start).format("MMMM YYYY"),endDate:b.unix(s.end).format("MMMM YYYY")};return a.startDate===a.endDate?i.date=a.startDate:i.date=l("photos","{startDate} to {endDate}",a),i}async function Di(e,o,i=[],s=m){try{const a=(await s.getDirectoryContents(e,{data:Ei(i),details:!0,...o})).data.map(n=>U(n)).filter(n=>n.fileid);return p.debug(`[Collections] Fetched ${a.length} new files: `,{fetchedFiles:a}),a}catch(a){if(a instanceof DOMException&&a.code===a.ABORT_ERR)return[];throw p.error("Error fetching collection files",{error:a}),a}}const Qs={name:"FetchCollectionContentMixin",data(){return{fetchSemaphore:new A(1),loadingCollection:!1,loadingCollectionFiles:!1,errorFetchingCollection:null,errorFetchingCollectionFiles:null}},mixins:[X],methods:{...M(["appendFiles","addCollections","setCollectionFiles"]),async fetchCollection(e,o,i){if(this.loadingCollection)return null;try{this.loadingCollection=!0,this.errorFetchingCollection=null;const s=await $i(e,{signal:this.abortController.signal},o,i);return this.addCollections({collections:[s]}),s}catch(s){if(s.response?.status===404)return this.errorFetchingCollection=404,null;this.errorFetchingCollection=s,p.error("[PublicCollectionContent] Error fetching collection",{error:s}),w(this.t("photos","Failed to fetch collection."))}finally{this.loadingCollection=!1}return null},async fetchCollectionFiles(e,o,i,s=[]){if(this.loadingCollectionFiles)return[];const a=await this.fetchSemaphore.acquire();try{this.errorFetchingCollectionFiles=null,this.loadingCollectionFiles=!0;let n=await Di(e,{signal:this.abortController.signal},o,i);const r=n.map(c=>c.fileid.toString());return s.forEach(c=>n=n.map(c)),this.appendFiles(n),n.length>0&&await this.$store.commit("setCollectionFiles",{collectionFileName:e,fileIds:r}),n}catch(n){if(n.response?.status===404)return this.errorFetchingCollectionFiles=404,[];this.errorFetchingCollectionFiles=n,w(this.t("photos","Failed to fetch collections list.")),p.error("[PublicCollectionContent] Error fetching collection files",{error:n})}finally{this.loadingCollectionFiles=!1,this.fetchSemaphore.release(a)}return[]}}},Xs={name:"FetchCollectionsMixin",data(){return{errorFetchingCollections:null,loadingCollections:!1}},mixins:[X],methods:{...M(["addCollections"]),async fetchCollections(e,o,i){if(this.loadingCollections)return[];try{this.loadingCollections=!0,this.errorFetchingCollections=null;const s=await Oi(e,{signal:this.abortController.signal},o,i);return this.addCollections({collections:s}),s}catch(s){s.response?.status===404?this.errorFetchingCollections=404:this.errorFetchingCollections=s,p.error("Error fetching collections:",{error:s})}finally{this.loadingCollections=!1}return[]}}},We={name:"FetchFilesMixin",mixins:[X],data(){return{errorFetchingFiles:null,loadingFiles:!1,doneFetchingFiles:!1,fetchSemaphore:new A(1),fetchedFileIds:[]}},watch:{"$route.path"(){this.resetFetchFilesState()}},methods:{async fetchFiles(e={},o=[],i=!1){if(this.doneFetchingFiles&&!i||this.loadingFiles)return[];const s=await this.fetchSemaphore.acquire();try{this.errorFetchingFiles=null,this.loadingFiles=!0;const a=200,n=await He({firstResult:this.fetchedFileIds.length,nbResults:a,...e,signal:this.abortController.signal});n.length!==a&&(this.doneFetchingFiles=!0);const r=n.map(c=>c.fileid).filter(c=>!this.fetchedFileIds.includes(c.toString()));return this.fetchedFileIds.push(...r.map(c=>c.toString()).filter(c=>!o.includes(c))),this.$store.dispatch("appendFiles",n),p.debug(`[FetchFilesMixin] Fetched ${r.length} new files: `,{fileIds:r}),r}catch(a){if(a.response?.status===404){const n=N.state.userConfig.photosSourceFolders;for(const r of n)if(a.response?.data?.match(`File with name /${r} could not be located`)!==null){p.debug(`The ${r} folder does not exist, creating it.`);try{return await m.createDirectory(Z(z,r)),this.resetFetchFilesState(),[]}catch(c){this.errorFetchingFiles=404,p.error("Fail to create source directory",{error:c})}}}else{if(a instanceof DOMException&&a.code===a.ABORT_ERR)return[];this.errorFetchingFiles=a}w(l("photos","Error fetching files")),p.error(a)}finally{this.loadingFiles=!1,this.fetchSemaphore.release(s)}return[]},resetFetchFilesState(){this.doneFetchingFiles=!1,this.errorFetchingFiles=null,this.loadingFiles=!1,this.fetchedFileIds=[]}}},Bi={name:"ActionFavorite",components:{Star:Ae,NcActionButton:we},props:{selectedFileIds:{type:Array,required:!0}},computed:{...E(["files"]),shouldFavoriteSelection(){return this.selectedFileIds.some(e=>this.files[e].favorite===0)}},methods:{...M(["toggleFavoriteForFiles"]),async favoriteSelection(){await this.toggleFavoriteForFiles({fileIds:this.selectedFileIds,favoriteState:1})},async unFavoriteSelection(){await this.toggleFavoriteForFiles({fileIds:this.selectedFileIds,favoriteState:0})}}};var Ri=function(){var e=this,o=e._self._c;return e.shouldFavoriteSelection?o("NcActionButton",{attrs:{"close-after-click":!0,"aria-label":e.t("photos","Mark selection as favorite")},on:{click:e.favoriteSelection}},[e._v(" "+e._s(e.t("photos","Add selection to favorites"))+" "),o("Star",{attrs:{slot:"icon"},slot:"icon"})],1):o("NcActionButton",{attrs:{"close-after-click":!0,"aria-label":e.t("photos","Remove selection from favorites")},on:{click:e.unFavoriteSelection}},[e._v(" "+e._s(e.t("photos","Remove selection from favorites"))+" "),o("Star",{attrs:{slot:"icon"},slot:"icon"})],1)},Vi=[],zi=u(Bi,Ri,Vi,!1,null,null);const ji=zi.exports,ee={name:"FilesSelectionMixin",data(){return{selection:{}}},watch:{$route(){this.resetSelection()}},methods:{onFileSelectToggle({id:e,value:o}){this.$set(this.selection,e,o)},onUncheckFiles(e){e.forEach(o=>this.$set(this.selection,o,!1))},resetSelection(){this.selection={}}},computed:{selectedFileIds(){return Object.keys(this.selection).filter(e=>this.selection[e])}}};function Hi(e,o,i=200){if(o===0)return[];const s=[];let a=0,n=0;for(;n<e.length;){const r=[];do r.push(e[n++]);while(n<e.length&&Ui([...r,e[n]],i)<=o);const c=qi(r,o,e.length===n,i);s[a]={items:r.map(h=>({...h,width:c*h.ratio,height:c})),height:c,key:r.map(h=>h.id).join("-")},a+=1}return s}function Ui(e,o){return e.map(i=>o*i.ratio).reduce((i,s)=>i+s)}function qi(e,o,i,s){const a=e.map(r=>r.ratio).reduce((r,c)=>r+c);let n=o/a;return e.length===1&&e[0].width>o&&(n=o/e[0].ratio),i&&(n=Math.min(s+20,n)),n}const Wi={};var Yi=function(e,o){return e("ul",o._l(o.props.rows,function(i){return e("div",{key:i.key,staticClass:"tiled-row",style:{height:`${i.height}px`}},o._l(i.items,function(s){return e("li",{key:s.id,style:{width:s.ratio?`${i.height*s.ratio}px`:"100%",height:`${i.height}px`}},[o._t("default",null,{row:i,item:s})],2)}),0)}),0)},Ji=[],Ki=u(Wi,Yi,Ji,!0,null,"36c907e2");const Zi=Ki.exports,Gi={name:"TiledLayout",components:{TiledRows:Zi},props:{sections:{type:Array,required:!0},baseHeight:{type:Number,default:200}},data(){return{containerWidth:0,resizeObserver:null}},computed:{tiledSections(){return p.debug("[TiledLayout] Computing rows",{items:this.sections}),this.sections.map(e=>{const o=Hi(e.items,this.containerWidth,this.baseHeight);return{...e,key:e.id,rows:o.map(i=>({...i,sectionKey:e.id})),height:o.reduce((i,s)=>i+s.height,0)}})}},mounted(){this.resizeObserver=new ResizeObserver(e=>{for(const o of e){const i=o.contentRect;o.target.classList.contains("tiled-container")&&(this.containerWidth=i.width)}}),this.resizeObserver.observe(this.$refs.tiledLayoutContainer)},beforeDestroy(){this.resizeObserver?.disconnect()}};var Qi=function(){var e=this,o=e._self._c;return o("div",{ref:"tiledLayoutContainer",staticClass:"tiled-container"},[e._t("default",function(){return[o("TiledRows",{attrs:{rows:e.tiledSections}})]},{tiledSections:e.tiledSections})],2)},Xi=[],es=u(Gi,Qi,Xi,!1,null,"573bf53c");const ts=es.exports,os={name:"VirtualScrolling",props:{sections:{type:Array,required:!0},containerElement:{type:HTMLElement,default:null},useWindow:{type:Boolean,default:!1},headerHeight:{type:Number,default:75},renderDistance:{type:Number,default:.5},bottomBufferRatio:{type:Number,default:2},scrollToKey:{type:String,default:""}},data(){return{scrollPosition:0,containerHeight:0,rowsContainerHeight:0,resizeObserver:null}},computed:{visibleSections(){p.debug("[VirtualScrolling] Computing visible section",{sections:this.sections});const e=this.containerHeight,o=this.scrollPosition,i=o+e;let s=0,a=0;const n=this.sections.map(d=>(a+=this.headerHeight,{...d,rows:d.rows.reduce((F,_)=>{s=a,a+=_.height;let v=0;return a<o?v=(o-a)/e:s>i&&(v=(s-i)/e),v>this.renderDistance?F:[...F,{..._,distance:v}]},[])})).filter(d=>d.rows.length>0),r=n.flatMap(({rows:d})=>d).flatMap(({items:d})=>d);r.forEach(d=>d.key=this.rowIdToKeyMap[d.id]);const c=r.map(({key:d})=>d).filter(d=>d!==void 0),h=Object.values(this.rowIdToKeyMap).filter(d=>!c.includes(d));return r.filter(({key:d})=>d===void 0).forEach(d=>d.key=h.pop()??Math.random().toString(36).substr(2)),this.rowIdToKeyMap=r.reduce((d,{id:F,key:_})=>({...d,[`${F}`]:_}),{}),n},totalHeight(){return this.sections.map(e=>this.headerHeight+e.height).reduce((e,o)=>e+o,0)+200},paddingTop(){if(this.visibleSections.length===0)return 0;let e=0;for(const o of this.sections){if(o.key!==this.visibleSections[0].rows[0].sectionKey){e+=this.headerHeight+o.height;continue}for(const i of o.rows){if(i.key===this.visibleSections[0].rows[0].key)return e;e+=i.height}e+=this.headerHeight}return e},rowsContainerStyle(){return{height:`${this.totalHeight}px`,paddingTop:`${this.paddingTop}px`}},isNearBottom(){const e=this.containerHeight*this.bottomBufferRatio;return this.scrollPosition+this.containerHeight>=this.totalHeight-e},container(){return p.debug("[VirtualScrolling] Computing container"),this.containerElement!==null?this.containerElement:this.useWindow?window:this.$refs.container}},watch:{isNearBottom(e){p.debug("[VirtualScrolling] isNearBottom changed",{value:e}),e&&this.$emit("need-content")},visibleSections(){this.isNearBottom&&this.$emit("need-content")},scrollToKey(e){let o=0;for(const i of this.sections){if(i.key!==e){o+=this.headerHeight+i.height;continue}break}p.debug("[VirtualScrolling] Scrolling to",{currentRowTopDistanceFromTop:o}),this.$refs.container.scrollTo({top:o,behavior:"smooth"})}},beforeCreate(){this.rowIdToKeyMap={}},mounted(){this.resizeObserver=new ResizeObserver(e=>{for(const o of e){const i=o.contentRect;o.target===this.container&&(this.containerHeight=i.height),o.target.classList.contains("vs-rows-container")&&(this.rowsContainerHeight=i.height)}}),this.useWindow?(window.addEventListener("resize",this.updateContainerSize,{passive:!0}),this.containerHeight=window.innerHeight):this.resizeObserver.observe(this.container),this.resizeObserver.observe(this.$refs.rowsContainer),this.container?.addEventListener("scroll",this.updateScrollPosition,{passive:!0})},beforeDestroy(){this.useWindow&&window.removeEventListener("resize",this.updateContainerSize),this.resizeObserver?.disconnect(),this.container?.removeEventListener("scroll",this.updateScrollPosition)},methods:{updateScrollPosition(){this._onScrollHandle??=requestAnimationFrame(()=>{this._onScrollHandle=null,this.useWindow?this.scrollPosition=this.container.scrollY:this.scrollPosition=this.container.scrollTop})},updateContainerSize(){this.containerHeight=window.innerHeight}}};var is=function(){var e=this,o=e._self._c;return!e.useWindow&&e.containerElement===null?o("div",{ref:"container",staticClass:"vs-container"},[o("div",{ref:"rowsContainer",staticClass:"vs-rows-container",style:e.rowsContainerStyle},[e._t("default",null,{visibleSections:e.visibleSections}),e._t("loader")],2)]):o("div",{ref:"rowsContainer",staticClass:"vs-rows-container",style:e.rowsContainerStyle},[e._t("default",null,{visibleSections:e.visibleSections}),e._t("loader")],2)},ss=[],as=u(os,is,ss,!1,null,"ba4242f3");const ns=as.exports,rs={name:"FilesListViewer",components:{PackageVariant:xt,NcEmptyContent:x,NcLoadingIcon:j,TiledLayout:ts,VirtualScrolling:ns},props:{fileIds:{type:Array,default:void 0},fileIdsBySection:{type:Object,default:void 0},sections:{type:Array,default:void 0},loading:{type:Boolean,default:!1},emptyMessage:{type:String,default:""},baseHeight:{type:Number,default:200},sectionHeaderHeight:{type:Number,default:75},scrollToSection:{type:String,default:""},containerElement:{type:HTMLElement,default:null},useWindow:{type:Boolean,default:!1}},data(){return{placeholderFiles:Array(20).fill(0).map((e,o)=>{const i=this.croppedLayout?200:200*(1+Math.random()*2);return{id:o,width:i,height:200,ratio:i/200}})}},computed:{...E(["files"]),showPlaceholders(){return this.loading&&(this.fileIds?.length===0||this.sections?.length===0)},itemsBySections(){return this.fileIds!==void 0?this.showPlaceholders?[{id:"",items:this.placeholderFiles}]:[{id:"",items:this.fileIds.filter(e=>this.files[e]).map(this.mapFileToItem)}]:this.sections!==void 0?this.showPlaceholders?[{id:"placeholder",items:this.placeholderFiles}]:this.sections.map(e=>({id:e,items:this.fileIdsBySection[e].filter(o=>this.files[o]).map(this.mapFileToItem)})):[]},photosCount(){return this.itemsBySections.map(({items:e})=>e.length).reduce((e,o)=>e+o,0)},showLoader(){return this.loading&&(this.fileIds?.length!==0||this.sections?.length!==0)},croppedLayout(){return this.$store.state.userConfig.croppedLayout}},mounted(){Ce("files:node:updated",this.handleFileUpdated)},destroyed(){_e("files:node:updated",this.handleFileUpdated)},methods:{...M(["appendFiles"]),needContent(){this.$emit("need-content")},mapFileToItem(e){const o=this.files[e];return{id:o.fileid,width:o.metadataPhotosSize.width,height:o.metadataPhotosSize.height,ratio:this.croppedLayout?1:o.metadataPhotosSize.width/o.metadataPhotosSize.height}},async handleFileUpdated({fileid:e}){const o=await Ni(this.files[e].filename);this.appendFiles([o])}}};var ls=function(){var e=this,o=e._self._c;return o("div",{staticClass:"files-list-viewer"},[e.emptyMessage!==""&&e.photosCount===0&&!e.loading?o("NcEmptyContent",{key:"emptycontent",attrs:{name:e.emptyMessage}},[o("PackageVariant",{attrs:{slot:"icon"},slot:"icon"})],1):e._e(),o("TiledLayout",{attrs:{"base-height":e.baseHeight,sections:e.itemsBySections},scopedSlots:e._u([{key:"default",fn:function({tiledSections:i}){return o("VirtualScrolling",{attrs:{"use-window":e.useWindow,"container-element":e.containerElement,sections:i,"scroll-to-key":e.scrollToSection,"header-height":e.sectionHeaderHeight},on:{"need-content":e.needContent},scopedSlots:e._u([{key:"default",fn:function({visibleSections:s}){return e._l(s,function(a){return o("div",{key:a.id},[a.id!==""?[e.showPlaceholders?o("div",{staticClass:"files-list-viewer__placeholder",style:{"flex-basis":"100%",height:`${e.sectionHeaderHeight}px`}}):e._t("default",null,{file:{id:a.id},isHeader:!0})]:e._e(),o("ul",[e._l(a.rows,function(n,r){return e._l(n.items,function(c){return o("li",{key:c.key,class:{"last-tiled-rows":r===a.rows.length-1},style:{"flex-basis":`${c.width-1}px`,height:`${c.height}px`}},[e.showPlaceholders?o("div",{staticClass:"files-list-viewer__placeholder"}):e._t("default",null,{file:c,distance:n.distance})],2)})})],2)],2)})}}])},[e.loading&&!e.showPlaceholders?o("NcLoadingIcon",{staticClass:"files-list-viewer__loader",attrs:{slot:"loader"},slot:"loader"}):e._e()],1)}}])})],1)},cs=[],ds=u(rs,ls,cs,!1,null,"8203799d");const te=ds.exports,ps={name:"CollectionContent",components:{AlertCircle:Q,FolderMultipleImage:Te,NcEmptyContent:x,FilesListViewer:te,File:q},mixins:[ee,Se],props:{collection:{type:Object,default:()=>{}},collectionFileIds:{type:Array,required:!0},loading:{type:Boolean,default:!1},allowSelection:{type:Boolean,default:!0},error:{type:[Error,Number],default:null}},data(){return{appContent:document.getElementById("app-content-vue")}},computed:{files(){return this.$store.getters.files},sortedCollectionFileIds(){return this.collectionFileIds.toSorted((e,o)=>this.files[e].timestamp<this.files[o].timestamp?-1:1)}},methods:{openViewer(e){const o=this.files[e];OCA.Viewer.open({fileInfo:o,list:this.sortedCollectionFileIds.map(i=>this.files[i]).filter(i=>!i.sectionHeader),loadMore:o.loadMore?async()=>await o.loadMore(!0):()=>[],canLoop:o.canLoop})},t:l}};var hs=function(){var e=this,o=e._self._c;return e.collection===void 0&&!e.loading||e.error===404?o("NcEmptyContent",{staticClass:"empty-content-with-illustration",attrs:{name:e.t("photos","This collection does not exist")}},[o("FolderMultipleImage",{attrs:{slot:"icon"},slot:"icon"})],1):e.error?o("NcEmptyContent",{attrs:{name:e.t("photos","An error occurred")}},[o("AlertCircle",{attrs:{slot:"icon"},slot:"icon"})],1):o("div",{staticClass:"collection"},[e._t("header",null,{selectedFileIds:e.selectedFileIds,resetSelection:e.resetSelection}),e.sortedCollectionFileIds.length===0&&!e.loading?e._t("empty-content"):e._e(),e.collection!==void 0&&e.sortedCollectionFileIds.length>0?o("FilesListViewer",{staticClass:"collection__media",attrs:{"container-element":e.appContent,"file-ids":e.sortedCollectionFileIds,"base-height":e.isMobile?120:200,loading:e.loading},scopedSlots:e._u([{key:"default",fn:function({file:i,distance:s}){return o("File",{attrs:{file:e.files[i.id],"allow-selection":e.allowSelection,selected:e.selection[i.id]===!0,distance:s},on:{click:e.openViewer,"select-toggled":e.onFileSelectToggle}})}}],null,!1,3813029717)}):e._e()],2)},us=[],ms=u(ps,hs,us,!1,null,"e132e602");const ea=ms.exports,Ye={name:"FilesByMonthMixin",computed:{fileIdsByMonth(){const e={};for(const o of this.fetchedFileIds){const i=this.files[o];i&&(e[i.month]=e[i.month]??[],e[i.month].push(i.fileid))}return Object.keys(e).forEach(o=>e[o].sort(this.sortFilesByTimestamp)),e},monthsList(){return Object.keys(this.fileIdsByMonth).sort((e,o)=>e>o?-1:1)}},methods:{sortFilesByTimestamp(e,o){return this.files[e].timestamp>this.files[o].timestamp?-1:1}}},fs=V({name:"PhotosPicker",components:{File:q,FilesListViewer:te,ImagePlus:Mt,NcButton:k,NcDialog:ht,NcLoadingIcon:j,NcSelect:pt,NcNoteCard:dt,UploadPicker:ct},mixins:[We,Ye,ee],props:{open:{type:Boolean,default:!0},name:{type:String,required:!0},destination:{type:String,required:!0},blacklistIds:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1}},emits:["files-picked","update:open"],setup(){return{isMobile:ut()}},data(){return{allowedMimes:H,targetMonth:null,uploadContext:{route:"albumpicker"},currentUser:S().uid}},computed:{...E(["files"]),photosLocationFolder(){return this.$store.state.userConfig.photosLocationFolder}},watch:{monthsList(e){this.targetMonth===null&&(this.targetMonth=e[0])}},methods:{onFocusOut(e){e.relatedTarget===null&&e.target.focus({preventScroll:!0})},getFiles(){this.fetchFiles({},this.blacklistIds)},refreshFiles(){this.fetchFiles({firstResult:0},[...this.blacklistIds,...this.fetchedFileIds],!0)},emitPickedEvent(){this.$emit("files-picked",this.selectedFileIds)},dateMonthAndYear(e){return this.isMobile?b(e,"YYYYMM").format("MMM YYYY"):b(e,"YYYYMM").format("MMMM YYYY")}}});var gs=function(){var e=this,o=e._self._c;return e._self._setupProxy,o("NcDialog",{attrs:{"content-classes":"photos-picker",name:e.name,open:e.open,"out-transition":"",size:"large"},on:{"update:open":i=>e.$emit("update:open",i)},scopedSlots:e._u([e.monthsList.length>0?{key:"navigation",fn:function({isCollapsed:i}){return[i?o("NcSelect",{staticClass:"photos-picker__navigation__month-select",attrs:{"aria-label-listbox":e.t("photos","Dates"),clearable:!1,"input-label":e.t("photos","Jump to specific date in list"),options:e.monthsList},scopedSlots:e._u([{key:"selected-option",fn:function({label:s}){return[e._v(" "+e._s(e.dateMonthAndYear(s))+" ")]}},{key:"option",fn:function({label:s}){return[e._v(" "+e._s(e.dateMonthAndYear(s))+" ")]}}],null,!0),model:{value:e.targetMonth,callback:function(s){e.targetMonth=s},expression:"targetMonth"}}):o("ul",{attrs:{"aria-label":e.t("photos","Dates")}},e._l(e.monthsList,function(s){return o("li",{key:s,staticClass:"photos-picker__navigation__month"},[o("NcButton",{attrs:{type:e.targetMonth===s?"secondary":"tertiary","aria-label":e.t("photos","Jump to {date}",{date:e.dateMonthAndYear(s)})},on:{click:function(a){e.targetMonth=s}}},[e._v(" "+e._s(e.dateMonthAndYear(s))+" ")])],1)}),0)]}}:null,{key:"actions",fn:function(){return[o("div",{staticClass:"photos-picker__actions"},[o("div",{staticClass:"photos-picker__actions__buttons"},[o("UploadPicker",{attrs:{accept:e.allowedMimes,context:e.uploadContext,destination:e.photosLocationFolder,multiple:""},on:{uploaded:e.refreshFiles}}),o("NcButton",{attrs:{type:"primary",disabled:e.loading||e.selectedFileIds.length===0},on:{click:e.emitPickedEvent},scopedSlots:e._u([{key:"icon",fn:function(){return[e.loading?e._e():o("ImagePlus"),e.loading?o("NcLoadingIcon"):e._e()]},proxy:!0}])},[e._v(" "+e._s(e.t("photos","Add to {destination}",{destination:e.destination}))+" ")])],1),e.photosLocationFolder.attributes["owner-id"]!==e.currentUser?o("NcNoteCard",{attrs:{type:"warning"}},[e._v(" "+e._s(e.t("photos","The destination folder is owned by {owner}",{owner:e.photosLocationFolder.attributes["owner-id"]}))+" ")]):e._e()],1)]},proxy:!0}],null,!0)},[o("FilesListViewer",{staticClass:"photos-picker__file-list",class:{"photos-picker__file-list--placeholder":e.monthsList.length===0},attrs:{"file-ids-by-section":e.fileIdsByMonth,"empty-message":e.t("photos","There are no photos or videos yet!"),sections:e.monthsList,loading:e.loadingFiles,"base-height":100,"section-header-height":50,"scroll-to-section":e.targetMonth},on:{"need-content":e.getFiles},nativeOn:{focusout:function(i){return e.onFocusOut.apply(null,arguments)}},scopedSlots:e._u([{key:"default",fn:function({file:i,height:s,isHeader:a,distance:n}){return[a?o("h3",{staticClass:"section-header",style:{height:`${s}px`},attrs:{id:`photos-picker-section-header-${i.id}`}},[e._v(" "+e._s(e.dateMonthAndYear(i.id))+" ")]):o("File",{attrs:{file:e.files[i.id],"allow-selection":!0,selected:e.selection[i.id]===!0,distance:n},on:{"select-toggled":e.onFileSelectToggle}})]}}])})],1)},ys=[],vs=u(fs,gs,ys,!1,null,"073d2240");const ta=vs.exports,bs={name:"ActionDownload",components:{NcActionLink:mt},props:{title:{type:String,required:!0},selectedFileIds:{type:Array,required:!0}},computed:{...E(["files"]),downloadUrl(){const e=new URLSearchParams,o=this.fileNames.map(i=>"/"+i.split("/").splice(3).join("/"));return e.append("files",JSON.stringify(o)),f(`/apps/files/ajax/download.php?${e}`)},fileNames(){return this.selectedFileIds.map(e=>this.files[e].filename)}}};var Fs=function(){var e=this,o=e._self._c;return o("NcActionLink",{attrs:{"close-after-click":!0,href:e.downloadUrl,download:e.downloadUrl,"aria-label":e.title}},[e._v(" "+e._s(e.title)+" "),e._t("icon",null,{slot:"icon"})],2)},ws=[],_s=u(bs,Fs,ws,!1,null,null);const Cs=_s.exports,Ss={name:"Timeline",components:{Delete:Bt,PlusBoxMultiple:Dt,Download:Ot,Close:$t,Plus:Ne,FolderAlertOutline:Et,NcEmptyContent:x,NcModal:gt,NcActions:ft,NcActionButton:we,NcButton:k,AlbumForm:Gt,AlbumPicker:Zt,FilesListViewer:te,File:q,ActionFavorite:ji,ActionDownload:Cs,HeaderNavigation:Si,PhotosSourceLocationsSettings:xe,AlertCircle:Q},filters:{dateMonth(e){return b(e,"YYYYMM").format("MMMM")},dateYear(e){return b(e,"YYYYMM").format("YYYY")}},mixins:[We,ee,Ye,Se],beforeRouteLeave(e,o,i){window.scrollTo(0,0),i()},props:{onlyFavorites:{type:Boolean,default:!1},mimesType:{type:Array,default:()=>H},onThisDay:{type:Boolean,default:!1},rootTitle:{type:String,required:!0}},data(){return{loadingCount:0,showAlbumCreationForm:!1,showAlbumPicker:!1,appContent:document.getElementById("app-content-vue")}},computed:{...E(["files"])},mounted(){Ce(K,this.handleUserConfigChange)},destroyed(){_e(K,this.handleUserConfigChange)},methods:{...M(["deleteFiles","addFilesToCollection"]),getContent(){this.fetchFiles({mimesType:this.mimesType,onThisDay:this.onThisDay,onlyFavorites:this.onlyFavorites})},openViewer(e){const o=this.files[e];OCA.Viewer.open({fileInfo:o,list:Object.values(this.fileIdsByMonth).flat().map(i=>this.files[i]),loadMore:o.loadMore?async()=>await o.loadMore(!0):()=>[],canLoop:o.canLoop})},openUploader(){},async addSelectionToAlbum(e){this.showAlbumPicker=!1,await this.addFilesToCollection({collectionFileName:e.filename,fileIdsToAdd:this.selectedFileIds})},async deleteSelection(){const e=this.selectedFileIds;this.onUncheckFiles(e),this.fetchedFileIds=this.fetchedFileIds.filter(o=>!e.includes(o)),await this.deleteFiles(e)},handleUserConfigChange({key:e}){e==="photosSourceFolders"&&this.resetFetchFilesState()},t:l}};var Ns=function(){var e=this,o=e._self._c;return e.errorFetchingFiles?o("div",{staticClass:"timeline__empty-content"},[e.errorFetchingFiles===404?o("NcEmptyContent",{attrs:{name:e.t("photos","One of the source folders does not exist")}},[o("FolderAlertOutline",{attrs:{slot:"icon"},slot:"icon"}),o("PhotosSourceLocationsSettings",{staticClass:"timeline__update_source_directory",attrs:{slot:"action"},slot:"action"})],1):o("NcEmptyContent",{attrs:{name:e.t("photos","An error occurred")}},[o("AlertCircle",{attrs:{slot:"icon"},slot:"icon"})],1)],1):o("div",{staticClass:"timeline"},[o("HeaderNavigation",{key:"navigation",attrs:{loading:e.loadingCount>0,path:"/",title:e.rootTitle,"root-title":e.rootTitle},on:{refresh:e.resetFetchFilesState}},[o("div",{staticClass:"timeline__header__left"},[e.selectedFileIds.length===0?o("NcButton",{ref:"newAlbumButton",attrs:{"aria-label":e.t("photos","Create new album")},on:{click:function(i){e.showAlbumCreationForm=!0}},scopedSlots:e._u([{key:"icon",fn:function(){return[o("PlusBoxMultiple")]},proxy:!0}],null,!1,2640725948)},[e._v(" "+e._s(e.t("photos","Create new album"))+" ")]):[o("NcButton",{attrs:{"close-after-click":!0,type:"primary","aria-label":e.t("photos","Add to album")},on:{click:function(i){e.showAlbumPicker=!0}},scopedSlots:e._u([{key:"icon",fn:function(){return[o("Plus")]},proxy:!0},e.isMobile?null:{key:"default",fn:function(){return[e._v(" "+e._s(e.t("photos","Add to album"))+" ")]},proxy:!0}],null,!0)}),e.selectedFileIds.length>0?o("NcButton",{attrs:{"aria-label":e.t("photos","Unselect all")},on:{click:e.resetSelection},scopedSlots:e._u([{key:"icon",fn:function(){return[o("Close")]},proxy:!0},e.isMobile?null:{key:"default",fn:function(){return[e._v(" "+e._s(e.t("photos","Unselect all"))+" ")]},proxy:!0}],null,!0)}):e._e(),o("NcActions",{attrs:{"aria-label":e.t("photos","Open actions menu")}},[o("ActionDownload",{attrs:{"selected-file-ids":e.selectedFileIds,title:e.t("photos","Download selected files")}},[o("Download",{attrs:{slot:"icon"},slot:"icon"})],1),o("ActionFavorite",{attrs:{"selected-file-ids":e.selectedFileIds}}),o("NcActionButton",{attrs:{"close-after-click":!0,"aria-label":e.t("photos","Delete selection")},on:{click:e.deleteSelection},scopedSlots:e._u([{key:"icon",fn:function(){return[o("Delete")]},proxy:!0}])},[e._v(" "+e._s(e.t("photos","Delete selection"))+" ")])],1)]],2)]),o("FilesListViewer",{ref:"filesListViewer",staticClass:"timeline__file-list",attrs:{"container-element":e.appContent,"file-ids-by-section":e.fileIdsByMonth,sections:e.monthsList,loading:e.loadingFiles,"base-height":e.isMobile?120:200,"empty-message":e.t("photos","No photos or videos in here")},on:{"need-content":e.getContent},scopedSlots:e._u([{key:"default",fn:function({file:i,isHeader:s,distance:a}){return[s?o("h2",{staticClass:"section-header",attrs:{id:`file-picker-section-header-${i.id}`}},[o("b",[e._v(e._s(e._f("dateMonth")(i.id)))]),e._v(" "+e._s(e._f("dateYear")(i.id))+" ")]):o("File",{attrs:{file:e.files[i.id],"allow-selection":!0,selected:e.selection[i.id]===!0,distance:a},on:{click:e.openViewer,"select-toggled":e.onFileSelectToggle}})]}}])}),e.showAlbumCreationForm?o("NcModal",{key:"albumCreationForm",attrs:{"set-return-focus":e.$refs.newAlbumButton?.$el},on:{close:function(i){e.showAlbumCreationForm=!1}}},[o("h2",{staticClass:"timeline__heading"},[e._v(" "+e._s(e.t("photos","New album"))+" ")]),o("AlbumForm",{on:{done:function(i){e.showAlbumCreationForm=!1}}})],1):e._e(),e.showAlbumPicker?o("NcModal",{key:"albumPicker",on:{close:function(i){e.showAlbumPicker=!1}}},[o("AlbumPicker",{on:{"album-picked":e.addSelectionToAlbum}})],1):e._e()],1)},ks=[],As=u(Ss,Ns,ks,!1,null,"943f8906");const Ls=As.exports,Ts=Object.freeze(Object.defineProperty({__proto__:null,default:Ls},Symbol.toStringTag,{value:"Module"})),Is={name:"LocationMap",components:{LControlAttribution:Ht,LTileLayer:jt,LMap:zt,LMarker:Vt,LTooltip:Rt},props:{latitude:{type:Number,required:!0},longitude:{type:Number,required:!0},name:{type:String,default:""}},data(){return{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",previewZoom:13,attribution:'&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'}},computed:{center(){return[this.latitude,this.longitude]}}};var Ps=function(){var e=this,o=e._self._c;return o("LMap",{staticClass:"location-map",attrs:{zoom:e.previewZoom,center:e.center,options:{scrollWheelZoom:!1,zoomControl:!1,dragging:!1,attributionControl:!1}},on:{scroll:function(i){i.preventDefault()}}},[o("LTileLayer",{attrs:{url:e.url}}),o("LControlAttribution",{attrs:{position:"bottomright",prefix:e.attribution}}),o("LMarker",{attrs:{"lat-lng":e.center}},[o("LTooltip",{attrs:{options:{direction:"top",permanent:"true",offset:[-16,-14]}}},[e._v(" "+e._s(e.name)+" ")])],1)],1)},xs=[],Ms=u(Is,Ps,xs,!1,null,"9bc77302");const oa=Ms.exports;export{ji as A,Gs as C,Qs as F,Ks as G,Si as H,oa as L,ta as P,A as S,y as _,H as a,Xs as b,Zs as c,We as d,Ws as e,ea as f,U as g,m as h,X as i,Yo as j,ee as k,p as l,q as m,u as n,te as o,Ni as p,Js as q,je as r,Ys as s,Us as t,Hs as u,qs as v};
//# sourceMappingURL=photos-main.mjs.map
