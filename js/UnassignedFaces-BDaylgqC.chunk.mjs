import{x as n,m as l,k as r,p as c,S as d,n as f}from"./icons-CCMXs15V.chunk.mjs";import{q as h,f as u,l as s,z as i}from"./index-CtBKWcPT.chunk.mjs";import{N as p}from"./NcActionButton-Gpv56vuS-DwokBgrB.chunk.mjs";import{N as m}from"./NcDialog-D2lwwZL--BBju5KIU.chunk.mjs";import{N as F}from"./NcEmptyContent-BKTjF0KK.chunk.mjs";import{t as v,V as g}from"./vue.runtime.esm-DZVHDHac.chunk.mjs";import{F as _}from"./FetchFilesMixin-BFmwx91D.chunk.mjs";import{F as w,a as C}from"./FilesListViewer-CSyzVtfF.chunk.mjs";import{F as y}from"./File-CG4Zx0yL.chunk.mjs";import{F as S}from"./FaceCover-gIzZqF3_.chunk.mjs";import{F as k}from"./FaceMergeForm-JO1RyTQS.chunk.mjs";import"./index-SCFTKIaY.chunk.mjs";import"./index-BKOSQir6.chunk.mjs";import"./preload-helper-Dh9HmuEY.chunk.mjs";import"./PhotoSearch-BwtcAlrw.chunk.mjs";import"./AbortControllerMixin-BHckU111.chunk.mjs";import"./fileFetcher-C2yJxIXc.chunk.mjs";import"./NcCheckboxRadioSwitch-Di9rSADK-D02oVeZo.chunk.mjs";import"./useModelMigration-EhAWvqDD-C-Iitg9F.chunk.mjs";const M={name:"UnassignedFaces",components:{Star:d,Download:c,AlertCircle:r,ArrowLeft:l,FaceMergeForm:k,FilesListViewer:C,File:y,NcLoadingIcon:u,NcEmptyContent:F,NcActions:h,NcActionButton:p,NcDialog:m,AccountSwitch:n},directives:{focus(t){g.nextTick(()=>t.focus())}},mixins:[S,_,w],data(){return{showMoveModal:!1,loadingCount:0,appContent:document.getElementById("app-content-vue")}},computed:{files(){return this.$store.state.files.files},unassignedFiles(){return this.$store.state.faces.unassignedFiles},faceFileIds(){return this.unassignedFiles||[]},shouldFavoriteSelection(){return this.selectedFileIds.some(t=>this.$store.state.files.files[t].attributes.favorite===0)}},mounted(){this.fetchUnassignedFaces()},methods:{openViewer(t){window.OCA.Viewer.open({fileInfo:i(this.files[t]),list:this.faceFileIds.map(e=>i(this.files[e]))})},async handleMove(t,e){try{this.loadingCount++,await this.$store.dispatch("moveFilesToFace",{oldFace:null,faceName:t,fileIdsToMove:e}),this.showMoveModal=!1}catch(o){s.error("Failed to move selection",{error:o})}finally{this.loadingCount--}},async favoriteSelection(){try{this.loadingCount++,await this.$store.dispatch("toggleFavoriteForFiles",{fileIds:this.selectedFileIds,favoriteState:!0})}catch(t){s.error("Failed to favorite selection",{error:t})}finally{this.loadingCount--}},async unFavoriteSelection(){try{this.loadingCount++,await this.$store.dispatch("toggleFavoriteForFiles",{fileIds:this.selectedFileIds,favoriteState:!1})}catch(t){s.error("Failed to unfavorite selection",{error:t})}finally{this.loadingCount--}},async downloadSelection(){try{this.loadingCount++,await this.$store.dispatch("downloadFiles",this.selectedFileIds)}catch(t){s.error("Faile to download selection",{error:t})}finally{this.loadingCount--}},t:v}};var N=function(){var t=this,e=t._self._c;return t.errorFetchingFiles?e("NcEmptyContent",{scopedSlots:t._u([{key:"icon",fn:function(){return[e("AlertCircle")]},proxy:!0}],null,!1,794036927)},[t._v(" "+t._s(t.t("photos","An error occurred"))+" ")]):e("div",{staticClass:"face"},[e("div",{staticClass:"face__header"},[e("div",{staticClass:"face__header__left"},[e("NcActions",[e("NcActionButton",{on:{click:function(o){return t.$router.push("/faces/")}},scopedSlots:t._u([{key:"icon",fn:function(){return[e("ArrowLeft")]},proxy:!0}])},[t._v(t._s(t.t("photos","Back"))+" ")])],1),e("div",{staticClass:"face__header__title"},[e("h2",{class:{"face-name":!0}},[t._v(" "+t._s(t.t("photos","Unassigned faces"))+" ")])]),t.loadingCount>0||t.loadingFaces?e("NcLoadingIcon"):t._e()],1),e("div",{staticClass:"face__header__actions"},[e("NcActions",{attrs:{"force-menu":!0}},[t.selectedFileIds.length?[e("NcActionButton",{attrs:{"close-after-click":!0,"aria-label":t.t("photos","Download selected files")},on:{click:t.downloadSelection}},[e("Download",{attrs:{slot:"icon"},slot:"icon"}),t._v(" "+t._s(t.t("photos","Download selected photos"))+" ")],1),t.shouldFavoriteSelection?e("NcActionButton",{attrs:{"close-after-click":!0,"aria-label":t.t("photos","Mark selection as favorite")},on:{click:t.favoriteSelection}},[e("Star",{attrs:{slot:"icon"},slot:"icon"}),t._v(" "+t._s(t.t("photos","Favorite"))+" ")],1):e("NcActionButton",{attrs:{"close-after-click":!0,"aria-label":t.t("photos","Remove selection from favorites")},on:{click:t.unFavoriteSelection}},[e("Star",{attrs:{slot:"icon"},slot:"icon"}),t._v(" "+t._s(t.t("photos","Remove from favorites"))+" ")],1),e("NcActionButton",{attrs:{"close-after-click":!0},on:{click:function(o){t.showMoveModal=!0}},scopedSlots:t._u([{key:"icon",fn:function(){return[e("AccountSwitch")]},proxy:!0}],null,!1,2937983280)},[t._v(" "+t._s(t.n("photos","Move photo to a different person","Move photos to a different person",t.selectedFileIds.length))+" ")])]:t._e()],2)],1)]),e("FilesListViewer",{staticClass:"face__photos",attrs:{"container-element":t.appContent,"file-ids":t.faceFileIds,loading:t.loadingFiles||t.loadingFaces},scopedSlots:t._u([{key:"default",fn:function({file:o,distance:a}){return e("File",{attrs:{file:t.files[o.id],"allow-selection":!0,selected:t.selection[o.id]===!0,distance:a},on:{click:t.openViewer,"select-toggled":t.onFileSelectToggle}})}}])}),t.showMoveModal?e("NcDialog",{attrs:{name:t.t("photos","Move to different person"),"close-on-click-outside":"",size:"normal"},on:{closing:function(o){t.showMoveModal=!1}}},[e("FaceMergeForm",{attrs:{"first-face":"-1"},on:{select:function(o){return t.handleMove(o,t.selectedFileIds)}}})],1):t._e()],1)},A=[],I=f(M,N,A,!1,null,"59b22aca");const P=I.exports;export{P as default};
//# sourceMappingURL=UnassignedFaces-BDaylgqC.chunk.mjs.map
