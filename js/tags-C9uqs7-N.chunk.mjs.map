{"version":3,"file":"tags-C9uqs7-N.chunk.mjs","sources":["../node_modules/striptags/src/striptags.js","../node_modules/@nextcloud/vue/dist/chunks/NcSelectTags-DHMtiklq.mjs","../src/services/AreTagsInstalled.ts","../node_modules/core-js/internals/to-string-tag-support.js","../src/services/TaggedImages.ts","../src/services/SystemTags.ts","../src/store/systemtags.ts","../src/components/TagCover.vue","../src/views/Tags.vue","../src/views/TagContent.vue"],"sourcesContent":["'use strict';\n\n(function (global) {\n\n    // minimal symbol polyfill for IE11 and others\n    if (typeof Symbol !== 'function') {\n        var Symbol = function(name) {\n            return name;\n        }\n\n        Symbol.nonNative = true;\n    }\n\n    const STATE_PLAINTEXT = Symbol('plaintext');\n    const STATE_HTML      = Symbol('html');\n    const STATE_COMMENT   = Symbol('comment');\n\n    const ALLOWED_TAGS_REGEX  = /<(\\w*)>/g;\n    const NORMALIZE_TAG_REGEX = /<\\/?([^\\s\\/>]+)/;\n\n    function striptags(html, allowable_tags, tag_replacement) {\n        html            = html || '';\n        allowable_tags  = allowable_tags || [];\n        tag_replacement = tag_replacement || '';\n\n        let context = init_context(allowable_tags, tag_replacement);\n\n        return striptags_internal(html, context);\n    }\n\n    function init_striptags_stream(allowable_tags, tag_replacement) {\n        allowable_tags  = allowable_tags || [];\n        tag_replacement = tag_replacement || '';\n\n        let context = init_context(allowable_tags, tag_replacement);\n\n        return function striptags_stream(html) {\n            return striptags_internal(html || '', context);\n        };\n    }\n\n    striptags.init_streaming_mode = init_striptags_stream;\n\n    function init_context(allowable_tags, tag_replacement) {\n        allowable_tags = parse_allowable_tags(allowable_tags);\n\n        return {\n            allowable_tags : allowable_tags,\n            tag_replacement: tag_replacement,\n\n            state         : STATE_PLAINTEXT,\n            tag_buffer    : '',\n            depth         : 0,\n            in_quote_char : ''\n        };\n    }\n\n    function striptags_internal(html, context) {\n        if (typeof html != \"string\") {\n            throw new TypeError(\"'html' parameter must be a string\");\n        }\n\n        let allowable_tags  = context.allowable_tags;\n        let tag_replacement = context.tag_replacement;\n\n        let state         = context.state;\n        let tag_buffer    = context.tag_buffer;\n        let depth         = context.depth;\n        let in_quote_char = context.in_quote_char;\n        let output        = '';\n\n        for (let idx = 0, length = html.length; idx < length; idx++) {\n            let char = html[idx];\n\n            if (state === STATE_PLAINTEXT) {\n                switch (char) {\n                    case '<':\n                        state       = STATE_HTML;\n                        tag_buffer += char;\n                        break;\n\n                    default:\n                        output += char;\n                        break;\n                }\n            }\n\n            else if (state === STATE_HTML) {\n                switch (char) {\n                    case '<':\n                        // ignore '<' if inside a quote\n                        if (in_quote_char) {\n                            break;\n                        }\n\n                        // we're seeing a nested '<'\n                        depth++;\n                        break;\n\n                    case '>':\n                        // ignore '>' if inside a quote\n                        if (in_quote_char) {\n                            break;\n                        }\n\n                        // something like this is happening: '<<>>'\n                        if (depth) {\n                            depth--;\n\n                            break;\n                        }\n\n                        // this is closing the tag in tag_buffer\n                        in_quote_char = '';\n                        state         = STATE_PLAINTEXT;\n                        tag_buffer   += '>';\n\n                        if (allowable_tags.has(normalize_tag(tag_buffer))) {\n                            output += tag_buffer;\n                        } else {\n                            output += tag_replacement;\n                        }\n\n                        tag_buffer = '';\n                        break;\n\n                    case '\"':\n                    case '\\'':\n                        // catch both single and double quotes\n\n                        if (char === in_quote_char) {\n                            in_quote_char = '';\n                        } else {\n                            in_quote_char = in_quote_char || char;\n                        }\n\n                        tag_buffer += char;\n                        break;\n\n                    case '-':\n                        if (tag_buffer === '<!-') {\n                            state = STATE_COMMENT;\n                        }\n\n                        tag_buffer += char;\n                        break;\n\n                    case ' ':\n                    case '\\n':\n                        if (tag_buffer === '<') {\n                            state      = STATE_PLAINTEXT;\n                            output    += '< ';\n                            tag_buffer = '';\n\n                            break;\n                        }\n\n                        tag_buffer += char;\n                        break;\n\n                    default:\n                        tag_buffer += char;\n                        break;\n                }\n            }\n\n            else if (state === STATE_COMMENT) {\n                switch (char) {\n                    case '>':\n                        if (tag_buffer.slice(-2) == '--') {\n                            // close the comment\n                            state = STATE_PLAINTEXT;\n                        }\n\n                        tag_buffer = '';\n                        break;\n\n                    default:\n                        tag_buffer += char;\n                        break;\n                }\n            }\n        }\n\n        // save the context for future iterations\n        context.state         = state;\n        context.tag_buffer    = tag_buffer;\n        context.depth         = depth;\n        context.in_quote_char = in_quote_char;\n\n        return output;\n    }\n\n    function parse_allowable_tags(allowable_tags) {\n        let tag_set = new Set();\n\n        if (typeof allowable_tags === 'string') {\n            let match;\n\n            while ((match = ALLOWED_TAGS_REGEX.exec(allowable_tags))) {\n                tag_set.add(match[1]);\n            }\n        }\n\n        else if (!Symbol.nonNative &&\n                 typeof allowable_tags[Symbol.iterator] === 'function') {\n\n            tag_set = new Set(allowable_tags);\n        }\n\n        else if (typeof allowable_tags.forEach === 'function') {\n            // IE11 compatible\n            allowable_tags.forEach(tag_set.add, tag_set);\n        }\n\n        return tag_set;\n    }\n\n    function normalize_tag(tag_buffer) {\n        let match = NORMALIZE_TAG_REGEX.exec(tag_buffer);\n\n        return match ? match[1].toLowerCase() : null;\n    }\n\n    if (typeof define === 'function' && define.amd) {\n        // AMD\n        define(function module_factory() { return striptags; });\n    }\n\n    else if (typeof module === 'object' && module.exports) {\n        // Node\n        module.exports = striptags;\n    }\n\n    else {\n        // Browser\n        global.striptags = striptags;\n    }\n}(this));\n","import NcEllipsisedOption from \"../Components/NcEllipsisedOption.mjs\";\nimport { N as NcSelect } from \"./NcSelect-DYSqnJAW.mjs\";\nimport axios from \"@nextcloud/axios\";\nimport { generateRemoteUrl } from \"@nextcloud/router\";\nimport { r as register, j as t0, a as t } from \"./_l10n-Dt0m9Fxw.mjs\";\nimport { u as useModelMigration } from \"./useModelMigration-EhAWvqDD.mjs\";\nimport { n as normalizeComponent } from \"./_plugin-vue2_normalizer-DU4iP6Vu.mjs\";\nconst xmlToJson = (xml) => {\n  let obj = {};\n  if (xml.nodeType === 1) {\n    if (xml.attributes.length > 0) {\n      obj[\"@attributes\"] = {};\n      for (let j = 0; j < xml.attributes.length; j++) {\n        const attribute = xml.attributes.item(j);\n        obj[\"@attributes\"][attribute.nodeName] = attribute.nodeValue;\n      }\n    }\n  } else if (xml.nodeType === 3) {\n    obj = xml.nodeValue;\n  }\n  if (xml.hasChildNodes()) {\n    for (let i = 0; i < xml.childNodes.length; i++) {\n      const item = xml.childNodes.item(i);\n      const nodeName = item.nodeName;\n      if (typeof obj[nodeName] === \"undefined\") {\n        obj[nodeName] = xmlToJson(item);\n      } else {\n        if (typeof obj[nodeName].push === \"undefined\") {\n          const old = obj[nodeName];\n          obj[nodeName] = [];\n          obj[nodeName].push(old);\n        }\n        obj[nodeName].push(xmlToJson(item));\n      }\n    }\n  }\n  return obj;\n};\nconst parseXml = (xml) => {\n  let dom = null;\n  try {\n    dom = new DOMParser().parseFromString(xml, \"text/xml\");\n  } catch (e) {\n    console.error(\"Failed to parse xml document\", e);\n  }\n  return dom;\n};\nconst xmlToTagList = (xml) => {\n  const json = xmlToJson(parseXml(xml));\n  const list = json[\"d:multistatus\"][\"d:response\"];\n  const result = [];\n  for (const index in list) {\n    const tag = list[index][\"d:propstat\"];\n    if (tag[\"d:status\"][\"#text\"] !== \"HTTP/1.1 200 OK\") {\n      continue;\n    }\n    result.push({\n      id: parseInt(tag[\"d:prop\"][\"oc:id\"][\"#text\"]),\n      displayName: tag[\"d:prop\"][\"oc:display-name\"][\"#text\"],\n      canAssign: tag[\"d:prop\"][\"oc:can-assign\"][\"#text\"] === \"true\",\n      userAssignable: tag[\"d:prop\"][\"oc:user-assignable\"][\"#text\"] === \"true\",\n      userVisible: tag[\"d:prop\"][\"oc:user-visible\"][\"#text\"] === \"true\"\n    });\n  }\n  return result;\n};\nconst searchTags = async function() {\n  if (window.NextcloudVueDocs) {\n    return Promise.resolve(xmlToTagList(window.NextcloudVueDocs.tags));\n  }\n  const result = await axios({\n    method: \"PROPFIND\",\n    url: generateRemoteUrl(\"dav\") + \"/systemtags/\",\n    data: `<?xml version=\"1.0\"?>\n\t\t\t\t\t<d:propfind  xmlns:d=\"DAV:\" xmlns:oc=\"http://owncloud.org/ns\">\n\t\t\t\t\t  <d:prop>\n\t\t\t\t\t\t<oc:id />\n\t\t\t\t\t\t<oc:display-name />\n\t\t\t\t\t\t<oc:user-visible />\n\t\t\t\t\t\t<oc:user-assignable />\n\t\t\t\t\t\t<oc:can-assign />\n\t\t\t\t\t  </d:prop>\n\t\t\t\t\t</d:propfind>`\n  });\n  return xmlToTagList(result.data);\n};\nregister(t0);\nconst _sfc_main = {\n  name: \"NcSelectTags\",\n  components: {\n    NcEllipsisedOption,\n    NcSelect\n  },\n  model: {\n    prop: \"modelValue\",\n    event: \"update:modelValue\"\n  },\n  props: {\n    // Add NcSelect prop defaults and populate $props\n    ...NcSelect.props,\n    /**\n     * Enable automatic fetching of tags\n     *\n     * If `false`, available tags must be passed using the `options` prop\n     */\n    fetchTags: {\n      type: Boolean,\n      default: true\n    },\n    /**\n     * Callback to generate the label text\n     *\n     * @see https://vue-select.org/api/props.html#getoptionlabel\n     */\n    getOptionLabel: {\n      type: Function,\n      default: (option) => {\n        const { displayName, userVisible, userAssignable } = option;\n        if (userVisible === false) {\n          return t(\"{tag} (invisible)\", { tag: displayName });\n        }\n        if (userAssignable === false) {\n          return t(\"{tag} (restricted)\", { tag: displayName });\n        }\n        return displayName;\n      }\n    },\n    /**\n     * Sets the maximum number of tags to display in the dropdown list\n     *\n     * Because of compatibility reasons only 5 tag entries are shown by\n     * default\n     */\n    limit: {\n      type: Number,\n      default: 5\n    },\n    /**\n     * Allow selection of multiple options\n     *\n     * This prop automatically sets the internal `closeOnSelect` prop to\n     * its boolean opposite\n     *\n     * @see https://vue-select.org/api/props.html#multiple\n     */\n    multiple: {\n      type: Boolean,\n      default: true\n    },\n    /**\n     * Callback to filter available options\n     */\n    optionsFilter: {\n      type: Function,\n      default: null\n    },\n    /**\n     * Enable passing of `value` prop and emitted `input` events as-is\n     * i.e. for usage with `v-model`\n     *\n     * If `true`, custom internal `value` and `input` handling is disabled\n     */\n    passthru: {\n      type: Boolean,\n      default: false\n    },\n    /**\n     * Placeholder text\n     *\n     * @see https://vue-select.org/api/props.html#placeholder\n     */\n    placeholder: {\n      type: String,\n      default: t(\"Select a tag\")\n    },\n    /**\n     * Removed in v9 - use `modelValue` (`v-model`) instead\n     * @deprecated\n     */\n    value: {\n      type: [Number, Array, Object],\n      default: void 0\n    },\n    /**\n     * Currently selected value\n     */\n    modelValue: {\n      type: [Number, Array, Object],\n      default: null\n    },\n    /**\n     * Any available prop\n     *\n     * @see https://vue-select.org/api/props.html\n     */\n    // Not an actual prop but needed to show in vue-styleguidist docs\n    // eslint-disable-next-line\n    \" \": {}\n  },\n  emits: [\n    /**\n     * Removed in v9 - use `update:modelValue` (`v-model`) instead\n     */\n    \"input\",\n    /**\n     * Emitted on input events of the multiselect field\n     *\n     * @type {number|number[]}\n     */\n    \"update:modelValue\",\n    /** Same as update:modelValue for Vue 2 compatibility */\n    \"update:model-value\",\n    /**\n     * All events from https://vue-select.org/api/events.html\n     */\n    // Not an actual event but needed to show in vue-styleguidist docs\n    \" \"\n  ],\n  setup() {\n    const model = useModelMigration(\"value\", \"input\");\n    const noop = () => {\n    };\n    return {\n      model,\n      noop\n    };\n  },\n  data() {\n    return {\n      search: \"\",\n      availableTags: []\n    };\n  },\n  computed: {\n    availableOptions() {\n      if (this.optionsFilter) {\n        return this.tags.filter(this.optionsFilter);\n      }\n      return this.tags;\n    },\n    localValue() {\n      if (this.tags.length === 0) {\n        return [];\n      }\n      if (this.multiple) {\n        return this.model.filter((tag) => tag !== \"\").map((id) => this.tags.find((tag2) => tag2.id === id));\n      } else {\n        return this.tags.find((tag) => tag.id === this.model);\n      }\n    },\n    propsToForward() {\n      const {\n        // Props handled by this component\n        fetchTags,\n        optionsFilter,\n        passthru,\n        // Props to forward\n        ...propsToForward\n      } = this.$props;\n      return propsToForward;\n    },\n    tags() {\n      if (!this.fetchTags) {\n        return this.options;\n      }\n      return this.availableTags;\n    }\n  },\n  async created() {\n    if (!this.fetchTags) {\n      return;\n    }\n    try {\n      const result = await searchTags();\n      this.availableTags = result;\n    } catch (error) {\n      console.error(\"Loading systemtags failed\", error);\n    }\n  },\n  methods: {\n    handleInput(value) {\n      if (this.multiple) {\n        this.model = value.map((element) => element.id);\n      } else {\n        if (value === null) {\n          this.model = null;\n        } else {\n          this.model = value.id;\n        }\n      }\n    }\n  }\n};\nvar _sfc_render = function render() {\n  var _vm = this, _c = _vm._self._c;\n  return _c(\"NcSelect\", _vm._g(_vm._b({ attrs: { \"options\": _vm.availableOptions, \"close-on-select\": !_vm.multiple, \"value\": _vm.passthru ? _vm.model : _vm.localValue }, on: { \"search\": (searchString) => _vm.search = searchString }, scopedSlots: _vm._u([{ key: \"option\", fn: function(option) {\n    return [_c(\"NcEllipsisedOption\", { attrs: { \"name\": _vm.getOptionLabel(option), \"search\": _vm.search } })];\n  } }, { key: \"selected-option\", fn: function(selectedOption) {\n    return [_c(\"NcEllipsisedOption\", { attrs: { \"name\": _vm.getOptionLabel(selectedOption), \"search\": _vm.search } })];\n  } }, _vm._l(_vm.$scopedSlots, function(_, name) {\n    return { key: name, fn: function(data) {\n      return [_vm._t(name, null, null, data)];\n    } };\n  })], null, true) }, \"NcSelect\", _vm.propsToForward, false), {\n    ..._vm.$listeners,\n    input: _vm.passthru ? _vm.$listeners.input : _vm.noop,\n    \"update:modelValue\": _vm.passthru ? _vm.$listeners[\"update:modelValue\"] : _vm.handleInput,\n    \"update:model-value\": _vm.passthru ? _vm.$listeners[\"update:model-value\"] : _vm.noop\n  }));\n};\nvar _sfc_staticRenderFns = [];\nvar __component__ = /* @__PURE__ */ normalizeComponent(\n  _sfc_main,\n  _sfc_render,\n  _sfc_staticRenderFns,\n  false,\n  null,\n  null\n);\nconst NcSelectTags = __component__.exports;\nexport {\n  NcSelectTags as N\n};\n//# sourceMappingURL=NcSelectTags-DHMtiklq.mjs.map\n","/**\n * SPDX-FileCopyrightText: 2020 Nextcloud GmbH and Nextcloud contributors\n * SPDX-License-Identifier: AGPL-3.0-or-later\n */\n\nimport { loadState } from '@nextcloud/initial-state'\n\nconst systemtags = loadState('photos', 'systemtags', false) as boolean\nexport default systemtags\n","'use strict';\nvar wellKnownSymbol = require('../internals/well-known-symbol');\n\nvar TO_STRING_TAG = wellKnownSymbol('toStringTag');\nvar test = {};\n\ntest[TO_STRING_TAG] = 'z';\n\nmodule.exports = String(test) === '[object z]';\n","/**\n * SPDX-FileCopyrightText: 2019 Nextcloud GmbH and Nextcloud contributors\n * SPDX-License-Identifier: AGPL-3.0-or-later\n */\n\nimport { defaultRootPath } from '@nextcloud/files/dav'\nimport { genFileInfo, type PhotoNode } from '../utils/fileUtils.js'\nimport allowedMimes from './AllowedMimes.js'\nimport { davClient } from './DavClient.ts'\nimport { getDefaultDavProps } from './DavRequest.ts'\nimport type { FileStat, GetDirectoryContentsOptions, ResponseDataDetailed } from 'webdav'\n\n/**\n * Get tagged files based on provided tag id\n */\nexport default async function(id: number, options: GetDirectoryContentsOptions = {}): Promise<PhotoNode[]> {\n\toptions = Object.assign({\n\t\theaders: {\n\t\t\tmethod: 'REPORT',\n\t\t},\n\t\tdata: `<?xml version=\"1.0\"?>\n\t\t\t<oc:filter-files\n\t\t\t\txmlns:d=\"DAV:\"\n\t\t\t\txmlns:oc=\"http://owncloud.org/ns\"\n\t\t\t\txmlns:nc=\"http://nextcloud.org/ns\"\n\t\t\t\txmlns:ocs=\"http://open-collaboration-services.org/ns\">\n\t\t\t\t<d:prop>\n\t\t\t\t\t${getDefaultDavProps()}\n\t\t\t\t</d:prop>\n\t\t\t\t<oc:filter-rules>\n\t\t\t\t\t<oc:systemtag>${id}</oc:systemtag>\n\t\t\t\t</oc:filter-rules>\n\t\t\t</oc:filter-files>`,\n\t\tdetails: true,\n\t}, options)\n\n\tconst response = await davClient.getDirectoryContents(defaultRootPath, options) as ResponseDataDetailed<FileStat[]>\n\treturn response.data\n\t\t.map((data) => genFileInfo(data))\n\t\t// filter out unwanted mime because server REPORT service only support\n\t\t// hardcoded props and mime is not one of them\n\t\t// https://github.com/nextcloud/server/blob/5bf3d1bb384da56adbf205752be8f840aac3b0c5/apps/dav/lib/Connector/Sabre/FilesReportPlugin.php#L274\n\t\t.filter((file) => file.mime && allowedMimes.indexOf(file.mime) !== -1)\n\t\t// remove prefix path from full file path\n\t\t.map((data) => Object.assign({}, data, { filename: data.filename.replace(defaultRootPath, '') }))\n}\n","/**\n * SPDX-FileCopyrightText: 2019 Nextcloud GmbH and Nextcloud contributors\n * SPDX-License-Identifier: AGPL-3.0-or-later\n */\n\nimport type { FileStat, GetDirectoryContentsOptions, ResponseDataDetailed } from 'webdav'\nimport { genFileInfo, type PhotoNode } from '../utils/fileUtils.js'\nimport { davClient } from './DavClient.ts'\n\n/**\n * List system tags\n */\nexport default async function(path: string, options: GetDirectoryContentsOptions = {}): Promise<PhotoNode[]> {\n\tconst response = await davClient.getDirectoryContents('/systemtags-assigned/image', Object.assign({}, {\n\t\tdata: `<?xml version=\"1.0\"?>\n\t\t\t<d:propfind  xmlns:d=\"DAV:\"\n\t\t\t\txmlns:oc=\"http://owncloud.org/ns\" xmlns:nc=\"http://nextcloud.org/ns\">\n\t\t\t\t<d:prop>\n\t\t\t\t\t<oc:id />\n\t\t\t\t\t<oc:display-name />\n\t\t\t\t\t<oc:user-visible />\n\t\t\t\t\t<oc:user-assignable />\n\t\t\t\t\t<oc:can-assign />\n\t\t\t\t\t<nc:files-assigned/>\n\t\t\t\t\t<nc:reference-fileid/>\n\t\t\t\t</d:prop>\n\t\t\t</d:propfind>`,\n\t\tdetails: true,\n\t}, options)) as ResponseDataDetailed<FileStat[]>\n\n\treturn response.data.map(data => genFileInfo(data))\n}\n","/**\n * SPDX-FileCopyrightText: 2019 Nextcloud GmbH and Nextcloud contributors\n * SPDX-License-Identifier: AGPL-3.0-or-later\n */\nimport Vue from 'vue'\nimport { sortCompare, type PhotoNode } from '../utils/fileUtils.js'\nimport getTaggedImages from '../services/TaggedImages.js'\nimport getSystemTags from '../services/SystemTags.js'\nimport logger from '../services/logger.js'\n\nconst state = {\n\ttags: {},\n\tnames: {},\n}\n\ntype SystemTagsState = typeof state\n\nconst mutations = {\n\t/**\n\t * Order and save tags\n\t */\n\tupdateTags(state: SystemTagsState, tags: string[]) {\n\t\tif (tags.length > 0) {\n\t\t\t// sort by basename\n\t\t\tconst list = tags.sort((a, b) => sortCompare(a, b, 'displayName'))\n\n\t\t\t// store tag and its index\n\t\t\tlist.forEach(tag => {\n\t\t\t\tVue.set(state.tags, tag.id, tag)\n\t\t\t\tVue.set(state.names, tag.displayName, tag.id)\n\t\t\t})\n\t\t}\n\t},\n\n\t/**\n\t * Update tag files list\n\t */\n\tremoveTag(state: SystemTagsState, { id }: { id: number }) {\n\t\tVue.delete(state.names, state.tags[id].displayName)\n\t\tVue.delete(state.tags, id)\n\t},\n\n\t/**\n\t * Update tag files list\n\t */\n\tupdateTag(state: SystemTagsState, { id, files }: { id: number; files: PhotoNode[] }) {\n\t\tif (files.length === 0) {\n\t\t\t// Remove this tag from the list if there's no files for it\n\t\t\tVue.delete(state.names, state.tags[id].displayName)\n\t\t\tVue.delete(state.tags, id)\n\t\t\treturn\n\t\t}\n\n\t\t// sort by last modified\n\t\tconst list = files.sort((a, b) => sortCompare(a, b, 'filesAssigned'))\n\n\t\t// overwrite list\n\t\tlogger.debug(`Overwrite list, id: ${id}`, { list })\n\t\tVue.set(state.tags[id], 'files', list.map(file => file.fileid))\n\t},\n}\n\nconst getters = {\n\ttags: (state: SystemTagsState) => state.tags,\n\ttagsNames: (state: SystemTagsState) => state.names,\n\ttag: (state: SystemTagsState) => id => state.tags[id],\n\ttagId: (state: SystemTagsState) => name => state.names[name],\n}\n\nconst actions = {\n\t/**\n\t * Update files and folders\n\t */\n\tupdateTags(context, tags: string[]) {\n\t\tcontext.commit('updateTags', tags)\n\t},\n\n\t/**\n\t * Update tag files list\n\t */\n\tupdateTag(context, { id, files }: { id: number, files: PhotoNode[] }) {\n\t\tif (files.length === 0) {\n\t\t\t// Remove this tag from the list if there's no files for it\n\t\t\tcontext.commit('removeTag', { id })\n\t\t}\n\t\tcontext.commit('updateTag', { id, files })\n\t},\n\n\tasync fetchTagFiles(context, { id, signal }: { id: number; signal: AbortSignal }) {\n\t\ttry {\n\t\t\t// get data\n\t\t\tconst files = await getTaggedImages(id, { signal })\n\t\t\tawait context.dispatch('updateTag', { id, files })\n\t\t\tawait context.dispatch('appendFiles', files)\n\t\t} catch (error) {\n\t\t\tif (error.response && error.response.status) {\n\t\t\t\tlogger.error(`Failed to get tag content, id: ${id}`, { error })\n\t\t\t} else {\n\t\t\t\tlogger.error(error)\n\t\t\t}\n\t\t}\n\t},\n\n\tasync fetchAllTags(context, { signal }: { signal: AbortSignal }) {\n\t\tconst tags = await getSystemTags('', {\n\t\t\tsignal,\n\t\t})\n\t\tawait context.dispatch('updateTags', tags)\n\t},\n}\n\nexport default { state, mutations, getters, actions }\n","<!--\n - SPDX-FileCopyrightText: 2019 Nextcloud GmbH and Nextcloud contributors\n - SPDX-License-Identifier: AGPL-3.0-or-later\n-->\n\n<template>\n\t<router-link class=\"tag-cover\" :to=\"`/tags/${tag.displayName}`\">\n\t\t<img v-if=\"tag.filesAssigned !== 0\"\n\t\t\tclass=\"tag-cover__image\"\n\t\t\t:src=\"coverUrl\">\n\t\t<div v-else class=\"tag-cover__image tag-cover__image--placeholder\">\n\t\t\t<ImageMultipleIcon :size=\"128\" />\n\t\t</div>\n\t\t<div class=\"tag-cover__details\">\n\t\t\t<div class=\"tag-cover__details__first-line\">\n\t\t\t\t<h3 class=\"tag-cover__details__name\">\n\t\t\t\t\t{{ t('recognize', tag.displayName) }}\n\t\t\t\t</h3>\n\t\t\t</div>\n\t\t\t<div class=\"tag-cover__details__second-line\">\n\t\t\t\t{{ n('photos', '%n photo', '%n photos', count) }}\n\t\t\t</div>\n\t\t</div>\n\t</router-link>\n</template>\n\n<script lang='ts'>\nimport { mapGetters } from 'vuex'\nimport ImageMultipleIcon from 'vue-material-design-icons/ImageMultiple.vue'\n\nimport { generateUrl } from '@nextcloud/router'\n\nimport AbortControllerMixin from '../mixins/AbortControllerMixin.js'\n\nexport default {\n\tname: 'TagCover',\n\n\tcomponents: {\n\t\tImageMultipleIcon,\n\t},\n\n\tmixins: [\n\t\tAbortControllerMixin,\n\t],\n\n\tprops: {\n\t\ttag: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\n\tdata() {\n\t\treturn {\n\t\t\tloadCover: false,\n\t\t\tobserver: null,\n\t\t}\n\t},\n\n\tcomputed: {\n\t\t// global lists\n\t\t...mapGetters([\n\t\t\t'files',\n\t\t\t'tags',\n\t\t]),\n\n\t\t/**\n\t\t * @return {string}\n\t\t */\n\t\tcoverUrl() {\n\t\t\tif (!this.loadCover) {\n\t\t\t\treturn ''\n\t\t\t}\n\t\t\treturn generateUrl(`/core/preview?fileId=${this.tag.referenceFileid}&x=${512}&y=${512}&forceIcon=0&a=1`)\n\t\t},\n\n\t\tcount() {\n\t\t\treturn this.tag.filesAssigned\n\t\t},\n\t},\n\n\twatch: {\n\t\tloadCover() {\n\t\t\tif (this.tag.filesAssigned) {\n\t\t\t\treturn\n\t\t\t}\n\t\t\tthis.$store.dispatch('fetchTagFiles', { id: this.tag.id, signal: this.abortController.signal })\n\t\t},\n\t},\n\n\tmounted() {\n\t\tthis.observer = new IntersectionObserver((entries) => {\n\t\t\tif (entries[0].isIntersecting) {\n\t\t\t\tthis.loadCover = true\n\t\t\t\tthis.observer.disconnect()\n\t\t\t}\n\t\t})\n\t\tthis.observer.observe(this.$el)\n\t},\n}\n</script>\n<style scoped lang=\"scss\">\n.tag-cover {\n\tdisplay: flex;\n\tflex-direction: column;\n\tpadding: 16px;\n\tborder-radius: 12px;\n\n\t&:hover, &:focus {\n\t\tbackground: var(--color-background-dark);\n\t}\n\n\t&__image {\n\t\twidth: 350px;\n\t\theight: 350px;\n\t\tobject-fit: cover;\n\t\tborder-radius: 12px;\n\n\t\t@media only screen and (max-width: 1200px) {\n\t\t\twidth: 250px;\n\t\t\theight: 250px;\n\t\t}\n\n\t\t&--placeholder {\n\t\t\tbackground: var(--color-primary-element-light);\n\n\t\t\t:deep(.material-design-icon) {\n\t\t\t\twidth: 100%;\n\t\t\t\theight: 100%;\n\n\t\t\t\t.material-design-icon__svg {\n\t\t\t\t\tfill: var(--color-primary-element);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t&__details {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tmargin-top: 16px;\n\t\twidth: 350px;\n\n\t\t@media only screen and (max-width: 1200px) {\n\t\t\twidth: 250px;\n\t\t}\n\n\t\t&__first-line {\n\t\t\tdisplay: flex;\n\t\t}\n\n\t\t&__second-line {\n\t\t\tdisplay: flex;\n\t\t\tcolor: var(--color-text-lighter);\n\t\t}\n\n\t\t&__name {\n\t\t\tflex-grow: 1;\n\t\t\tmargin: 0;\n\t\t\tfont-weight: normal;\n\t\t\toverflow: hidden;\n\t\t\twhite-space: nowrap;\n\t\t\ttext-overflow: ellipsis;\n\n\t\t}\n\t}\n\n}\n</style>\n","<!--\n  - SPDX-FileCopyrightText: 2019 Nextcloud GmbH and Nextcloud contributors\n  - SPDX-License-Identifier: AGPL-3.0-or-later\n-->\n\n<template>\n\t<div>\n\t\t<!-- Errors handlers-->\n\t\t<NcEmptyContent v-if=\"error\" :name=\"t('photos', 'An error occurred')\" />\n\n\t\t<NcEmptyContent v-if=\"!loading && tagsList.length === 0\" :name=\"t('photos', 'No tags yet')\" :description=\"t('photos', 'Photos with tags will show up here')\" />\n\n\t\t<NcLoadingIcon v-if=\"loading\" class=\"loader\" />\n\n\t\t<div v-else class=\"container\">\n\t\t\t<h2 v-if=\"popularTags.length\">\n\t\t\t\t{{ t('photos', 'Popular tags') }}\n\t\t\t</h2>\n\t\t\t<div class=\"popular-tags\">\n\t\t\t\t<TagCover v-for=\"tag in popularTags\" :key=\"tag.id\" :tag=\"tag\" />\n\t\t\t</div>\n\t\t\t<h2 v-if=\"tagsList.length\">\n\t\t\t\t{{ t('photos', 'All tags') }}\n\t\t\t</h2>\n\t\t\t<div class=\"tags\">\n\t\t\t\t<TagCover v-for=\"tag in tagsList\" :key=\"tag.id\" :tag=\"tag\" />\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</template>\n\n<script lang='ts'>\nimport { mapGetters } from 'vuex'\n\nimport { NcEmptyContent, NcLoadingIcon } from '@nextcloud/vue'\n\nimport TagCover from '../components/TagCover.vue'\nimport AbortControllerMixin from '../mixins/AbortControllerMixin.js'\nimport logger from '../services/logger'\n\nexport default {\n\tname: 'Tags',\n\tcomponents: {\n\t\tTagCover,\n\t\tNcLoadingIcon,\n\t\tNcEmptyContent,\n\t},\n\tmixins: [AbortControllerMixin],\n\n\tdata() {\n\t\treturn {\n\t\t\terror: null,\n\t\t\tloading: false,\n\t\t\tshowTags: false,\n\t\t}\n\t},\n\n\tcomputed: {\n\t\t// global lists\n\t\t...mapGetters([\n\t\t\t'files',\n\t\t\t'tags',\n\t\t\t'tagsNames',\n\t\t]),\n\n\t\ttagsList() {\n\t\t\treturn Object.keys(this.tagsNames)\n\t\t\t\t.map(tagName => this.tags[this.tagsNames[tagName]])\n\t\t\t\t.filter(tag => tag && tag.id)\n\t\t},\n\n\t\tpopularTags() {\n\t\t\treturn Object.keys(this.tagsNames)\n\t\t\t\t.filter(tagName => (this.tags[this.tagsNames[tagName]].filesAssigned) > 50)\n\t\t\t\t.sort((a, b) => (this.tags[this.tagsNames[b]].filesAssigned || this.tagCounts[b]) - (this.tags[this.tagsNames[a]].filesAssigned || this.tagCounts[a]))\n\t\t\t\t.slice(0, 9)\n\t\t\t\t.map(tagName => this.tags[this.tagsNames[tagName]])\n\t\t},\n\t},\n\n\tasync beforeMount() {\n\t\tawait this.fetchRootContent()\n\t},\n\n\tmethods: {\n\t\tasync fetchRootContent() {\n\t\t\t// close any potential opened viewer\n\t\t\tOCA.Viewer.close()\n\n\t\t\tthis.error = null\n\n\t\t\ttry {\n\t\t\t\t// fetch content\n\t\t\t\tif (!this.tagsList.length) {\n\t\t\t\t\tthis.loading = true\n\t\t\t\t\tawait this.$store.dispatch('fetchAllTags', {\n\t\t\t\t\t\tsignal: this.abortController.signal,\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t} catch (error) {\n\t\t\t\tlogger.error(error)\n\t\t\t\tthis.error = true\n\t\t\t} finally {\n\t\t\t\t// done loading\n\t\t\t\tthis.loading = false\n\t\t\t}\n\t\t},\n\t},\n\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.loader {\n\tmargin-top: 30vh;\n}\n\n.container {\n\tpadding-left: 44px;\n\n\t> h2 {\n\t\tmargin-left: 14px;\n\t\tmargin-top: 40px;\n\t}\n}\n\n.popular-tags, .tags {\n\tdisplay: flex;\n\tflex-direction: row;\n\tgap: 8px;\n\tflex-wrap: wrap;\n}\n</style>\n","<!--\n  - SPDX-FileCopyrightText: 2019 Nextcloud GmbH and Nextcloud contributors\n  - SPDX-License-Identifier: AGPL-3.0-or-later\n-->\n\n<template>\n\t<!-- Errors handlers-->\n\t<NcEmptyContent v-if=\"error\" :name=\"t('photos', 'An error occurred')\" />\n\n\t<NcLoadingIcon v-else-if=\"loading\" class=\"loader\" />\n\n\t<!-- Folder content -->\n\t<div v-else>\n\t\t<div class=\"photos-navigation\">\n\t\t\t<NcActions class=\"photos-navigation__back\">\n\t\t\t\t<NcActionButton @click=\"$router.push({name: 'tags'})\">\n\t\t\t\t\t<template #icon>\n\t\t\t\t\t\t<ArrowLeft />\n\t\t\t\t\t</template>\n\t\t\t\t\t{{ t('photos', 'Back to tags overview') }}\n\t\t\t\t</NcActionButton>\n\t\t\t</NcActions>\n\t\t\t<h2 class=\"photos-navigation__title\">\n\t\t\t\t{{ path }}\n\t\t\t</h2>\n\t\t</div>\n\t\t<div class=\"heading-subline\">\n\t\t\t{{ n('photos', '%n photo', '%n photos', fileIds.length,) }}\n\t\t</div>\n\t\t<NcEmptyContent v-if=\"isEmpty\" :name=\"t('photos', 'No photos with this tag yet')\" />\n\n\t\t<FilesListViewer class=\"tag__photos\"\n\t\t\t:container-element=\"appContent\"\n\t\t\t:file-ids=\"fileIds\"\n\t\t\t:base-height=\"isMobile ? 120 : 200\"\n\t\t\t:loading=\"loading\">\n\t\t\t<File slot-scope=\"{file, distance}\"\n\t\t\t\t:file=\"files[file.id]\"\n\t\t\t\t:allow-selection=\"true\"\n\t\t\t\t:selected=\"selection[file.id] === true\"\n\t\t\t\t:distance=\"distance\"\n\t\t\t\t@click=\"openViewer\"\n\t\t\t\t@select-toggled=\"onFileSelectToggle\" />\n\t\t</FilesListViewer>\n\t</div>\n</template>\n\n<script lang='ts'>\nimport { mapGetters } from 'vuex'\nimport ArrowLeft from 'vue-material-design-icons/ArrowLeft.vue'\n\nimport { NcEmptyContent, NcActions, NcActionButton, NcLoadingIcon, useIsMobile } from '@nextcloud/vue'\n\nimport File from '../components/File.vue'\nimport FilesListViewer from '../components/FilesListViewer.vue'\n\nimport FilesSelectionMixin from '../mixins/FilesSelectionMixin.js'\nimport AbortControllerMixin from '../mixins/AbortControllerMixin.js'\n\nexport default {\n\tname: 'TagContent',\n\tcomponents: {\n\t\tFile,\n\t\tFilesListViewer,\n\t\tNcEmptyContent,\n\t\tNcActions,\n\t\tNcActionButton,\n\t\tNcLoadingIcon,\n\t\tArrowLeft,\n\t},\n\tmixins: [\n\t\tFilesSelectionMixin,\n\t\tAbortControllerMixin,\n\t],\n\tprops: {\n\t\tpath: {\n\t\t\ttype: String,\n\t\t\tdefault: '',\n\t\t},\n\t},\n\n\tsetup() {\n\t\treturn {\n\t\t\tisMobile: useIsMobile(),\n\t\t}\n\t},\n\n\tdata() {\n\t\treturn {\n\t\t\terror: null,\n\t\t\tloading: false,\n\t\t\tappContent: document.getElementById('app-content-vue'),\n\t\t}\n\t},\n\n\tcomputed: {\n\t\t// global lists\n\t\t...mapGetters([\n\t\t\t'files',\n\t\t\t'tags',\n\t\t\t'tagsNames',\n\t\t]),\n\n\t\t// current tag id from current path\n\t\ttagId() {\n\t\t\treturn this.$store.getters.tagId(this.path)\n\t\t},\n\n\t\t// current tag\n\t\ttag() {\n\t\t\treturn this.tags[this.tagId]\n\t\t},\n\n\t\t// files list of the current tag\n\t\tfileIds() {\n\t\t\treturn this.tag?.files ?? []\n\t\t},\n\n\t\tisEmpty() {\n\t\t\treturn this.fileIds.length === 0\n\t\t},\n\t},\n\n\twatch: {\n\t\tasync path() {\n\t\t\tthis.fetchContent()\n\t\t},\n\t},\n\n\tasync beforeMount() {\n\t\tthis.fetchContent()\n\t},\n\n\tmethods: {\n\t\tasync fetchContent() {\n\t\t\t// close any potential opened viewer\n\t\t\tOCA.Viewer.close()\n\n\t\t\tthis.loading = true\n\t\t\tthis.error = null\n\n\t\t\ttry {\n\t\t\t\t// if we don't already have some cached data let's show a loader\n\t\t\t\tif (!this.tags[this.tagId]) {\n\t\t\t\t\tawait this.$store.dispatch('fetchAllTags', { signal: this.abortController.signal })\n\t\t\t\t}\n\n\t\t\t\tif (this.tag && !this.tag.files) {\n\t\t\t\t\tawait this.$store.dispatch('fetchTagFiles', { id: this.tagId, signal: this.abortController.signal })\n\t\t\t\t}\n\t\t\t} catch (error) {\n\t\t\t\tlogger.error(error)\n\t\t\t\tthis.error = true\n\t\t\t} finally {\n\t\t\t\t// done loading\n\t\t\t\tthis.loading = false\n\t\t\t}\n\t\t},\n\n\t\topenViewer(fileId) {\n\t\t\tconst file = this.files[fileId]\n\t\t\tOCA.Viewer.open({\n\t\t\t\tpath: file.filename,\n\t\t\t\tlist: this.fileIds.map(fileId => this.files[fileId]),\n\t\t\t\tloadMore: file.loadMore ? async () => await file.loadMore(true) : () => [],\n\t\t\t\tcanLoop: file.canLoop,\n\t\t\t})\n\t\t},\n\t},\n}\n</script>\n<style scoped lang=\"scss\">\n.loader {\n\tmargin-top: 30vh;\n}\n\n.photos-navigation {\n\tdisplay: flex;\n\theight: 44px;\n\tpadding: 0 40px;\n\talign-items: center;\n\tmax-width: 100%;\n\n\th2 {\n\t\tpadding: 0;\n\t\tmargin: 0;\n\t}\n}\n\n.heading-subline {\n\tmargin-left: 85px;\n\tmargin-top: -11px;\n\tcolor: var(--color-text-maxcontrast);\n}\n\n.tag__photos {\n\tpadding: 0 64px;\n}\n</style>\n"],"names":["global","Symbol","name","STATE_PLAINTEXT","STATE_HTML","STATE_COMMENT","ALLOWED_TAGS_REGEX","NORMALIZE_TAG_REGEX","striptags","html","allowable_tags","tag_replacement","context","init_context","striptags_internal","init_striptags_stream","parse_allowable_tags","state","tag_buffer","depth","in_quote_char","output","idx","length","char","normalize_tag","tag_set","match","module","this","register","t0","NcSelect","t","systemtags","loadState","wellKnownSymbol","require$$0","TO_STRING_TAG","test","toStringTagSupport","getTaggedImages","id","options","getDefaultDavProps","davClient","defaultRootPath","data","genFileInfo","file","allowedMimes","getSystemTags","path","mutations","tags","a","b","sortCompare","tag","Vue","files","list","logger","getters","actions","signal","error","_sfc_main$2","ImageMultipleIcon","AbortControllerMixin","mapGetters","generateUrl","entries","_sfc_main$1","TagCover","NcLoadingIcon","NcEmptyContent","tagName","_sfc_main","File","FilesListViewer","NcActions","NcActionButton","ArrowLeft","FilesSelectionMixin","useIsMobile","fileId"],"mappings":"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","x_google_ignoreList":[0,1,3]}