{"version":3,"file":"photos-public.mjs","sources":["../src/PhotosPublic.vue","../src/public.ts"],"sourcesContent":["<!--\n  - SPDX-FileCopyrightText: 2022 Nextcloud GmbH and Nextcloud contributors\n  - SPDX-License-Identifier: AGPL-3.0-or-later\n-->\n\n<template>\n\t<NcContent app-name=\"photos\">\n\t\t<!--\n\t\tNeeded for isPublicShare to return true\n\t\thttps://github.com/nextcloud-libraries/nextcloud-sharing/blob/15f38dfdeb2c72501008e5ae89d3eb424b83aed5/lib/publicShare.ts#L12-L20\n\t\t -->\n\t\t<input id=\"isPublic\"\n\t\t\ttype=\"hidden\"\n\t\t\tname=\"isPublic\"\n\t\t\tvalue=\"1\">\n\t\t<NcAppContent>\n\t\t\t<router-view />\n\n\t\t\t<!-- svg img loading placeholder (linked to the File component) -->\n\t\t\t<!-- eslint-disable-next-line vue/no-v-html (because it's an SVG file) -->\n\t\t\t<span class=\"hidden-visually\" role=\"none\" v-html=\"svgplaceholder\" />\n\t\t\t<!-- eslint-disable-next-line vue/no-v-html (because it's an SVG file) -->\n\t\t\t<span class=\"hidden-visually\" role=\"none\" v-html=\"imgplaceholder\" />\n\t\t\t<!-- eslint-disable-next-line vue/no-v-html (because it's an SVG file) -->\n\t\t\t<span class=\"hidden-visually\" role=\"none\" v-html=\"videoplaceholder\" />\n\t\t</NcAppContent>\n\t</NcContent>\n</template>\n\n<script lang='ts'>\nimport { generateUrl } from '@nextcloud/router'\n\nimport NcContent from '@nextcloud/vue/dist/Components/NcContent.js'\nimport NcAppContent from '@nextcloud/vue/dist/Components/NcAppContent.js'\n\nimport logger from './services/logger.js'\nimport svgplaceholder from './assets/file-placeholder.svg'\nimport imgplaceholder from './assets/image.svg'\nimport videoplaceholder from './assets/video.svg'\n\nexport default {\n\tname: 'PhotosPublic',\n\tcomponents: {\n\t\tNcAppContent,\n\t\tNcContent,\n\t},\n\tdata() {\n\t\treturn {\n\t\t\tsvgplaceholder,\n\t\t\timgplaceholder,\n\t\t\tvideoplaceholder,\n\t\t}\n\t},\n\n\tasync beforeMount() {\n\t\tif ('serviceWorker' in navigator) {\n\t\t\t// Use the window load event to keep the page load performant\n\t\t\twindow.addEventListener('load', async () => {\n\t\t\t\ttry {\n\t\t\t\t\tconst url = generateUrl('/apps/photos/service-worker.js', {}, { noRewrite: true })\n\t\t\t\t\tconst registration = await navigator.serviceWorker.register(url, { scope: generateUrl('/apps/photos') })\n\t\t\t\t\tlogger.debug('SW registered: ', { registration })\n\t\t\t\t} catch (error) {\n\t\t\t\t\tlogger.error('SW registration failed: ', { error })\n\t\t\t\t}\n\t\t\t})\n\t\t} else {\n\t\t\tlogger.debug('Service Worker is not enabled on this browser.')\n\t\t}\n\t},\n\n\tbeforeDestroy() {\n\t\twindow.removeEventListener('load', () => {\n\t\t\tnavigator.serviceWorker.register(generateUrl('/apps/photos/service-worker.js', {}, {\n\t\t\t\tnoRewrite: true,\n\t\t\t}))\n\t\t})\n\t},\n}\n</script>\n<style lang=\"scss\">\n.app-content {\n\tdisplay: flex;\n\tflex-grow: 1;\n\tflex-direction: column;\n\talign-content: space-between;\n}\n\n.app-navigation__photos:deep(.app-navigation-entry-icon.icon-photos) {\n\tbackground-size: 20px;\n}\n</style>\n","/**\n * SPDX-FileCopyrightText: 2019 Nextcloud GmbH and Nextcloud contributors\n * SPDX-License-Identifier: AGPL-3.0-or-later\n */\n\nimport { sync } from 'vuex-router-sync'\nimport { translate, translatePlural } from '@nextcloud/l10n'\nimport Vue from 'vue'\n\nimport PhotosPublic from './PhotosPublic.vue'\nimport router from './router/index.js'\nimport store from './store/index.js'\n\nsync(store, router)\n\nVue.prototype.t = translate\nVue.prototype.n = translatePlural\n\n// TODO: remove when we have a proper fileinfo standalone library\n// original scripts are loaded from\n// https://github.com/nextcloud/server/blob/5bf3d1bb384da56adbf205752be8f840aac3b0c5/lib/private/legacy/template.php#L120-L122\nwindow.addEventListener('DOMContentLoaded', () => {\n\tif (!window.OCA.Files) {\n\t\twindow.OCA.Files = {}\n\t}\n\t// register unused client for the sidebar to have access to its parser methods\n\tObject.assign(window.OCA.Files, { App: { fileList: { filesClient: OC.Files.getClient() } } }, window.OCA.Files)\n})\n\nexport default new Vue({\n\tel: '#content',\n\t// eslint-disable-next-line vue/match-component-file-name\n\tname: 'PhotosRoot',\n\trouter,\n\tstore,\n\trender: h => h(PhotosPublic),\n})\n"],"names":["_sfc_main","NcAppContent","NcContent","svgplaceholder","imgplaceholder","videoplaceholder","url","generateUrl","registration","logger","error","sync","store","router","Vue","translate","translatePlural","h","PhotosPublic"],"mappings":"2VAwCA,MAAAA,EAAA,CACA,KAAA,eACA,WAAA,CACA,aAAAC,EACA,UAAAC,CACA,EACA,MAAA,CACA,MAAA,CACA,eAAAC,EACA,eAAAC,EACA,iBAAAC,CACA,CACA,EAEA,MAAA,aAAA,CACA,kBAAA,UAEA,OAAA,iBAAA,OAAA,SAAA,CACA,GAAA,CACA,MAAAC,EAAAC,EAAA,iCAAA,GAAA,CAAA,UAAA,GAAA,EACAC,EAAA,MAAA,UAAA,cAAA,SAAAF,EAAA,CAAA,MAAAC,EAAA,cAAA,EAAA,EACAE,EAAA,MAAA,kBAAA,CAAA,aAAAD,CAAA,CAAA,QACAE,EAAA,CACAD,EAAA,MAAA,2BAAA,CAAA,MAAAC,CAAA,CAAA,CAAA,CACA,CACA,EAEAD,EAAA,MAAA,gDAAA,CAEA,EAEA,eAAA,CACA,OAAA,oBAAA,OAAA,IAAA,CACA,UAAA,cAAA,SAAAF,EAAA,iCAAA,CAAA,EAAA,CACA,UAAA,EAAA,CACA,CAAA,CAAA,CACA,CAAA,CAEA,qkBCjEAI,EAAAA,KAAKC,EAAOC,CAAM,EAElBC,EAAI,UAAU,EAAIC,EAClBD,EAAI,UAAU,EAAIE,EAKlB,OAAO,iBAAiB,mBAAoB,IAAM,CAC5C,OAAO,IAAI,QACR,OAAA,IAAI,MAAQ,CAAC,GAGrB,OAAO,OAAO,OAAO,IAAI,MAAO,CAAE,IAAK,CAAE,SAAU,CAAE,YAAa,GAAG,MAAM,UAAY,CAAA,IAAO,OAAO,IAAI,KAAK,CAC/G,CAAC,EAEc,IAAIF,EAAI,CACtB,GAAI,WAEJ,KAAM,aACN,OAAAD,EAAA,MACAD,EACA,OAAaK,GAAAA,EAAEC,CAAY,CAC5B,CAAC"}