import{V as I,u as be,s as we,o as Ce,d as F,b as f,A as d,a5 as R,y as re,D as ne,q as A,e as ke,G as Se,l as se,T as ae,_ as T,a6 as Ne,W as H,H as W,g as xe,J as D,n as Fe,C as Le,a7 as le,a8 as Be,L as j,P as oe,B as ze}from"./vue.runtime.esm-DZVHDHac.chunk.mjs";import{n as Z,N as U,q,H as Ae,I as m,C as g,B as G,k as ce,b as Ve}from"./index-CtBKWcPT.chunk.mjs";import{s as $e,f as Ie}from"./index-SCFTKIaY.chunk.mjs";import{C as Pe,N as He}from"./NcActionButton-Gpv56vuS-DwokBgrB.chunk.mjs";import"./index-BKOSQir6.chunk.mjs";import{N as De}from"./Tooltip-Bzn-7vu5.chunk.mjs";import{P as Me}from"./NcProgressBar-DegJ2JjE-CMVvcGKc.chunk.mjs";import{N as Oe,a as Ee}from"./NcAvatar-Db8tkJt9-RDXKOt7x.chunk.mjs";import"./NcAppSettingsSection-Bl2-D3_g-Bx19lXF_.chunk.mjs";import"./logger-D3RVzcfQ-BGZwsZPf.chunk.mjs";import"./useHotKey-CUZeWrE9.chunk.mjs";import{d as Re}from"./index-C7x2K0nC.chunk.mjs";import{N as ue}from"./NcCheckboxRadioSwitch-Di9rSADK-D02oVeZo.chunk.mjs";import"./NcListItem-DfaWGP5A-C0e3F2z_.chunk.mjs";import{N as Te}from"./NcDateTime-BR6BBvML-BOyii8_u.chunk.mjs";import{N as We}from"./NcDialog-D2lwwZL--BBju5KIU.chunk.mjs";import{N as je}from"./NcSelect-TmGBPLzc-zzm4Fa4O.chunk.mjs";import{N as Ze}from"./NcEmptyContent-BKTjF0KK.chunk.mjs";import{N as Ue}from"./NcTextField-DRANdaIf-B2wZmHTG.chunk.mjs";import"./NcUserBubble-cO5krePG-B1PNEIxd.chunk.mjs";import"./preload-helper-Dh9HmuEY.chunk.mjs";import"./useModelMigration-EhAWvqDD-C-Iitg9F.chunk.mjs";import"./ChevronDown-DFQfzh63-CmnU8nt7.chunk.mjs";const qe={name:"NcBreadcrumb",components:{NcActions:q,ChevronRight:Pe,NcButton:U},inheritAttrs:!1,props:{name:{type:String,required:!0},title:{type:String,default:null},to:{type:[String,Object],default:void 0},exact:{type:Boolean,default:!1},href:{type:String,default:void 0},icon:{type:String,default:""},forceIconText:{type:Boolean,default:!1},disableDrop:{type:Boolean,default:!1},forceMenu:{type:Boolean,default:!1},open:{type:Boolean,default:!1}},emits:["update:open","dropped"],data(){return{hovering:!1,crumbId:`crumb-id-${Ae()}`}},computed:{linkAttributes(){return this.to?{to:this.to,exact:this.exact,...this.$attrs}:this.href?{href:this.href,...this.$attrs}:this.$attrs}},methods:{onOpenChange(e){this.$emit("update:open",e)},dropped(e){return this.disableDrop||(this.$emit("dropped",e,this.to||this.href),this.$parent.$emit("dropped",e,this.to||this.href),this.hovering=!1),!1},dragEnter(e){this.disableDrop||(this.hovering=!0)},dragLeave(e){this.disableDrop||e.target.contains(e.relatedTarget)||this.$refs.crumb.contains(e.relatedTarget)||(this.hovering=!1)}}};var Ge=function(){var e=this,t=e._self._c;return t("li",e._b({ref:"crumb",staticClass:"vue-crumb",class:{"vue-crumb--hovered":e.hovering},attrs:{draggable:"false"},on:{dragstart:function(i){return i.preventDefault(),(()=>{}).apply(null,arguments)},drop:function(i){return i.preventDefault(),e.dropped.apply(null,arguments)},dragover:function(i){return i.preventDefault(),(()=>{}).apply(null,arguments)},dragenter:e.dragEnter,dragleave:e.dragLeave}},"li",e._d({},[e.crumbId,""])),[(e.name||e.icon||e.$slots.icon)&&!e.$slots.default?t("NcButton",e._g(e._b({attrs:{"aria-label":e.icon?e.name:void 0,title:e.title,variant:"tertiary"},scopedSlots:e._u([e.$slots.icon||e.icon?{key:"icon",fn:function(){return[e._t("icon",function(){return[t("span",{staticClass:"icon",class:e.icon})]})]},proxy:!0}:null,!(e.$slots.icon||e.icon)||e.forceIconText?{key:"default",fn:function(){return[e._v(" "+e._s(e.name)+" ")]},proxy:!0}:null],null,!0)},"NcButton",e.linkAttributes,!1),e.$listeners)):e._e(),e.$slots.default?t("NcActions",{ref:"actions",attrs:{"force-menu":e.forceMenu,open:e.open,"menu-name":e.name,title:e.title,"force-name":!0,container:`.vue-crumb[${e.crumbId}]`,variant:"tertiary"},on:{"update:open":e.onOpenChange},scopedSlots:e._u([{key:"icon",fn:function(){return[e._t("menu-icon")]},proxy:!0}],null,!0)},[e._t("default")],2):e._e(),t("ChevronRight",{staticClass:"vue-crumb__separator",attrs:{size:20}})],1)},Ke=[],Je=Z(qe,Ge,Ke,!1,null,"c55f5445");const de=Je.exports;var O=Symbol(),B=Symbol(),J=Symbol(),Q=Symbol(),K=function(e){return"frag"in e},Qe={get:function(){return this[B]||this.parentElement},configurable:!0},z=function(e,t){B in e||(e[B]=t,Object.defineProperty(e,"parentNode",Qe))},Xe={get:function(){var e=this.parentNode.childNodes,t=e.indexOf(this);return t>-1&&e[t+1]||null}},P=function(e){J in e||(e[J]=!0,Object.defineProperty(e,"nextSibling",Xe))},Ye=function(e,t){for(;e.parentNode!==t;){var i=e,r=i.parentNode;r&&(e=r)}return e},E,pe=function(e){if(!E){var t=Object.getOwnPropertyDescriptor(Node.prototype,"childNodes");E=t.get}var i=E.apply(e),r=Array.from(i).map(function(n){return Ye(n,e)});return r.filter(function(n,s){return n!==r[s-1]})},et={get:function(){return this.frag||pe(this)}},tt={get:function(){return this.childNodes[0]||null}};function it(){return this.childNodes.length>0}var X=function(e){Q in e||(e[Q]=!0,Object.defineProperties(e,{childNodes:et,firstChild:tt}),e.hasChildNodes=it)};function rt(){var e;(e=this.frag[0]).before.apply(e,arguments)}function nt(){var e=this.frag,t=e.splice(0,e.length);t.forEach(function(i){i.remove()})}var st=function e(t){var i;return(i=Array.prototype).concat.apply(i,t.map(function(r){return K(r)?e(r.frag):r}))},at=function(e,t){var i=e[O];t.before(i),z(i,e),e.frag.unshift(i)};function Y(e){if(K(this)){var t=this.frag.indexOf(e);if(t>-1){var i=this.frag.splice(t,1),r=i[0];this.frag.length===0&&at(this,r),e.remove()}}else{var n=pe(this),s=n.indexOf(e);s>-1&&e.remove()}return e}function ee(e,t){var i=this,r=e.frag||[e];if(K(this)){if(e[B]===this&&e.parentElement)return e;var n=this.frag;if(t){var s=n.indexOf(t);s>-1&&(n.splice.apply(n,[s,0].concat(r)),t.before.apply(t,r))}else{var a=n[n.length-1];n.push.apply(n,r),a.after.apply(a,r)}fe(this)}else t?this.childNodes.includes(t)&&t.before.apply(t,r):this.append.apply(this,r);r.forEach(function(c){z(c,i)});var l=r[r.length-1];return P(l),e}function lt(e){if(e[B]===this&&e.parentElement)return e;var t=this.frag,i=t[t.length-1];return i.after(e),z(e,this),fe(this),t.push(e),e}var fe=function(e){var t=e[O];e.frag[0]===t&&(e.frag.shift(),t.remove())},ot={set:function(e){var t=this;if(this.frag[0]!==this[O]&&this.frag.slice().forEach(function(r){return t.removeChild(r)}),e){var i=document.createElement("div");i.innerHTML=e,Array.from(i.childNodes).forEach(function(r){t.appendChild(r)})}},get:function(){return""}},ct={inserted:function(e){var t=e.parentNode,i=e.nextSibling,r=e.previousSibling,n=Array.from(e.childNodes),s=document.createComment("");n.length===0&&n.push(s),e.frag=n,e[O]=s;var a=document.createDocumentFragment();a.append.apply(a,st(n)),e.replaceWith(a),n.forEach(function(l){z(l,e),P(l)}),X(e),Object.assign(e,{remove:nt,appendChild:lt,insertBefore:ee,removeChild:Y,before:rt}),Object.defineProperty(e,"innerHTML",ot),t&&(Object.assign(t,{removeChild:Y,insertBefore:ee}),z(e,t),X(t)),i&&P(e),r&&P(r)},unbind:function(e){e.remove()}},me={name:"Fragment",directives:{frag:ct},render:function(e){return e("div",{directives:[{name:"frag"}]},this.$slots.default)}};const te=(e,t,i)=>{if(e!==void 0)for(let r=e.length-1;r>=0;r--){const n=e[r],s=!n.componentOptions&&n.tag&&t.indexOf(n.tag)===-1,a=!!n.componentOptions&&typeof n.componentOptions.tag=="string",l=a&&t.indexOf(n.componentOptions.tag)===-1;(s||!a||l)&&((s||l)&&I.util.warn(`${s?n.tag:n.componentOptions.tag} is not allowed inside the ${i.$options.name} component`,i),e.splice(r,1))}},ut={name:"FolderIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var dt=function(){var e=this,t=e._self._c;return t("span",e._b({staticClass:"material-design-icon folder-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(i){return e.$emit("click",i)}}},"span",e.$attrs,!1),[t("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[t("path",{attrs:{d:"M10,4H4C2.89,4 2,4.89 2,6V18A2,2 0 0,0 4,20H20A2,2 0 0,0 22,18V8C22,6.89 21.1,6 20,6H12L10,4Z"}},[e.title?t("title",[e._v(e._s(e.title))]):e._e()])])])},pt=[],ft=Z(ut,dt,pt,!1,null,null);const mt=ft.exports,y="vue-crumb",ht={name:"NcBreadcrumbs",components:{NcActions:q,NcActionButton:He,NcActionRouter:Ee,NcActionLink:Oe,NcBreadcrumb:de,IconFolder:mt},props:{rootIcon:{type:String,default:"icon-home"},ariaLabel:{type:String,default:null}},emits:["dropped"],data(){return{hiddenIndices:[],menuBreadcrumbProps:{name:"",forceMenu:!0,disableDrop:!0,open:!1},breadcrumbsRefs:{}}},beforeMount(){te(this.$slots.default,["NcBreadcrumb"],this)},beforeUpdate(){te(this.$slots.default,["NcBreadcrumb"],this)},created(){window.addEventListener("resize",Re(()=>{this.handleWindowResize()},100)),we("navigation-toggled",this.delayedResize)},mounted(){this.handleWindowResize()},updated(){this.delayedResize(),this.$nextTick(()=>{this.hideCrumbs()})},beforeDestroy(){window.removeEventListener("resize",this.handleWindowResize),be("navigation-toggled",this.delayedResize)},methods:{closeActions(e){this.$refs.actionsBreadcrumb.$el.contains(e.relatedTarget)||(this.menuBreadcrumbProps.open=!1)},async delayedResize(){await this.$nextTick(),this.handleWindowResize()},handleWindowResize(){if(!this.$refs.container)return;const e=Object.values(this.breadcrumbsRefs),t=e.length,i=[],r=this.$refs.container.offsetWidth;let n=this.getTotalWidth(e);this.$refs.breadcrumb__actions&&(n+=this.$refs.breadcrumb__actions.offsetWidth);let s=n-r;s+=s>0?64:0;let a=0;const l=Math.floor(t/2);for(;s>0&&a<t-2;){const c=l+(a%2?a+1:a)/2*Math.pow(-1,a+t%2);s-=this.getWidth(e[c]?.elm,c===e.length-1),i.push(c),a++}this.arraysEqual(this.hiddenIndices,i.sort((c,o)=>c-o))||(this.hiddenIndices=i)},arraysEqual(e,t){if(e.length!==t.length)return!1;if(e===t)return!0;if(e===null||t===null)return!1;for(let i=0;i<e.length;++i)if(e[i]!==t[i])return!1;return!0},getTotalWidth(e){return e.reduce((t,i,r)=>t+this.getWidth(i?.elm,r===e.length-1),0)},getWidth(e,t){if(!e?.classList)return 0;const i=e.classList.contains(`${y}--hidden`);e.style.minWidth="auto",t&&(e.style.maxWidth="210px"),e.classList.remove(`${y}--hidden`);const r=e.offsetWidth;return i&&e.classList.add(`${y}--hidden`),e.style.minWidth="",e.style.maxWidth="",r},preventDefault(e){return e.preventDefault&&e.preventDefault(),!1},dragStart(e){return this.preventDefault(e)},dropped(e,t,i){return i||this.$emit("dropped",e,t),this.menuBreadcrumbProps.open=!1,document.querySelectorAll(`.${y}`).forEach(r=>{r.classList.remove(`${y}--hovered`)}),this.preventDefault(e)},dragOver(e){return this.preventDefault(e)},dragEnter(e,t){if(!t&&e.target.closest){const i=e.target.closest(`.${y}`);i.classList&&i.classList.contains(y)&&(document.querySelectorAll(`.${y}`).forEach(r=>{r.classList.remove(`${y}--hovered`)}),i.classList.add(`${y}--hovered`))}},dragLeave(e,t){if(!t&&!e.target.contains(e.relatedTarget)&&e.target.closest){const i=e.target.closest(`.${y}`);if(i.contains(e.relatedTarget))return;i.classList&&i.classList.contains(y)&&i.classList.remove(`${y}--hovered`)}},hideCrumbs(){Object.values(this.breadcrumbsRefs).forEach((e,t)=>{e?.elm?.classList&&(this.hiddenIndices.includes(t)?e.elm.classList.add(`${y}--hidden`):e.elm.classList.remove(`${y}--hidden`))})},isBreadcrumb(e){return(e?.componentOptions?.tag||e?.tag||"").includes("NcBreadcrumb")}},render(e){const t=[];if(this.$slots.default.forEach(s=>{if(this.isBreadcrumb(s)){t.push(s);return}s?.type===me&&s?.children?.forEach?.(a=>{this.isBreadcrumb(a)&&t.push(a)})}),t.length===0)return;I.set(t[0].componentOptions.propsData,"icon",this.rootIcon),I.set(t[0].componentOptions.propsData,"ref","breadcrumbs");const i={};t.forEach((s,a)=>{I.set(s,"ref",`crumb-${a}`),i[a]=s});let r=[];if(!this.hiddenIndices.length)r=t;else{r=t.slice(0,Math.round(t.length/2)),r.push(e("NcBreadcrumb",{class:"dropdown",props:this.menuBreadcrumbProps,attrs:{"aria-hidden":!0},ref:"actionsBreadcrumb",key:"actions-breadcrumb-1",nativeOn:{dragstart:this.dragStart,dragenter:()=>{this.menuBreadcrumbProps.open=!0},dragleave:this.closeActions},on:{"update:open":a=>{this.menuBreadcrumbProps.open=a}}},this.hiddenIndices.filter(a=>a<=t.length-1).map(a=>{const l=t[a],c=l.componentOptions.propsData.to,o=l.componentOptions.propsData.href,v=l.componentOptions.propsData.disableDrop,p=l.componentOptions.propsData.title,k=l.componentOptions.propsData.name;let b="NcActionButton",C="";o&&(b="NcActionLink",C=o),c&&(b="NcActionRouter",C=c);const S=e("IconFolder",{props:{size:20},slot:"icon"});return e(b,{class:y,props:{href:o||null,title:p,to:c||null},attrs:{draggable:!1},on:{...l.componentOptions.listeners},nativeOn:{dragstart:this.dragStart,drop:w=>this.dropped(w,C,v),dragover:this.dragOver,dragenter:w=>this.dragEnter(w,v),dragleave:w=>this.dragLeave(w,v)}},[S,k])})));const s=t.slice(Math.round(t.length/2));r=r.concat(s)}const n=[e("nav",{attrs:{"aria-label":this.ariaLabel}},[e("ul",{class:"breadcrumb__crumbs"},[r])])];return this.$slots.actions&&n.push(e("div",{class:"breadcrumb__actions",ref:"breadcrumb__actions"},this.$slots.actions)),this.breadcrumbsRefs=i,e("div",{class:["breadcrumb",{"breadcrumb--collapsed":this.hiddenIndices.length===t.length-2}],ref:"container"},n)}},gt=null,vt=null;var _t=Z(ht,gt,vt,!1,null,"629bf30f");const yt=_t.exports;function M(e){return typeof e=="function"?e():Ce(e)}typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;var bt="M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M16.2,16.2L11,13V7H12.5V12.2L17,14.9L16.2,16.2Z",wt="M10,4H4C2.89,4 2,4.89 2,6V18A2,2 0 0,0 4,20H20A2,2 0 0,0 22,18V8C22,6.89 21.1,6 20,6H12L10,4Z",Ct="M12,17.27L18.18,21L16.54,13.97L22,9.24L14.81,8.62L12,2L9.19,8.62L2,9.24L7.45,13.97L5.82,21L12,17.27Z";const kt={name:"FileIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var St=function(){var e=this,t=e._self._c;return t("span",e._b({staticClass:"material-design-icon file-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(i){return e.$emit("click",i)}}},"span",e.$attrs,!1),[t("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[t("path",{attrs:{d:"M13,9V3.5L18.5,9M6,2C4.89,2 4,2.89 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2H6Z"}},[e.title?t("title",[e._v(e._s(e.title))]):e._e()])])])},Nt=[],xt=m(kt,St,Nt,!1,null,null);const he=xt.exports,ge=()=>{const e=se("files","config",null),t=f(e?.show_hidden??!0),i=f(e?.sort_favorites_first??!0),r=f(e?.crop_image_previews??!0);return A(async()=>{if(ae())console.debug("Skip loading files settings - currently on public share");else try{const{data:n}=await ce.get(T("/apps/files/api/v1/configs"));t.value=n?.data?.show_hidden??!1,i.value=n?.data?.sort_favorites_first??!0,r.value=n?.data?.crop_image_previews??!0}catch(n){console.error("Could not load files settings",n),G(g("Could not load files settings"))}}),{showHiddenFiles:t,sortFavoritesFirst:i,cropImagePreviews:r}},Ft=e=>{const t=o=>o==="asc"?"ascending":o==="desc"?"descending":"none",i=se("files","viewConfigs",null),r=f({sortBy:i?.files?.sorting_mode??"basename",order:t(i?.files?.sorting_direction??"asc")}),n=f({sortBy:i?.recent?.sorting_mode??"basename",order:t(i?.recent?.sorting_direction??"asc")}),s=f({sortBy:i?.favorites?.sorting_mode??"basename",order:t(i?.favorites?.sorting_direction??"asc")});A(async()=>{if(ae())console.debug("Skip loading files views - currently on public share");else try{const{data:o}=await ce.get(T("/apps/files/api/v1/views"));r.value={sortBy:o?.data?.files?.sorting_mode??"basename",order:t(o?.data?.files?.sorting_direction)},s.value={sortBy:o?.data?.favorites?.sorting_mode??"basename",order:t(o?.data?.favorites?.sorting_direction)},n.value={sortBy:o?.data?.recent?.sorting_mode??"basename",order:t(o?.data?.recent?.sorting_direction)}}catch(o){console.error("Could not load files views",o),G(g("Could not load files views"))}});const a=d(()=>M(e||"files")==="files"?r.value:M(e)==="recent"?n.value:s.value),l=d(()=>a.value.sortBy),c=d(()=>a.value.order);return{filesViewConfig:r,favoritesViewConfig:s,recentViewConfig:n,currentConfig:a,sortBy:l,order:c}},Lt={name:"MenuUpIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var Bt=function(){var e=this,t=e._self._c;return t("span",e._b({staticClass:"material-design-icon menu-up-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(i){return e.$emit("click",i)}}},"span",e.$attrs,!1),[t("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[t("path",{attrs:{d:"M7,15L12,10L17,15H7Z"}},[e.title?t("title",[e._v(e._s(e.title))]):e._e()])])])},zt=[],At=m(Lt,Bt,zt,!1,null,null);const Vt=At.exports,$t={name:"MenuDownIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var It=function(){var e=this,t=e._self._c;return t("span",e._b({staticClass:"material-design-icon menu-down-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(i){return e.$emit("click",i)}}},"span",e.$attrs,!1),[t("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[t("path",{attrs:{d:"M7,10L12,15L17,10H7Z"}},[e.title?t("title",[e._v(e._s(e.title))]):e._e()])])])},Pt=[],Ht=m($t,It,Pt,!1,null,null);const Dt=Ht.exports,ve={"file-picker__file-icon":"_file-picker__file-icon_19mjt_9"},Mt=F({__name:"LoadingTableRow",props:{showCheckbox:{type:Boolean}},setup(e){return{__sfc:!0,fileListIconStyles:ve}}});var Ot=function(){var e=this,t=e._self._c,i=e._self._setupProxy;return t("tr",{staticClass:"file-picker__row loading-row",attrs:{"aria-hidden":"true"}},[e.showCheckbox?t("td",{staticClass:"row-checkbox"},[t("span")]):e._e(),t("td",{staticClass:"row-name"},[t("div",{staticClass:"row-wrapper"},[t("span",{class:i.fileListIconStyles["file-picker__file-icon"]}),t("span")])]),e._m(0),e._m(1)])},Et=[function(){var e=this,t=e._self._c;return e._self._setupProxy,t("td",{staticClass:"row-size"},[t("span")])},function(){var e=this,t=e._self._c;return e._self._setupProxy,t("td",{staticClass:"row-modified"},[t("span")])}],Rt=m(Mt,Ot,Et,!1,null,"15187afc");const Tt=Rt.exports,Wt=new Me({concurrency:5});function jt(e){const{resolve:t,promise:i}=Promise.withResolvers();return Wt.add(()=>{const r=new Image;return r.onerror=()=>t(!1),r.onload=()=>t(!0),r.src=e,i}),i}function Zt(e,t={}){t={size:32,cropPreview:!1,mimeFallback:!0,...t};try{const i=e.attributes?.previewUrl||T("/core/preview?fileId={fileid}",{fileid:e.fileid});let r;try{r=new URL(i)}catch{r=new URL(i,window.location.origin)}return r.searchParams.set("x",`${t.size}`),r.searchParams.set("y",`${t.size}`),r.searchParams.set("mimeFallback",`${t.mimeFallback}`),r.searchParams.set("a",t.cropPreview===!0?"0":"1"),r.searchParams.set("c",`${e.attributes.etag}`),r}catch{return null}}const Ut=(e,t)=>{const i=f(null),r=f(!1);return ze(()=>{r.value=!1,i.value=Zt(M(e),M(t||{})),i.value&&jt(i.value.href).then(n=>{r.value=n})}),{previewURL:i,previewLoaded:r}},qt={name:"FolderIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var Gt=function(){var e=this,t=e._self._c;return t("span",e._b({staticClass:"material-design-icon folder-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(i){return e.$emit("click",i)}}},"span",e.$attrs,!1),[t("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[t("path",{attrs:{d:"M10,4H4C2.89,4 2,4.89 2,6V18A2,2 0 0,0 4,20H20A2,2 0 0,0 22,18V8C22,6.89 21.1,6 20,6H12L10,4Z"}},[e.title?t("title",[e._v(e._s(e.title))]):e._e()])])])},Kt=[],Jt=m(qt,Gt,Kt,!1,null,null);const _e=Jt.exports,Qt={name:"LockIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var Xt=function(){var e=this,t=e._self._c;return t("span",e._b({staticClass:"material-design-icon lock-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(i){return e.$emit("click",i)}}},"span",e.$attrs,!1),[t("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[t("path",{attrs:{d:"M12,17A2,2 0 0,0 14,15C14,13.89 13.1,13 12,13A2,2 0 0,0 10,15A2,2 0 0,0 12,17M18,8A2,2 0 0,1 20,10V20A2,2 0 0,1 18,22H6A2,2 0 0,1 4,20V10C4,8.89 4.9,8 6,8H7V6A5,5 0 0,1 12,1A5,5 0 0,1 17,6V8H18M12,3A3,3 0 0,0 9,6V8H15V6A3,3 0 0,0 12,3Z"}},[e.title?t("title",[e._v(e._s(e.title))]):e._e()])])])},Yt=[],ei=m(Qt,Xt,Yt,!1,null,null);const ti=ei.exports,ii={name:"TagIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var ri=function(){var e=this,t=e._self._c;return t("span",e._b({staticClass:"material-design-icon tag-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(i){return e.$emit("click",i)}}},"span",e.$attrs,!1),[t("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[t("path",{attrs:{d:"M5.5,7A1.5,1.5 0 0,1 4,5.5A1.5,1.5 0 0,1 5.5,4A1.5,1.5 0 0,1 7,5.5A1.5,1.5 0 0,1 5.5,7M21.41,11.58L12.41,2.58C12.05,2.22 11.55,2 11,2H4C2.89,2 2,2.89 2,4V11C2,11.55 2.22,12.05 2.59,12.41L11.58,21.41C11.95,21.77 12.45,22 13,22C13.55,22 14.05,21.77 14.41,21.41L21.41,14.41C21.78,14.05 22,13.55 22,13C22,12.44 21.77,11.94 21.41,11.58Z"}},[e.title?t("title",[e._v(e._s(e.title))]):e._e()])])])},ni=[],si=m(ii,ri,ni,!1,null,null);const ai=si.exports,li={name:"LinkIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var oi=function(){var e=this,t=e._self._c;return t("span",e._b({staticClass:"material-design-icon link-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(i){return e.$emit("click",i)}}},"span",e.$attrs,!1),[t("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[t("path",{attrs:{d:"M3.9,12C3.9,10.29 5.29,8.9 7,8.9H11V7H7A5,5 0 0,0 2,12A5,5 0 0,0 7,17H11V15.1H7C5.29,15.1 3.9,13.71 3.9,12M8,13H16V11H8V13M17,7H13V8.9H17C18.71,8.9 20.1,10.29 20.1,12C20.1,13.71 18.71,15.1 17,15.1H13V17H17A5,5 0 0,0 22,12A5,5 0 0,0 17,7Z"}},[e.title?t("title",[e._v(e._s(e.title))]):e._e()])])])},ci=[],ui=m(li,oi,ci,!1,null,null);const di=ui.exports,pi={name:"AccountPlusIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var fi=function(){var e=this,t=e._self._c;return t("span",e._b({staticClass:"material-design-icon account-plus-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(i){return e.$emit("click",i)}}},"span",e.$attrs,!1),[t("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[t("path",{attrs:{d:"M15,14C12.33,14 7,15.33 7,18V20H23V18C23,15.33 17.67,14 15,14M6,10V7H4V10H1V12H4V15H6V12H9V10M15,12A4,4 0 0,0 19,8A4,4 0 0,0 15,4A4,4 0 0,0 11,8A4,4 0 0,0 15,12Z"}},[e.title?t("title",[e._v(e._s(e.title))]):e._e()])])])},mi=[],hi=m(pi,fi,mi,!1,null,null);const ie=hi.exports,gi={name:"NetworkIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var vi=function(){var e=this,t=e._self._c;return t("span",e._b({staticClass:"material-design-icon network-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(i){return e.$emit("click",i)}}},"span",e.$attrs,!1),[t("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[t("path",{attrs:{d:"M17,3A2,2 0 0,1 19,5V15A2,2 0 0,1 17,17H13V19H14A1,1 0 0,1 15,20H22V22H15A1,1 0 0,1 14,23H10A1,1 0 0,1 9,22H2V20H9A1,1 0 0,1 10,19H11V17H7C5.89,17 5,16.1 5,15V5A2,2 0 0,1 7,3H17Z"}},[e.title?t("title",[e._v(e._s(e.title))]):e._e()])])])},_i=[],yi=m(gi,vi,_i,!1,null,null);const bi=yi.exports,wi={name:"AccountGroupIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var Ci=function(){var e=this,t=e._self._c;return t("span",e._b({staticClass:"material-design-icon account-group-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(i){return e.$emit("click",i)}}},"span",e.$attrs,!1),[t("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[t("path",{attrs:{d:"M12,5.5A3.5,3.5 0 0,1 15.5,9A3.5,3.5 0 0,1 12,12.5A3.5,3.5 0 0,1 8.5,9A3.5,3.5 0 0,1 12,5.5M5,8C5.56,8 6.08,8.15 6.53,8.42C6.38,9.85 6.8,11.27 7.66,12.38C7.16,13.34 6.16,14 5,14A3,3 0 0,1 2,11A3,3 0 0,1 5,8M19,8A3,3 0 0,1 22,11A3,3 0 0,1 19,14C17.84,14 16.84,13.34 16.34,12.38C17.2,11.27 17.62,9.85 17.47,8.42C17.92,8.15 18.44,8 19,8M5.5,18.25C5.5,16.18 8.41,14.5 12,14.5C15.59,14.5 18.5,16.18 18.5,18.25V20H5.5V18.25M0,20V18.5C0,17.11 1.89,15.94 4.45,15.6C3.86,16.28 3.5,17.22 3.5,18.25V20H0M24,20H20.5V18.25C20.5,17.22 20.14,16.28 19.55,15.6C22.11,15.94 24,17.11 24,18.5V20Z"}},[e.title?t("title",[e._v(e._s(e.title))]):e._e()])])])},ki=[],Si=m(wi,Ci,ki,!1,null,null);const Ni=Si.exports,xi={name:"FilePreview"},Fi=F({...xi,props:{node:null,cropImagePreviews:{type:Boolean}},setup(e){const t=e,i=f(ve),{previewURL:r,previewLoaded:n}=Ut(ne(t,"node"),d(()=>({cropPreview:t.cropImagePreviews}))),s=d(()=>t.node.type===D.File),a=d(()=>{if(t.node.type!==D.Folder)return null;if(t.node.attributes?.["is-encrypted"]===1)return ti;if(t.node.attributes?.["is-tag"])return ai;const l=Object.values(t.node.attributes?.["share-types"]||{}).flat();if(l.some(c=>c===ShareType.Link||c===ShareType.Email))return di;if(l.length>0)return ie;switch(t.node.attributes?.["mount-type"]){case"external":case"external-session":return bi;case"group":return Ni;case"shared":return ie}return null});return{__sfc:!0,fileListIconStyles:i,props:t,previewURL:r,previewLoaded:n,isFile:s,folderDecorationIcon:a,IconFile:he,IconFolder:_e}}});var Li=function(){var e=this,t=e._self._c,i=e._self._setupProxy;return t("div",{class:i.fileListIconStyles["file-picker__file-icon"],style:i.previewLoaded?{backgroundImage:`url(${i.previewURL})`}:void 0},[i.previewLoaded?e._e():[i.isFile?t(i.IconFile,{attrs:{size:20}}):i.folderDecorationIcon?t(i.folderDecorationIcon,{tag:"component"}):t(i.IconFolder,{attrs:{size:20}})]],2)},Bi=[],zi=m(Fi,Li,Bi,!1,null,null);const Ai=zi.exports,Vi=F({__name:"FileListRow",props:{allowPickDirectory:{type:Boolean},selected:{type:Boolean},showCheckbox:{type:Boolean},canPick:{type:Boolean},node:null,cropImagePreviews:{type:Boolean}},emits:["update:selected","enter-directory"],setup(e,{emit:t}){const i=e,r=d(()=>i.node.attributes?.displayName||i.node.basename.slice(0,i.node.extension?-i.node.extension.length:void 0)),n=d(()=>i.node.extension),s=d(()=>i.node.type===D.Folder),a=d(()=>i.canPick&&(i.allowPickDirectory||!s.value));function l(){t("update:selected",!i.selected)}function c(){s.value?t("enter-directory",i.node):l()}function o(v){v.key==="Enter"&&c()}return{__sfc:!0,props:i,emit:t,displayName:r,fileExtension:n,isDirectory:s,isPickable:a,toggleSelected:l,handleClick:c,handleKeyDown:o,formatFileSize:Ie,NcCheckboxRadioSwitch:ue,NcDateTime:Te,t:g,FilePreview:Ai}}});var $i=function(){var e=this,t=e._self._c,i=e._self._setupProxy;return t("tr",e._g({class:["file-picker__row",{"file-picker__row--selected":e.selected&&!e.showCheckbox}],attrs:{tabindex:e.showCheckbox&&!i.isDirectory?void 0:0,"aria-selected":i.isPickable?e.selected:void 0,"data-filename":e.node.basename,"data-testid":"file-list-row"}},{click:i.handleClick,...!e.showCheckbox||i.isDirectory?{keydown:i.handleKeyDown}:{}}),[e.showCheckbox?t("td",{staticClass:"row-checkbox",on:{click:function(r){return r.stopPropagation(),(()=>{}).apply(null,arguments)}}},[t(i.NcCheckboxRadioSwitch,{attrs:{"aria-label":i.t("Select the row for {nodename}",{nodename:i.displayName}),checked:e.selected,disabled:!i.isPickable,"data-testid":"row-checkbox"},on:{"update:checked":i.toggleSelected}})],1):e._e(),t("td",{staticClass:"row-name"},[t("div",{staticClass:"file-picker__name-container",attrs:{"data-testid":"row-name"}},[t(i.FilePreview,{attrs:{node:e.node,"crop-image-previews":e.cropImagePreviews}}),t("div",{staticClass:"file-picker__file-name",attrs:{title:i.displayName},domProps:{textContent:e._s(i.displayName)}}),t("div",{staticClass:"file-picker__file-extension",domProps:{textContent:e._s(i.fileExtension)}})],1)]),t("td",{staticClass:"row-size"},[e._v(" "+e._s(i.formatFileSize(e.node.size||0))+" ")]),t("td",{staticClass:"row-modified"},[t(i.NcDateTime,{attrs:{timestamp:e.node.mtime,"ignore-seconds":!0}})],1)])},Ii=[],Pi=m(Vi,$i,Ii,!1,null,"cb12dccb");const Hi=Pi.exports,Di=F({__name:"FileList",props:{currentView:null,multiselect:{type:Boolean},allowPickDirectory:{type:Boolean},loading:{type:Boolean},files:null,selectedFiles:null,path:null},emits:["update:path","update:selectedFiles"],setup(e,{emit:t}){const i=e,r=f(),{currentConfig:n}=Ft(i.currentView),s=d(()=>r.value??n.value),a=d(()=>s.value.sortBy==="basename"?s.value.order==="none"?void 0:s.value.order:void 0),l=d(()=>s.value.sortBy==="size"?s.value.order==="none"?void 0:s.value.order:void 0),c=d(()=>s.value.sortBy==="mtime"?s.value.order==="none"?void 0:s.value.order:void 0),o=_=>{s.value.sortBy===_?s.value.order==="ascending"?r.value={sortBy:s.value.sortBy,order:"descending"}:r.value={sortBy:s.value.sortBy,order:"ascending"}:r.value={sortBy:_,order:"ascending"}},{sortFavoritesFirst:v,cropImagePreviews:p}=ge(),k=d(()=>$e(i.files,{sortFoldersFirst:!0,sortFavoritesFirst:v.value,sortingOrder:s.value.order==="descending"?"desc":"asc",sortingMode:s.value.sortBy})),b=d(()=>i.files.filter(_=>i.allowPickDirectory||_.type!==D.Folder)),C=d(()=>!i.loading&&i.selectedFiles.length>0&&i.selectedFiles.length>=b.value.length);function S(){i.selectedFiles.length<b.value.length?t("update:selectedFiles",b.value):t("update:selectedFiles",[])}function w(_){i.selectedFiles.includes(_)?t("update:selectedFiles",i.selectedFiles.filter(x=>x.path!==_.path)):i.multiselect?t("update:selectedFiles",[...i.selectedFiles,_]):t("update:selectedFiles",[_])}function V(_){t("update:path",_.path)}const L=f(4),N=f();{const _=()=>Fe(()=>{const x=N.value?.parentElement?.children||[];let $=N.value?.parentElement?.clientHeight||450;for(let u=0;u<x.length;u++)N.value?.isSameNode(x[u])||($-=x[u].clientHeight);L.value=Math.max(1,Math.floor(($-50)/50))});A(()=>{window.addEventListener("resize",_),_()}),Le(()=>{window.removeEventListener("resize",_)})}return{__sfc:!0,props:i,emit:t,customSortingConfig:r,filesAppSorting:n,sortingConfig:s,sortByName:a,sortBySize:l,sortByModified:c,toggleSorting:o,sortFavoritesFirst:v,cropImagePreviews:p,sortedFiles:k,selectableFiles:b,allSelected:C,onSelectAll:S,onNodeSelected:w,onChangeDirectory:V,skeletonNumber:L,fileContainer:N,NcButton:U,NcCheckboxRadioSwitch:ue,t:g,IconSortAscending:Vt,IconSortDescending:Dt,LoadingTableRow:Tt,FileListRow:Hi}}});var Mi=function(){var e=this,t=e._self._c,i=e._self._setupProxy;return t("div",{ref:"fileContainer",staticClass:"file-picker__files"},[t("table",[t("thead",[t("tr",[e.multiselect?t("th",{staticClass:"row-checkbox"},[t("span",{staticClass:"hidden-visually"},[e._v(" "+e._s(i.t("Select entry"))+" ")]),e.multiselect?t(i.NcCheckboxRadioSwitch,{attrs:{"aria-label":i.t("Select all entries"),checked:i.allSelected,"data-testid":"select-all-checkbox"},on:{"update:checked":i.onSelectAll}}):e._e()],1):e._e(),t("th",{staticClass:"row-name",attrs:{"aria-sort":i.sortByName}},[t("div",{staticClass:"header-wrapper"},[t("span",{staticClass:"file-picker__header-preview"}),t(i.NcButton,{attrs:{wide:!0,type:"tertiary","data-test":"file-picker_sort-name"},on:{click:function(r){return i.toggleSorting("basename")}},scopedSlots:e._u([{key:"icon",fn:function(){return[i.sortByName==="ascending"?t(i.IconSortAscending,{attrs:{size:20}}):i.sortByName==="descending"?t(i.IconSortDescending,{attrs:{size:20}}):t("span",{staticStyle:{width:"44px"}})]},proxy:!0}])},[e._v(" "+e._s(i.t("Name"))+" ")])],1)]),t("th",{staticClass:"row-size",attrs:{"aria-sort":i.sortBySize}},[t(i.NcButton,{attrs:{wide:!0,type:"tertiary"},on:{click:function(r){return i.toggleSorting("size")}},scopedSlots:e._u([{key:"icon",fn:function(){return[i.sortBySize==="ascending"?t(i.IconSortAscending,{attrs:{size:20}}):i.sortBySize==="descending"?t(i.IconSortDescending,{attrs:{size:20}}):t("span",{staticStyle:{width:"44px"}})]},proxy:!0}])},[e._v(" "+e._s(i.t("Size"))+" ")])],1),t("th",{staticClass:"row-modified",attrs:{"aria-sort":i.sortByModified}},[t(i.NcButton,{attrs:{wide:!0,type:"tertiary"},on:{click:function(r){return i.toggleSorting("mtime")}},scopedSlots:e._u([{key:"icon",fn:function(){return[i.sortByModified==="ascending"?t(i.IconSortAscending,{attrs:{size:20}}):i.sortByModified==="descending"?t(i.IconSortDescending,{attrs:{size:20}}):t("span",{staticStyle:{width:"44px"}})]},proxy:!0}])},[e._v(" "+e._s(i.t("Modified"))+" ")])],1)])]),t("tbody",[e.loading?e._l(i.skeletonNumber,function(r){return t(i.LoadingTableRow,{key:r,attrs:{"show-checkbox":e.multiselect}})}):e._l(i.sortedFiles,function(r){return t(i.FileListRow,{key:r.fileid||r.path,attrs:{"allow-pick-directory":e.allowPickDirectory,"show-checkbox":e.multiselect,"can-pick":e.multiselect||e.selectedFiles.length===0||e.selectedFiles.includes(r),selected:e.selectedFiles.includes(r),node:r,"crop-image-previews":i.cropImagePreviews},on:{"update:selected":function(n){return i.onNodeSelected(r)},"enter-directory":i.onChangeDirectory}})})],2)])])},Oi=[],Ei=m(Di,Mi,Oi,!1,null,"006fdbd0");const Ri=Ei.exports,Ti={name:"HomeIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var Wi=function(){var e=this,t=e._self._c;return t("span",e._b({staticClass:"material-design-icon home-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(i){return e.$emit("click",i)}}},"span",e.$attrs,!1),[t("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[t("path",{attrs:{d:"M10,20V14H14V20H19V12H22L12,3L2,12H5V20H10Z"}},[e.title?t("title",[e._v(e._s(e.title))]):e._e()])])])},ji=[],Zi=m(Ti,Wi,ji,!1,null,null);const Ui=Zi.exports,qi={name:"PlusIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var Gi=function(){var e=this,t=e._self._c;return t("span",e._b({staticClass:"material-design-icon plus-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(i){return e.$emit("click",i)}}},"span",e.$attrs,!1),[t("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[t("path",{attrs:{d:"M19,13H13V19H11V13H5V11H11V5H13V11H19V13Z"}},[e.title?t("title",[e._v(e._s(e.title))]):e._e()])])])},Ki=[],Ji=m(qi,Gi,Ki,!1,null,null);const Qi=Ji.exports,Xi=F({__name:"FilePickerBreadcrumbs",props:{path:null,showMenu:{type:Boolean}},emits:["update:path","create-node"],setup(e,{emit:t}){const i=e,r=f(!1),n=f(""),s=f();function a(){const o=n.value.trim(),v=s.value?.$el?.querySelector("input");let p="";return o.length===0?p=g("Folder name cannot be empty."):o.includes("/")?p=g('"/" is not allowed inside a folder name.'):["..","."].includes(o)?p=g('"{name}" is an invalid folder name.',{name:o}):window.OC.config?.blacklist_files_regex&&o.match(window.OC.config?.blacklist_files_regex)&&(p=g('"{name}" is not an allowed folder name',{name:o})),v&&v.setCustomValidity(p),p===""}const l=function(){const o=n.value.trim();a()&&(r.value=!1,t("create-node",o),n.value="")},c=d(()=>i.path.split("/").filter(o=>o!=="").map((o,v,p)=>({name:o,path:"/"+p.slice(0,v+1).join("/")})));return{__sfc:!0,props:i,emit:t,actionsOpen:r,newNodeName:n,nameInput:s,validateInput:a,onSubmit:l,pathElements:c,IconFolder:_e,IconHome:Ui,IconPlus:Qi,NcActions:q,NcActionInput:De,NcBreadcrumbs:yt,NcBreadcrumb:de,t:g}}});var Yi=function(){var e=this,t=e._self._c,i=e._self._setupProxy;return t(i.NcBreadcrumbs,{staticClass:"file-picker__breadcrumbs",scopedSlots:e._u([{key:"default",fn:function(){return[t(i.NcBreadcrumb,{attrs:{name:i.t("All files"),title:i.t("Home")},on:{click:function(r){return i.emit("update:path","/")}},scopedSlots:e._u([{key:"icon",fn:function(){return[t(i.IconHome,{attrs:{size:20}})]},proxy:!0}])}),e._l(i.pathElements,function(r){return t(i.NcBreadcrumb,{key:r.path,attrs:{name:r.name,title:r.path},on:{click:function(n){return i.emit("update:path",r.path)}}})})]},proxy:!0},e.showMenu?{key:"actions",fn:function(){return[t(i.NcActions,{attrs:{"aria-label":i.t("Create directory"),"force-menu":!0,"force-name":!0,"menu-name":i.t("New"),open:i.actionsOpen,type:"secondary"},on:{"update:open":function(r){i.actionsOpen=r},close:function(r){i.newNodeName=""}},scopedSlots:e._u([{key:"icon",fn:function(){return[t(i.IconPlus,{attrs:{size:20}})]},proxy:!0}],null,!1,2971667417)},[t(i.NcActionInput,{ref:"nameInput",attrs:{value:i.newNodeName,label:i.t("New folder"),placeholder:i.t("New folder name")},on:{"update:value":function(r){i.newNodeName=r},submit:i.onSubmit,input:i.validateInput},scopedSlots:e._u([{key:"icon",fn:function(){return[t(i.IconFolder,{attrs:{size:20}})]},proxy:!0}],null,!1,1614167509)})],1)]},proxy:!0}:null],null,!0)})},er=[],tr=m(Xi,Yi,er,!1,null,"b357227a");const ir=tr.exports,rr={name:"CloseIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var nr=function(){var e=this,t=e._self._c;return t("span",e._b({staticClass:"material-design-icon close-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(i){return e.$emit("click",i)}}},"span",e.$attrs,!1),[t("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[t("path",{attrs:{d:"M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z"}},[e.title?t("title",[e._v(e._s(e.title))]):e._e()])])])},sr=[],ar=m(rr,nr,sr,!1,null,null);const lr=ar.exports,or={name:"MagnifyIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var cr=function(){var e=this,t=e._self._c;return t("span",e._b({staticClass:"material-design-icon magnify-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(i){return e.$emit("click",i)}}},"span",e.$attrs,!1),[t("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[t("path",{attrs:{d:"M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z"}},[e.title?t("title",[e._v(e._s(e.title))]):e._e()])])])},ur=[],dr=m(or,cr,ur,!1,null,null);const pr=dr.exports,fr=e=>{const t=[{id:"files",label:g("All files"),icon:wt},{id:"recent",label:g("Recent"),icon:bt},{id:"favorites",label:g("Favorites"),icon:Ct}],i=e.value?t.filter(({id:r})=>r==="files"):t;return{allViews:t,availableViews:i}},mr=F({__name:"FilePickerNavigation",props:{currentView:null,filterString:null,isCollapsed:{type:Boolean},disabledNavigation:{type:Boolean}},emits:["update:currentView","update:filterString"],setup(e,{emit:t}){const i=e,{availableViews:r}=fr(f(xe()===null)),n=d(()=>r.filter(s=>s.id===i.currentView)[0]??r[0]);return{__sfc:!0,props:i,emit:t,availableViews:r,currentViewObject:n,updateFilterValue:s=>t("update:filterString",s),IconClose:lr,IconMagnify:pr,NcButton:U,NcIconSvgWrapper:Ve,NcSelect:je,NcTextField:Ue,Fragment:me,t:g}}});var hr=function(){var e=this,t=e._self._c,i=e._self._setupProxy;return t(i.Fragment,[t(i.NcTextField,{staticClass:"file-picker__filter-input",attrs:{value:e.filterString,label:i.t("Filter file list"),"show-trailing-button":!!e.filterString},on:{"update:value":i.updateFilterValue,"trailing-button-click":function(r){return i.updateFilterValue("")}},scopedSlots:e._u([{key:"trailing-button-icon",fn:function(){return[t(i.IconClose,{attrs:{size:16}})]},proxy:!0}])},[t(i.IconMagnify,{attrs:{size:16}})],1),i.availableViews.length>1&&!e.disabledNavigation?[e.isCollapsed?t(i.NcSelect,{attrs:{"aria-label":i.t("Current view selector"),clearable:!1,searchable:!1,options:i.availableViews,value:i.currentViewObject},on:{input:r=>i.emit("update:currentView",r.id)}}):t("ul",{staticClass:"file-picker__side"},e._l(i.availableViews,function(r){return t("li",{key:r.id},[t(i.NcButton,{attrs:{type:e.currentView===r.id?"primary":"tertiary",wide:!0},on:{click:function(n){return e.$emit("update:currentView",r.id)}},scopedSlots:e._u([{key:"icon",fn:function(){return[t(i.NcIconSvgWrapper,{attrs:{path:r.icon,size:20}})]},proxy:!0}],null,!0)},[e._v(" "+e._s(r.label)+" ")])],1)}),0)]:e._e()],2)},gr=[],vr=m(mr,hr,gr,!1,null,"b42054b8");const _r=vr.exports;function yr(e){const t=new AbortController,i=Math.round(Date.now()/1e3)-60*60*24*14;return new le(async(r,n,s)=>{s(()=>t.abort());try{const{data:a}=await e.search("/",{signal:t.signal,details:!0,data:Be(i)}),l=a.results.map(c=>j(c));r(l)}catch(a){n(a)}})}function br(e,t){const i=new AbortController;return new le(async(r,n,s)=>{s(()=>i.abort());try{const a=(await e.getDirectoryContents(H.join(W,t),{signal:i.signal,details:!0,includeSelf:!0,data:oe()})).data.map(l=>j(l));r({contents:a.filter(({path:l})=>l!==t),folder:a.find(({path:l})=>l===t)})}catch(a){n(a)}})}async function wr(e,t){const{data:i}=await e.stat(H.join(W,t),{details:!0,data:oe()});return j(i)}const Cr=function(e,t){const i=Se(),r=R([]),n=R(null),s=f(!0),a=f(null);async function l(o){const v=H.join(t.value,o);await i.createDirectory(H.join(W,v));const p=await wr(i,v);return r.value=[...r.value,p],p}async function c(){a.value&&a.value.cancel(),s.value=!0,e.value==="favorites"?a.value=Ne(i,t.value):e.value==="recent"?a.value=yr(i):a.value=br(i,t.value);const o=await a.value;"folder"in o?(n.value=o.folder,r.value=o.contents):(n.value=null,r.value=o),a.value=null,s.value=!1}return re([e,t],()=>c()),A(()=>c()),{isLoading:s,files:r,folder:n,loadFiles:c,createDirectory:l}},kr=function(e){const t=d(()=>e.value.map(i=>i.split("/")));return{isSupportedMimeType:i=>{const r=i.split("/");return t.value.some(([n,s])=>(r[0]===n||n==="*")&&(r[1]===s||s==="*"))}}},Sr={name:"FilePicker"},Nr=F({...Sr,props:{buttons:null,name:null,allowPickDirectory:{type:Boolean,default:!1},disabledNavigation:{type:Boolean,default:!1},container:{default:"body"},filterFn:{default:void 0},mimetypeFilter:{default:()=>[]},multiselect:{type:Boolean,default:!0},path:{default:void 0}},emits:["close"],setup(e,{emit:t}){const i=e,r=f(!0),n=d(()=>{const u=o.value.length===0&&i.allowPickDirectory&&w.value?[w.value]:o.value;return(typeof i.buttons=="function"?i.buttons(u,k.value,l.value):i.buttons).map(h=>({...h,disabled:h.disabled||V.value,callback:()=>{s=!0,a(h.callback,u)}}))});let s=!1;const a=async(u,h)=>{u(h),t("close",h),s=!1},l=f("files"),c=d(()=>l.value==="favorites"?g("Favorites"):l.value==="recent"?g("Recent"):""),o=R([]),v=f(window?.sessionStorage.getItem("NC.FilePicker.LastPath")||"/"),p=f("");re([p],()=>{i.path===void 0&&p.value&&window.sessionStorage.setItem("NC.FilePicker.LastPath",p.value),o.value=[]});const k=d({get:()=>l.value==="files"?p.value||i.path||v.value:"/",set:u=>{p.value=u}}),b=f(""),{isSupportedMimeType:C}=kr(ne(i,"mimetypeFilter")),{files:S,folder:w,isLoading:V,loadFiles:L,createDirectory:N}=Cr(l,k);A(()=>L());const{showHiddenFiles:_}=ge(),x=d(()=>{let u=S.value;return _.value||(u=u.filter(h=>!h.basename.startsWith("."))),i.mimetypeFilter.length>0&&(u=u.filter(h=>h.type==="folder"||h.mime&&C(h.mime))),b.value&&(u=u.filter(h=>h.basename.toLowerCase().includes(b.value.toLowerCase()))),i.filterFn&&(u=u.filter(h=>i.filterFn(h))),u}),$=d(()=>l.value==="files"?g("Upload some content or sync with your devices!"):l.value==="recent"?g("Files and folders you recently modified will show up here."):g("Files and folders you mark as favorite will show up here."));return{__sfc:!0,props:i,emit:t,isOpen:r,dialogButtons:n,isHandlingCallback:s,handleButtonClick:a,currentView:l,viewHeadline:c,selectedFiles:o,savedPath:v,navigatedPath:p,currentPath:k,filterString:b,isSupportedMimeType:C,files:S,currentFolder:w,isLoading:V,loadFiles:L,createDirectory:N,showHiddenFiles:_,filteredFiles:x,noFilesDescription:$,onCreateFolder:async u=>{try{const h=await N(u);p.value=h.path,ke("files:node:created",S.value.filter(ye=>ye.basename===u)[0])}catch(h){console.warn("Could not create new folder",{name:u,error:h}),G(g("Could not create the new folder"))}},handleClose:u=>{!u&&!s&&t("close")},IconFile:he,FileList:Ri,FilePickerBreadcrumbs:ir,FilePickerNavigation:_r,NcDialog:We,NcEmptyContent:Ze,t:g}}});var xr=function(){var e=this,t=e._self._c,i=e._self._setupProxy;return t(i.NcDialog,{attrs:{container:e.container,buttons:i.dialogButtons,name:e.name,size:"large","content-classes":"file-picker__content","dialog-classes":"file-picker","navigation-classes":"file-picker__navigation",open:i.isOpen},on:{"update:open":[function(r){i.isOpen=r},i.handleClose]},scopedSlots:e._u([{key:"navigation",fn:function({isCollapsed:r}){return[t(i.FilePickerNavigation,{attrs:{"is-collapsed":r,"current-view":i.currentView,"filter-string":i.filterString,"disabled-navigation":e.disabledNavigation},on:{"update:currentView":function(n){i.currentView=n},"update:current-view":function(n){i.currentView=n},"update:filterString":function(n){i.filterString=n},"update:filter-string":function(n){i.filterString=n}}})]}}])},[t("div",{staticClass:"file-picker__main"},[i.currentView==="files"?t(i.FilePickerBreadcrumbs,{attrs:{path:i.currentPath,"show-menu":e.allowPickDirectory},on:{"update:path":function(r){i.currentPath=r},"create-node":i.onCreateFolder}}):t("div",{staticClass:"file-picker__view"},[t("h3",[e._v(e._s(i.viewHeadline))])]),i.isLoading||i.filteredFiles.length>0?t(i.FileList,{attrs:{"allow-pick-directory":e.allowPickDirectory,"current-view":i.currentView,files:i.filteredFiles,multiselect:e.multiselect,loading:i.isLoading,path:i.currentPath,"selected-files":i.selectedFiles,name:i.viewHeadline},on:{"update:path":[function(r){i.currentPath=r},function(r){i.currentView="files"}],"update:selectedFiles":function(r){i.selectedFiles=r},"update:selected-files":function(r){i.selectedFiles=r}}}):i.filterString?t(i.NcEmptyContent,{attrs:{name:i.t("No matching files"),description:i.t("No files matching your filter were found.")},scopedSlots:e._u([{key:"icon",fn:function(){return[t(i.IconFile)]},proxy:!0}])}):t(i.NcEmptyContent,{attrs:{name:i.t("No files in here"),description:i.noFilesDescription},scopedSlots:e._u([{key:"icon",fn:function(){return[t(i.IconFile)]},proxy:!0}])})],1)])},Fr=[],Lr=m(Nr,xr,Fr,!1,null,"20b719ba");const Xr=Lr.exports;export{Xr as default};
//# sourceMappingURL=FilePicker-CSmrMOEO-BvE4FAOp.chunk.mjs.map
